<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html;charset=utf-8">
  <title>pyBBN v0.9.0: KAWANO/nuccom.f</title>
  <link rel="stylesheet" href="../pyccoon.css">
  <script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']], processEscapes: true}
  });
  </script>
  <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
</head>
<body>
<div id='container' >
  <div id="footer">
    <span id="project-name">
        <a class="btn" href="../index.html">pyBBN v0.9.0</a>
    </span>
    <a class="btn" class="source source-1" href="#top">Back to top</a>
    <div class="generation-time">
        Generated at
        <code>2015-07-06 18:48</code>
        by a diligent
        <a target="_blank" href="http://ckald.github.io/pyccoon/" title="Pyccoon: side-to-side documentation generator">
            <img id="pyccoon-icon" src="../pyccoon_icon.svg" alt="Pyccoon: side-to-side documentation generator" />pyccoon</a>
    </div>
  </div>
  <a id="top"></a>
  <div class='section'>
    <div class='docs nav'>
      <nav id="breadcrumbs">/ <a href="nuccom.f.html/../../index.html">.</a> / <a href="nuccom.f.html/../index.html">KAWANO</a> / nuccom.f</nav>
      <ul id="children"></ul>
    </div>
  </div>
  <div id="everything" class='clearall'>
    <div id="background"></div>
    <div class='section'>
    <a id="section-0" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-0'>#</a>
          </div>
          <p>===============IDENTIFICATION DIVISION====================</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="k">SUBROUTINE </span><span class="n">driver</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-1" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-1'>#</a>
          </div>
          <p>C-------LINKAGES.</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-2" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-2'>#</a>
          </div>
          <p>CALLED BY - [subroutine] run</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-3" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-3'>#</a>
          </div>
          <p>CALLS     - [subroutine] start, derivs, accum</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-4" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-4'>#</a>
          </div>
          <p>C-------REMARKS.</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-5" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-5'>#</a>
          </div>
          <p>Runge-Kutta computational routine</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="k">USE </span><span class="n">commons</span>
      <span class="k">USE </span><span class="n">sterile</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-6" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-6'>#</a>
          </div>
          <p>C-------COMMON AREAS.</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="k">COMMON</span> <span class="o">/</span><span class="n">evolp1</span><span class="o">/</span> <span class="n">t9</span><span class="p">,</span><span class="n">hv</span><span class="p">,</span><span class="n">phie</span><span class="p">,</span><span class="n">y</span>                   <span class="c">!Evolution parameters.</span>
      <span class="k">COMMON</span> <span class="o">/</span><span class="n">evolp2</span><span class="o">/</span> <span class="n">dt9</span><span class="p">,</span><span class="n">dhv</span><span class="p">,</span><span class="n">dphie</span><span class="p">,</span><span class="n">dydt</span>             <span class="c">!Evolution parameters.</span>
      <span class="k">COMMON</span> <span class="o">/</span><span class="n">evolp3</span><span class="o">/</span> <span class="n">t90</span><span class="p">,</span><span class="n">hv0</span><span class="p">,</span><span class="n">phie0</span><span class="p">,</span><span class="n">y0</span>               <span class="c">!Evolution parameters.</span>
      <span class="k">COMMON</span> <span class="o">/</span><span class="n">compr</span><span class="o">/</span>  <span class="n">cy</span><span class="p">,</span><span class="n">ct</span><span class="p">,</span><span class="n">t9i</span><span class="p">,</span><span class="n">t9f</span><span class="p">,</span><span class="n">ytmin</span><span class="p">,</span><span class="n">inc</span>        <span class="c">!Computation parameters.</span>
      <span class="k">COMMON</span> <span class="o">/</span><span class="nb">time</span><span class="o">/</span>   <span class="n">t</span><span class="p">,</span><span class="n">dt</span><span class="p">,</span><span class="n">dlt9dt</span>                    <span class="c">!Time variables.</span>
      <span class="k">COMMON</span> <span class="o">/</span><span class="n">flags</span><span class="o">/</span>  <span class="nb">ltime</span><span class="p">,</span><span class="k">is</span><span class="p">,</span><span class="n">ip</span><span class="p">,</span><span class="n">it</span><span class="p">,</span><span class="n">mbad</span>            <span class="c">!Flags,counters.</span>
      <span class="k">COMMON</span> <span class="o">/</span><span class="n">check1</span><span class="o">/</span>  <span class="nb">itime</span>                          <span class="c">!Computation location.</span>
      <span class="k">COMMON</span> <span class="o">/</span><span class="n">runopt</span><span class="o">/</span> <span class="n">irun</span><span class="p">,</span><span class="n">isize</span><span class="p">,</span><span class="n">jsize</span>               <span class="c">!Run options.</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-7" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-7'>#</a>
          </div>
          <p>C=================DECLARATION DIVISION=====================</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-8" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-8'>#</a>
          </div>
          <p>C-------EVOLUTION PARAMETERS.</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="kt">DOUBLE PRECISION    </span><span class="n">t9</span>                   <span class="c">!Temperature (in units of 10**9 K).</span>
      <span class="kt">DOUBLE PRECISION    </span><span class="n">hv</span>                   <span class="c">!Defined by hv = M(atomic)n(baryon)/t9**3.</span>
      <span class="kt">DOUBLE PRECISION    </span><span class="n">phie</span>                 <span class="c">!Chemical potential for electron.</span>
      <span class="kt">DOUBLE PRECISION    </span><span class="n">y</span><span class="p">(</span><span class="n">nnuc</span><span class="p">)</span>              <span class="c">!Relative number abundances.</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-9" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-9'>#</a>
          </div>
          <p>C-------EVOLUTION PARAMETERS (DERIVATIVES).</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="kt">DOUBLE PRECISION    </span><span class="n">dydt</span><span class="p">(</span><span class="n">nnuc</span><span class="p">)</span>           <span class="c">!Change in rel number abundances.</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-10" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-10'>#</a>
          </div>
          <p>C-------EVOLUTION PARAMETERS (ORIGINAL VALUES).</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="kt">DOUBLE PRECISION    </span><span class="n">y0</span><span class="p">(</span><span class="n">nnuc</span><span class="p">)</span>             <span class="c">!Rel # abund at beginning of iteration.</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-11" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-11'>#</a>
          </div>
          <p>C-------COMPUTATION PARAMETERS.</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="kt">DOUBLE PRECISION    </span><span class="n">cy</span>                   <span class="c">!Time step limiting constant on abundances.</span>
      <span class="kt">DOUBLE PRECISION    </span><span class="n">ct</span>                  <span class="c">!Time step limiting constant on temperature.</span>
      <span class="kt">DOUBLE PRECISION    </span><span class="n">t9f</span>                  <span class="c">!Final temperature (in 10**9 K).</span>
      <span class="kt">DOUBLE PRECISION    </span><span class="n">ytmin</span>                <span class="c">!Smallest abundances allowed.</span>
      <span class="kt">INTEGER </span><span class="n">inc</span>                  <span class="c">!Accumulation increment.</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-12" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-12'>#</a>
          </div>
          <p>C-------TIME AND TIME STEP VARIABLES.</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="kt">DOUBLE PRECISION    </span><span class="n">t</span>                    <span class="c">!Time.</span>
      <span class="kt">DOUBLE PRECISION    </span><span class="n">dt</span>                   <span class="c">!Time step.</span>
      <span class="kt">DOUBLE PRECISION    </span><span class="n">dlt9dt</span>               <span class="c">!(1/t9)*d(t9)/d(t).</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-13" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-13'>#</a>
          </div>
          <p>C-------COUNTERS AND FLAGS.</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="kt">INTEGER </span><span class="n">loop</span>                 <span class="c">!Counts which Runge-Kutta loop.</span>
      <span class="kt">INTEGER </span><span class="nb">ltime</span>                <span class="c">!Indicates termination status.</span>
      <span class="kt">INTEGER </span><span class="k">is</span>                   <span class="c">!# total time steps for particular run.</span>
      <span class="kt">INTEGER </span><span class="n">ip</span>                   <span class="c">!# time steps after outputting a line.</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-14" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-14'>#</a>
          </div>
          <p>C-------COMPUTATION LOCATION.</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="kt">INTEGER </span><span class="nb">itime</span>                <span class="c">!Time check.</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-15" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-15'>#</a>
          </div>
          <p>C-------RUN OPTION.</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="kt">INTEGER </span><span class="n">isize</span>                <span class="c">!Number of nuclides in computation.</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-16" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-16'>#</a>
          </div>
          <p>C-------TIME AND TIME STEP VARIABLES.</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="kt">DOUBLE PRECISION    </span><span class="n">dtmin</span>                <span class="c">!Mininum time step.</span>
      <span class="kt">DOUBLE PRECISION    </span><span class="n">dtl</span>                 <span class="c">!Time step from limitation on abund changes.</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-17" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-17'>#</a>
          </div>
          <p>C-------LABELS FOR VARIABLES TO BE TIME EVOLVED.</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="kt">INTEGER </span><span class="n">mvar</span>                 <span class="c">!Total number of variables to be evolved.</span>
      <span class="kt">DOUBLE PRECISION    </span><span class="n">v</span><span class="p">(</span><span class="n">nvar</span><span class="p">)</span>              <span class="c">!Variables to be time evolved.</span>
      <span class="kt">DOUBLE PRECISION    </span><span class="n">dvdt</span><span class="p">(</span><span class="n">nvar</span><span class="p">)</span>           <span class="c">!Time derivatives.</span>
      <span class="kt">DOUBLE PRECISION    </span><span class="n">v0</span><span class="p">(</span><span class="n">nvar</span><span class="p">)</span>             <span class="c">!Value of variables at original point.</span>
      <span class="kt">DOUBLE PRECISION    </span><span class="n">dvdt0</span><span class="p">(</span><span class="n">nvar</span><span class="p">)</span>          <span class="c">!Value of derivatives at original point.</span>

      <span class="kt">DOUBLE PRECISION    </span><span class="n">h_interp</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-18" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-18'>#</a>
          </div>
          <p>C-------EQUIVALENCE STATEMENTS.</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="k">EQUIVALENCE</span> <span class="p">(</span><span class="n">v</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span><span class="n">y</span><span class="p">(</span><span class="mi">1</span><span class="p">)),(</span><span class="n">dvdt</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span><span class="n">dydt</span><span class="p">(</span><span class="mi">1</span><span class="p">)),(</span><span class="n">v0</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span><span class="n">y0</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-19" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-19'>#</a>
          </div>
          <p>C==================PROCEDURE DIVISION======================</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-20" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-20'>#</a>
          </div>
          <p>C10-----INPUT INITIALIZATION INFORMATION, RELABEL-------------------</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="nb">ltime</span> <span class="o">=</span> <span class="mi">0</span>                    <span class="c">!Set termination indicator to zero.</span>
      <span class="k">CALL </span><span class="n">start</span>                   <span class="c">!Input initialization information.</span>
      <span class="n">mvar</span>  <span class="o">=</span> <span class="n">isize</span> <span class="o">+</span> <span class="mi">3</span>            <span class="c">!Total number of variables to be evolved.</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-21" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-21'>#</a>
          </div>
          <p>C20-----LOOP ONE----------------------------------------</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre> <span class="mi">200</span>  <span class="k">continue</span>                     <span class="c">!Begin Runge-Kutta looping.</span>
      <span class="n">loop</span> <span class="o">=</span> <span class="mi">1</span>                     <span class="c">!Loop indicator.</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-22" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-22'>#</a>
          </div>
          <p>..........COMPUTE DERIVATIVES OF VARIABLES TO BE EVOLVED.</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="k">CALL </span><span class="n">derivs</span><span class="p">(</span><span class="n">loop</span><span class="p">)</span>
      <span class="nb">itime</span> <span class="o">=</span> <span class="mi">4</span>                    <span class="c">!Time = 1st R-K loop.</span>
      <span class="k">CALL </span><span class="n">check</span>                   <span class="c">!Check interface subroutine.</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-23" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-23'>#</a>
          </div>
          <p>..........ACCUMULATE.</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="k">IF</span> <span class="p">((</span><span class="n">t9</span><span class="p">.</span><span class="n">le</span><span class="p">.</span><span class="n">t9f</span><span class="p">).</span><span class="nb">or</span><span class="p">.</span>                         <span class="c">!Low temp.</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-24" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-24'>#</a>
          </div>
          
        </div>
        <div class='code'>
          <div class="highlight"><pre>     <span class="err">|</span>    <span class="p">(</span><span class="n">dt</span><span class="p">.</span><span class="n">lt</span><span class="p">.</span><span class="nb">abs</span><span class="p">(</span><span class="n">min_time_step</span><span class="o">/</span><span class="n">dlt9dt</span><span class="p">)).</span><span class="nb">or</span><span class="p">.</span>   <span class="c">!Small dt.</span>
     <span class="err">|</span>    <span class="p">(</span><span class="n">ip</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="n">inc</span><span class="p">))</span> <span class="k">CALL </span><span class="n">accum</span>                 <span class="c">!Enough iterations.</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-25" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-25'>#</a>
          </div>
          <p>..........POSSIBLY TERMINATE COMPUTATION.</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="k">IF</span> <span class="p">(</span><span class="nb">ltime</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>         <span class="c">!Return to run selection.</span>
        <span class="k">RETURN</span>
<span class="k">      END IF</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-26" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-26'>#</a>
          </div>
          <p>..........RESET COUNTERS.</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="k">IF</span> <span class="p">(</span><span class="n">ip</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="n">inc</span><span class="p">)</span> <span class="k">THEN</span>          <span class="c">!Reset iteration counters.</span>
        <span class="n">ip</span> <span class="o">=</span> <span class="mi">0</span>
      <span class="k">END IF</span>
<span class="k">      </span><span class="n">ip</span> <span class="o">=</span> <span class="n">ip</span> <span class="o">+</span> <span class="mi">1</span>
      <span class="k">is</span> <span class="o">=</span> <span class="k">is</span> <span class="o">+</span> <span class="mi">1</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-27" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-27'>#</a>
          </div>
          <p>..........ADJUST TIME STEP.</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="k">IF</span> <span class="p">(</span><span class="k">is</span><span class="p">.</span><span class="n">gt</span><span class="p">.</span><span class="mi">3</span><span class="p">)</span> <span class="k">THEN</span>            <span class="c">!Adjust time step after 3 iterations.</span>
        <span class="n">dtmin</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="mf">1.</span><span class="o">/</span><span class="n">dlt9dt</span><span class="p">)</span><span class="o">*</span><span class="n">ct</span>  <span class="c">!Trial value for minimum time step (Ref 1).</span>
        <span class="k">DO </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">isize</span>             <span class="c">!Go through all abundance changes.</span>
          <span class="k">IF</span> <span class="p">((</span><span class="n">dydt</span><span class="p">(</span><span class="n">i</span><span class="p">).</span><span class="n">ne</span><span class="p">.</span><span class="mf">0.</span><span class="p">).</span><span class="nb">and</span><span class="p">.(</span><span class="n">y</span><span class="p">(</span><span class="n">i</span><span class="p">).</span><span class="n">gt</span><span class="p">.</span><span class="n">ytmin</span><span class="p">))</span> <span class="k">THEN</span>
<span class="k">            </span><span class="n">dtl</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">y</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">/</span><span class="n">dydt</span><span class="p">(</span><span class="n">i</span><span class="p">))</span><span class="o">*</span><span class="n">cy</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-28" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-28'>#</a>
          </div>
          
        </div>
        <div class='code'>
          <div class="highlight"><pre>     <span class="err">|</span>            <span class="o">*</span><span class="p">(</span><span class="mf">1.</span><span class="o">+</span><span class="p">(</span><span class="n">alog10</span><span class="p">(</span><span class="n">y</span><span class="p">(</span><span class="n">i</span><span class="p">))</span><span class="o">/</span><span class="n">alog10</span><span class="p">(</span><span class="n">ytmin</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>  <span class="c">!(Ref 2).</span>
            <span class="k">IF</span> <span class="p">(</span><span class="n">dtl</span><span class="p">.</span><span class="n">lt</span><span class="p">.</span><span class="n">dtmin</span><span class="p">)</span> <span class="n">dtmin</span> <span class="o">=</span> <span class="n">dtl</span>         <span class="c">!Find smallest time step.</span>
          <span class="k">END IF</span>
<span class="k">        END DO</span>
<span class="k">        IF</span> <span class="p">(</span><span class="n">dtmin</span><span class="p">.</span><span class="n">gt</span><span class="p">.</span><span class="mf">1.5</span><span class="o">*</span><span class="n">dt</span><span class="p">)</span> <span class="n">dtmin</span> <span class="o">=</span> <span class="mf">1.5</span><span class="o">*</span><span class="n">dt</span>       <span class="c">!Limit change in time step.</span>
        <span class="n">dt</span> <span class="o">=</span> <span class="n">dtmin</span>                 <span class="c">!Set new time step.</span>
      <span class="k">END IF</span>
<span class="k">      </span><span class="n">t</span> <span class="o">=</span> <span class="n">t</span> <span class="o">+</span> <span class="n">dt</span>                   <span class="c">!Increment time.</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-29" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-29'>#</a>
          </div>
          <p>..........STORE AND INCREMENT VALUES (Ref 3).</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="k">DO </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">mvar</span>
        <span class="n">v0</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>    <span class="o">=</span> <span class="n">v</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
        <span class="n">dvdt0</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">=</span> <span class="n">dvdt</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
        <span class="n">v</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>     <span class="o">=</span> <span class="n">v0</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="n">dvdt0</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">*</span><span class="n">dt</span>
        <span class="k">IF</span> <span class="p">((</span><span class="n">i</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">4</span><span class="p">).</span><span class="nb">and</span><span class="p">.(</span><span class="n">v</span><span class="p">(</span><span class="n">i</span><span class="p">).</span><span class="n">lt</span><span class="p">.</span><span class="n">ytmin</span><span class="p">))</span> <span class="n">v</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">=</span> <span class="n">ytmin</span>  <span class="c">!Set at minimum value.</span>
      <span class="k">END DO</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-30" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-30'>#</a>
          </div>
          <p>C30-----LOOP TWO----------------------------------------</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="n">loop</span> <span class="o">=</span> <span class="mi">2</span>                     <span class="c">!Step up loop counter.</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-31" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-31'>#</a>
          </div>
          <p>..........COMPUTE DERIVATIVES OF VARIABLES TO BE EVOLVED.</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="k">CALL </span><span class="n">derivs</span><span class="p">(</span><span class="n">loop</span><span class="p">)</span>
      <span class="nb">itime</span> <span class="o">=</span> <span class="mi">7</span>                    <span class="c">!Time = 2nd R-K loop.</span>
      <span class="k">CALL </span><span class="n">check</span>                   <span class="c">!Check interface subroutine.</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-32" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-32'>#</a>
          </div>
          <p>..........INCREMENT VALUES.</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="k">DO </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">mvar</span>
        <span class="n">v</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">=</span> <span class="n">v0</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="p">.</span><span class="mi">5</span><span class="o">*</span><span class="p">(</span><span class="n">dvdt</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="n">dvdt0</span><span class="p">(</span><span class="n">i</span><span class="p">))</span><span class="o">*</span><span class="n">dt</span>
        <span class="k">IF</span> <span class="p">((</span><span class="n">i</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span><span class="mi">4</span><span class="p">).</span><span class="nb">and</span><span class="p">.(</span><span class="n">v</span><span class="p">(</span><span class="n">i</span><span class="p">).</span><span class="n">lt</span><span class="p">.</span><span class="n">ytmin</span><span class="p">))</span> <span class="n">v</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">=</span> <span class="n">ytmin</span>  <span class="c">!Set at minimum value.</span>
      <span class="k">END DO</span>

<span class="k">      CALL </span><span class="n">log_interp_values</span><span class="p">(</span><span class="n">h_interp</span><span class="p">,</span> <span class="n">t9</span><span class="p">,</span> <span class="n">t9s</span><span class="p">,</span> <span class="n">hvs</span><span class="p">,</span> <span class="p">.</span><span class="n">true</span><span class="p">.,</span> <span class="n">nlines</span><span class="p">)</span>
      <span class="n">v</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">h_interp</span>

      <span class="n">GO</span> <span class="n">TO</span> <span class="mi">200</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-33" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-33'>#</a>
          </div>
          <p>C-------REFERENCES--------------------------------------</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-34" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-34'>#</a>
          </div>
          <p>1)  Constraint on dt from the requirement that</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-35" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-35'>#</a>
          </div>
          <p>(d(t9)/dt)*(dt/t9) &lt; ct</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-36" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-36'>#</a>
          </div>
          <p>Wagoner, R.V. 1969, Ap J. Suppl. No. 162, 18, page 293, equation C6.</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-37" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-37'>#</a>
          </div>
          <p>2)  Constraint on dt from</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-38" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-38'>#</a>
          </div>
          <p>dtl &lt; y/(dy/dt)<em>cy</em>(1+(log(y)/log(ytmin))**2)</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-39" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-39'>#</a>
          </div>
          <p>Wagoner, R.V. 1969, page 293, equation C7 but with log term squared.</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-40" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-40'>#</a>
          </div>
          <p>3)  Wagoner, R.V. 1969, page 292, equations C1, C2.</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="k">END</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-41" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-41'>#</a>
          </div>
          <p>C===============IDENTIFICATION DIVISION====================</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="k">SUBROUTINE </span><span class="n">start</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-42" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-42'>#</a>
          </div>
          <p>C-------LINKAGES.</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-43" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-43'>#</a>
          </div>
          <p>CALLED BY - [subroutine] driver</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-44" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-44'>#</a>
          </div>
          <p>CALLS     - [subroutine] rate1, bessel, rate0</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-45" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-45'>#</a>
          </div>
          <ul>
<li>[function] ex</li>
</ul>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-46" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-46'>#</a>
          </div>
          <p>C-------REMARKS.</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-47" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-47'>#</a>
          </div>
          <p>Sets initial conditions.</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="k">USE </span><span class="n">commons</span>
      <span class="k">USE </span><span class="n">sterile</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-48" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-48'>#</a>
          </div>
          <p>C-------COMMON AREAS.</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="k">COMMON</span> <span class="o">/</span><span class="n">rates</span><span class="o">/</span>  <span class="n">f</span><span class="p">,</span><span class="n">r</span>                            <span class="c">!Reaction rates.</span>
      <span class="k">COMMON</span> <span class="o">/</span><span class="n">evolp1</span><span class="o">/</span> <span class="n">t9</span><span class="p">,</span><span class="n">hv</span><span class="p">,</span><span class="n">phie</span><span class="p">,</span><span class="n">y</span>                   <span class="c">!Evolution parameters.</span>
      <span class="k">COMMON</span> <span class="o">/</span><span class="n">evolp2</span><span class="o">/</span> <span class="n">dt9</span><span class="p">,</span><span class="n">dhv</span><span class="p">,</span><span class="n">dphie</span><span class="p">,</span><span class="n">dydt</span><span class="p">(</span><span class="n">nnuc</span><span class="p">)</span>       <span class="c">!Evolution parameters.</span>
      <span class="k">COMMON</span> <span class="o">/</span><span class="n">evolp3</span><span class="o">/</span> <span class="n">t90</span><span class="p">,</span><span class="n">hv0</span><span class="p">,</span><span class="n">phie0</span><span class="p">,</span><span class="n">y0</span>               <span class="c">!Evolution parameters.</span>
      <span class="k">COMMON</span> <span class="o">/</span><span class="n">compr</span><span class="o">/</span>  <span class="n">cy</span><span class="p">,</span><span class="n">ct</span><span class="p">,</span><span class="n">t9i</span><span class="p">,</span><span class="n">t9f</span><span class="p">,</span><span class="n">ytmin</span><span class="p">,</span><span class="n">inc</span>        <span class="c">!Computation parameters.</span>
      <span class="k">COMMON</span> <span class="o">/</span><span class="n">modpr</span><span class="o">/</span>  <span class="n">g</span><span class="p">,</span><span class="n">tau</span><span class="p">,</span><span class="n">xnu</span><span class="p">,</span><span class="n">c</span><span class="p">,</span><span class="n">cosmo</span><span class="p">,</span><span class="n">xi</span>           <span class="c">!Model parameters.</span>
      <span class="k">COMMON</span> <span class="o">/</span><span class="n">varpr</span><span class="o">/</span>  <span class="n">dt1</span><span class="p">,</span><span class="n">eta1</span>                       <span class="c">!Variational parameters.</span>
      <span class="k">COMMON</span> <span class="o">/</span><span class="nb">time</span><span class="o">/</span>   <span class="n">t</span><span class="p">,</span><span class="n">dt</span><span class="p">,</span><span class="n">dlt9dt</span>                    <span class="c">!Time variables.</span>
      <span class="k">COMMON</span> <span class="o">/</span><span class="n">endens</span><span class="o">/</span> <span class="n">rhone0</span><span class="p">,</span><span class="n">rhob0</span><span class="p">,</span><span class="n">rhob</span><span class="p">,</span><span class="n">rnb</span>          <span class="c">!Energy densities.</span>
      <span class="k">COMMON</span> <span class="o">/</span><span class="n">xbessel</span><span class="o">/</span> <span class="n">bl1</span><span class="p">,</span><span class="n">bl2</span><span class="p">,</span><span class="n">bl3</span><span class="p">,</span><span class="n">bl4</span><span class="p">,</span><span class="n">bl5</span><span class="p">,</span>          <span class="c">!Eval of function bl(z).</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-49" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-49'>#</a>
          </div>
          
        </div>
        <div class='code'>
          <div class="highlight"><pre>     <span class="err">|</span>                <span class="n">bm1</span><span class="p">,</span><span class="n">bm2</span><span class="p">,</span><span class="n">bm3</span><span class="p">,</span><span class="n">bm4</span><span class="p">,</span><span class="n">bm5</span><span class="p">,</span>           <span class="c">!Eval of function bm(z).</span>
     <span class="err">|</span>                <span class="n">bn1</span><span class="p">,</span><span class="n">bn2</span><span class="p">,</span><span class="n">bn3</span><span class="p">,</span><span class="n">bn4</span><span class="p">,</span><span class="n">bn5</span>            <span class="c">!Eval of function bn(z).</span>
      <span class="k">COMMON</span> <span class="o">/</span><span class="n">flags</span><span class="o">/</span>  <span class="nb">ltime</span><span class="p">,</span><span class="k">is</span><span class="p">,</span><span class="n">ip</span><span class="p">,</span><span class="n">it</span><span class="p">,</span><span class="n">mbad</span>            <span class="c">!Flags,counters.</span>
      <span class="k">COMMON</span> <span class="o">/</span><span class="n">nupar</span><span class="o">/</span>  <span class="n">t9mev</span><span class="p">,</span><span class="n">tnmev</span><span class="p">,</span><span class="n">tnu</span><span class="p">,</span><span class="n">cnorm</span><span class="p">,</span><span class="n">nu</span><span class="p">,</span><span class="n">rhonu</span> <span class="c">!Neutrino parameters.</span>
      <span class="k">COMMON</span> <span class="o">/</span><span class="n">runopt</span><span class="o">/</span> <span class="n">irun</span><span class="p">,</span><span class="n">isize</span><span class="p">,</span><span class="n">jsize</span>               <span class="c">!Run options.</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-50" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-50'>#</a>
          </div>
          <p>C=================DECLARATION DIVISION=====================</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-51" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-51'>#</a>
          </div>
          <p>C-------REACTION RATES.</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="kt">DOUBLE PRECISION    </span><span class="n">f</span><span class="p">(</span><span class="n">nrec</span><span class="p">)</span>              <span class="c">!Forward reaction rate coefficients.</span>
      <span class="kt">DOUBLE PRECISION </span><span class="n">r</span><span class="p">(</span><span class="n">nrec</span><span class="p">)</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-52" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-52'>#</a>
          </div>
          <p>-------EVOLUTION PARAMETERS.</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="kt">DOUBLE PRECISION    </span><span class="n">t9</span>                   <span class="c">!Temperature (in units of 10**9 K).</span>
      <span class="kt">DOUBLE PRECISION    </span><span class="n">hv</span>                   <span class="c">!Defined by hv = M(atomic)n(baryon)/t9**3.</span>
      <span class="kt">DOUBLE PRECISION    </span><span class="n">phie</span>                 <span class="c">!Chemical potential of electron.</span>
      <span class="kt">DOUBLE PRECISION    </span><span class="n">y</span><span class="p">(</span><span class="n">nnuc</span><span class="p">)</span>              <span class="c">!Relative number abundances.</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-53" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-53'>#</a>
          </div>
          <p>C-------EVOLUTION PARAMETERS (ORIGINAL VALUES).</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="kt">DOUBLE PRECISION    </span><span class="n">y0</span><span class="p">(</span><span class="n">nnuc</span><span class="p">)</span>             <span class="c">!Rel # abund at start of iteration.</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-54" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-54'>#</a>
          </div>
          <p>C-------COMPUTATION SETTINGS.</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="kt">DOUBLE PRECISION    </span><span class="n">t9i</span>                  <span class="c">!Initial temperature (in 10**9 K).</span>
      <span class="kt">DOUBLE PRECISION    </span><span class="n">ytmin</span>                <span class="c">!Smallest abundances allowed.</span>
      <span class="kt">INTEGER </span><span class="n">inc</span>                  <span class="c">!Accumulation increment.</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-55" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-55'>#</a>
          </div>
          <p>C-------EARLY UNIVERSE MODEL PARAMETERS.</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="kt">DOUBLE PRECISION    </span><span class="n">g</span>                    <span class="c">!Gravitational constant.</span>
      <span class="kt">DOUBLE PRECISION    </span><span class="n">tau</span>                  <span class="c">!Neutron lifetime.</span>
      <span class="kt">DOUBLE PRECISION    </span><span class="n">xnu</span>                  <span class="c">!Number of neutrino species.</span>
      <span class="kt">DOUBLE PRECISION    </span><span class="n">c</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>               <span class="c">!c(1) is variation of gravitational constant.</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-56" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-56'>#</a>
          </div>
          
        </div>
        <div class='code'>
          <div class="highlight"><pre>     <span class="err">|</span>                             <span class="c">!c(2) is neutron lifetime (sec).</span>
     <span class="err">|</span>                             <span class="c">!c(3) is number of neutrino species.</span>
      <span class="kt">DOUBLE PRECISION    </span><span class="n">xi</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>                <span class="c">!Neutrino degeneracy parameters.</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-57" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-57'>#</a>
          </div>
          <p>C-------VARIATIONAL PARAMETERS.</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="kt">DOUBLE PRECISION    </span><span class="n">dt1</span>                  <span class="c">!Initial time step.</span>
      <span class="kt">DOUBLE PRECISION    </span><span class="n">eta1</span>                 <span class="c">!Baryon-to-photon ratio.</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-58" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-58'>#</a>
          </div>
          <p>C-------TIME VARIABLES.</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="kt">DOUBLE PRECISION    </span><span class="n">t</span>                    <span class="c">!Time.</span>
      <span class="kt">DOUBLE PRECISION    </span><span class="n">dt</span>                   <span class="c">!Time step.</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-59" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-59'>#</a>
          </div>
          <p>C-------ENERGY DENSITIES.</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="kt">DOUBLE PRECISION    </span><span class="n">rhone0</span>               <span class="c">!Initial electron neutrino mass density.</span>
      <span class="kt">DOUBLE PRECISION    </span><span class="n">rhob0</span>                <span class="c">!Initial baryon mass density.</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-60" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-60'>#</a>
          </div>
          <p>C-------EVALUATION OF FUNCTIONS bl,bm,bn.</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="kt">DOUBLE PRECISION    </span><span class="n">bl1</span><span class="p">,</span><span class="n">bl2</span><span class="p">,</span><span class="n">bl3</span><span class="p">,</span><span class="n">bl4</span><span class="p">,</span><span class="n">bl5</span>  <span class="c">!Evaluation of function bl(z).</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-61" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-61'>#</a>
          </div>
          <p>C-------COUNTERS AND FLAGS.</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="kt">INTEGER </span><span class="nb">ltime</span>                <span class="c">!Indicates if output buffer printed.</span>
      <span class="kt">INTEGER </span><span class="k">is</span>                   <span class="c">!# total time steps for particular run.</span>
      <span class="kt">INTEGER </span><span class="n">ip</span>                   <span class="c">!# time steps after outputting a line.</span>
      <span class="kt">INTEGER </span><span class="n">it</span>                   <span class="c">!# times accumulated in output buffer.</span>
      <span class="kt">INTEGER </span><span class="n">mbad</span>                 <span class="c">!Indicates if gaussian elimination fails.</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-62" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-62'>#</a>
          </div>
          <p>C-------NEUTRINO PARAMETERS.</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="kt">DOUBLE PRECISION    </span><span class="n">tnu</span>                  <span class="c">!Neutrino temperature.</span>
      <span class="kt">DOUBLE PRECISION    </span><span class="n">cnorm</span>                <span class="c">!Normalizing constant.</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-63" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-63'>#</a>
          </div>
          <p>C-------RUN OPTION.</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="kt">INTEGER </span><span class="n">isize</span>                <span class="c">!Number of nuclides in computation.</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-64" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-64'>#</a>
          </div>
          <p>C-------LOCAL VARIABLES.</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="kt">DOUBLE PRECISION    </span><span class="n">z</span>                 <span class="c">!Defined by z = m(electron)*c**2/k*t9.</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-65" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-65'>#</a>
          </div>
          <p>c Julien modified, 28-02-08</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="kt">DOUBLE PRECISION </span><span class="n">tr</span><span class="p">,</span><span class="n">xx</span><span class="p">,</span><span class="n">HH</span><span class="p">,</span><span class="n">t9r</span><span class="p">,</span><span class="n">dt9r</span><span class="p">,</span><span class="n">rhor</span><span class="p">,</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-66" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-66'>#</a>
          </div>
          
        </div>
        <div class='code'>
          <div class="highlight"><pre>     <span class="err">|</span>     <span class="n">r1r</span><span class="p">,</span><span class="n">r2r</span><span class="p">,</span><span class="n">r3r</span><span class="p">,</span><span class="n">r4r</span><span class="p">,</span><span class="n">r5r</span><span class="p">,</span><span class="n">r6r</span> <span class="c">!Variables used to read the data file</span>
      <span class="kt">DOUBLE PRECISION </span><span class="n">t_interp</span>             <span class="c">!This is used to obtain the correct time values</span>
      <span class="kt">CHARACTER </span><span class="n">trash</span>           <span class="c">!Used to remove the first line from the data</span>
      <span class="kt">DOUBLE PRECISION </span><span class="n">aT</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-67" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-67'>#</a>
          </div>
          <p>Julien end mod 28-02-08</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="kt">INTEGER</span> <span class="kd">::</span> <span class="n">e</span>
      <span class="kt">CHARACTER</span><span class="p">(</span><span class="mi">255</span><span class="p">)</span> <span class="kd">::</span> <span class="n">input_file</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-68" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-68'>#</a>
          </div>
          <p>C==================PROCEDURE DIVISION======================</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-69" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-69'>#</a>
          </div>
          <p>C10-----INITIALIZE FLAGS AND COUNTERS-------------------------</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="nb">ltime</span> <span class="o">=</span> <span class="mi">0</span>                    <span class="c">!No output yet.</span>
      <span class="k">is</span>    <span class="o">=</span> <span class="mi">1</span>                    <span class="c">!First iteration coming up.</span>
      <span class="n">ip</span>    <span class="o">=</span> <span class="n">inc</span>                  <span class="c">!Set to maximum allowed # of iteration.</span>
      <span class="n">it</span>    <span class="o">=</span> <span class="mi">0</span>                    <span class="c">!No accumulation yet.</span>
      <span class="n">mbad</span>  <span class="o">=</span> <span class="mi">0</span>                    <span class="c">!No computational errors.</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-70" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-70'>#</a>
          </div>
          <p>C20-----SETTINGS----------------------------------------</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-71" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-71'>#</a>
          </div>
          <p>C..........COMPUTATIONAL SETTINGS.</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="n">t9</span>  <span class="o">=</span> <span class="n">t9i</span>                    <span class="c">!Initial temperature.</span>
      <span class="n">tnu</span> <span class="o">=</span> <span class="n">t9</span>                     <span class="c">!Initial neutrino temperature.</span>
      <span class="n">t</span>   <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="n">const1</span><span class="o">*</span><span class="n">t9</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>       <span class="c">!Initial time (Ref 1).</span>
      <span class="n">dt</span>  <span class="o">=</span> <span class="n">dt1</span>                    <span class="c">!Initial time step.</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-72" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-72'>#</a>
          </div>
          <p>C..........MODEL SETTINGS.</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="n">g</span>   <span class="o">=</span> <span class="n">const2</span><span class="o">*</span><span class="n">c</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>            <span class="c">!Modify gravitational constant.</span>
      <span class="n">tau</span> <span class="o">=</span> <span class="n">c</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>                 <span class="c">!Convert n half-life (min) to lifetime (sec).</span>
      <span class="n">tau</span> <span class="o">=</span> <span class="n">tau</span><span class="o">/</span><span class="mf">0.98</span>               <span class="c">!Coulomb correction (Ref 2).</span>
      <span class="n">xnu</span> <span class="o">=</span> <span class="n">c</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>                   <span class="c">!Number of neutrino species.</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-73" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-73'>#</a>
          </div>
          <p>C30-----COMPUTE INITIAL ABUNDANCES FOR NEUTRON AND PROTON--------------</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="k">IF</span> <span class="p">((</span><span class="mi">1</span><span class="mf">5.011</span><span class="o">/</span><span class="n">t9</span><span class="o">+</span><span class="n">xi</span><span class="p">(</span><span class="mi">1</span><span class="p">)).</span><span class="n">gt</span><span class="p">.</span><span class="mi">5</span><span class="mf">8.</span><span class="p">)</span> <span class="k">THEN</span>      <span class="c">!Overabundance of antineutrinos.</span>
        <span class="n">y</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="mf">1.e-25</span>              <span class="c">!Very little of neutrons.</span>
        <span class="n">y</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="mf">1.</span>                  <span class="c">!Essentially all protons.</span>
      <span class="k">ELSE</span>
<span class="k">        IF</span> <span class="p">((</span><span class="mi">1</span><span class="mf">5.011</span><span class="o">/</span><span class="n">t9</span><span class="o">+</span><span class="n">xi</span><span class="p">(</span><span class="mi">1</span><span class="p">)).</span><span class="n">lt</span><span class="p">.</span><span class="o">-</span><span class="mi">5</span><span class="mf">8.</span><span class="p">)</span> <span class="k">THEN</span>   <span class="c">!Overabundance of neutrinos.</span>
          <span class="n">y</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="mf">1.</span>                <span class="c">!Essentially all neutrons.</span>
          <span class="n">y</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="mf">1.e-25</span>            <span class="c">!Very little of protons.</span>
        <span class="k">ELSE</span>
<span class="k">          </span><span class="n">y</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="mf">1.</span><span class="o">/</span><span class="p">(</span><span class="n">ex</span><span class="p">(</span><span class="mi">1</span><span class="mf">5.011</span><span class="o">/</span><span class="n">t9</span><span class="o">+</span><span class="n">xi</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">+</span><span class="mf">1.</span><span class="p">)</span>  <span class="c">!Initial n abundance (Ref 3).</span>
          <span class="n">y</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="mf">1.</span><span class="o">/</span><span class="p">(</span><span class="n">ex</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="mf">5.011</span><span class="o">/</span><span class="n">t9</span><span class="o">-</span><span class="n">xi</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="o">+</span><span class="mf">1.</span><span class="p">)</span> <span class="c">!Initial p abundance (Ref 3).</span>
        <span class="k">END IF</span>
<span class="k">      END IF</span>
<span class="k">      IF</span> <span class="p">(</span><span class="n">xi</span><span class="p">(</span><span class="mi">1</span><span class="p">).</span><span class="n">ne</span><span class="p">.</span><span class="mf">0.</span><span class="p">)</span> <span class="k">THEN</span>        <span class="c">!Electron neutrino degeneracy.</span>
        <span class="n">cnorm</span> <span class="o">=</span> <span class="mf">1.</span>
        <span class="n">tnu</span>   <span class="o">=</span> <span class="p">.</span><span class="mi">00001</span>             <span class="c">!Low temperature.</span>
        <span class="k">CALL </span><span class="n">rate1</span><span class="p">(</span><span class="mf">0.00001</span><span class="p">)</span>        <span class="c">!Find normalization constant at low temp.</span>
        <span class="n">cnorm</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">tau</span><span class="o">/</span><span class="n">f</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">print</span> <span class="o">*</span><span class="p">,</span> <span class="n">cnorm</span>
      <span class="k">END IF</span>
<span class="k">      </span><span class="n">y0</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">y</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
      <span class="n">y0</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">y</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-74" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-74'>#</a>
          </div>
          <p>c Julien modified, 28-02-08 - 05-03-08</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-75" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-75'>#</a>
          </div>
          <p>60----READ OUTPUT FILE FROM OTHER PROGRAM AND SAVE DATA -------</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="k">CALL </span><span class="nb">GETENV</span><span class="p">(</span><span class="s2">&quot;INPUT&quot;</span><span class="p">,</span> <span class="n">input_file</span><span class="p">)</span>
      <span class="n">input_file</span> <span class="o">=</span> <span class="nb">TRIM</span><span class="p">(</span><span class="n">input_file</span><span class="p">)</span>
      <span class="k">IF</span> <span class="p">(</span><span class="n">input_file</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="k">THEN</span>
<span class="k">        </span><span class="n">input_file</span> <span class="o">=</span> <span class="s1">&#39;s4.dat&#39;</span>
      <span class="k">END IF</span>
<span class="k">      PRINT</span> <span class="o">*</span><span class="p">,</span> <span class="s1">&#39;Reading custom data from: &#39;</span><span class="p">,</span> <span class="n">input_file</span>
      <span class="k">OPEN</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="k">file</span><span class="o">=</span><span class="n">input_file</span><span class="p">,</span> <span class="n">status</span><span class="o">=</span><span class="s1">&#39;old&#39;</span><span class="p">)</span> <span class="c">!Here give the name of the outputted file</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-76" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-76'>#</a>
          </div>
          
        </div>
        <div class='code'>
          <div class="highlight"><pre>     <span class="err">|</span>                        <span class="c">! from the other program</span>
      <span class="k">READ</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="o">*</span><span class="p">,</span> <span class="n">IOSTAT</span><span class="o">=</span><span class="n">e</span><span class="p">)</span> <span class="n">trash</span> <span class="c">!Get the number of written lines</span>
      <span class="k">IF</span> <span class="p">(</span><span class="n">e</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>
<span class="k">        READ</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="n">trash</span>           <span class="c">!Remove the second line that are labels</span>
      <span class="k">END IF</span>

<span class="k">      </span><span class="n">nlines</span><span class="o">=</span><span class="mi">0</span>
      <span class="k">DO</span>
<span class="k">        READ</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="o">*</span><span class="p">,</span><span class="k">end</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span> <span class="n">tr</span><span class="p">,</span><span class="n">xx</span><span class="p">,</span><span class="n">t9r</span><span class="p">,</span><span class="n">dt9r</span><span class="p">,</span><span class="n">rhor</span><span class="p">,</span><span class="n">HH</span><span class="p">,</span><span class="n">r1r</span><span class="p">,</span><span class="n">r2r</span><span class="p">,</span><span class="n">r3r</span><span class="p">,</span><span class="n">r4r</span><span class="p">,</span><span class="n">r5r</span><span class="p">,</span><span class="n">r6r</span>
        <span class="n">nlines</span><span class="o">=</span><span class="n">nlines</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="n">ts</span><span class="p">(</span><span class="n">nlines</span><span class="p">)</span> <span class="o">=</span> <span class="n">tr</span>
        <span class="n">t9s</span><span class="p">(</span><span class="n">nlines</span><span class="p">)</span> <span class="o">=</span> <span class="n">t9r</span>
        <span class="n">dt9s</span><span class="p">(</span><span class="n">nlines</span><span class="p">)</span> <span class="o">=</span> <span class="n">dt9r</span>
        <span class="n">rho_tot</span><span class="p">(</span><span class="n">nlines</span><span class="p">)</span> <span class="o">=</span> <span class="n">rhor</span>
        <span class="n">ratef</span><span class="p">(</span><span class="n">nlines</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="n">r1r</span> <span class="o">+</span> <span class="n">r3r</span> <span class="o">+</span> <span class="n">r5r</span><span class="p">)</span> <span class="c">!Will divide them by tau later on</span>
        <span class="n">rater</span><span class="p">(</span><span class="n">nlines</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="n">r2r</span> <span class="o">+</span> <span class="n">r4r</span> <span class="o">+</span> <span class="n">r6r</span><span class="p">)</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-77" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-77'>#</a>
          </div>
          
        </div>
        <div class='code'>
          <div class="highlight"><pre>	<span class="n">aTs</span><span class="p">(</span><span class="n">nlines</span><span class="p">)</span> <span class="o">=</span> <span class="n">xx</span><span class="o">*</span><span class="n">t9r</span>
	<span class="n">hvs</span><span class="p">(</span><span class="n">nlines</span><span class="p">)</span> <span class="o">=</span>  <span class="mf">1.</span> <span class="o">/</span> <span class="n">aTs</span><span class="p">(</span><span class="n">nlines</span><span class="p">)</span><span class="o">**</span><span class="mi">3</span>
      <span class="k">END DO</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-78" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-78'>#</a>
          </div>
          <p>Saves the different used datas from the file into the corresponding</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-79" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-79'>#</a>
          </div>
          <p>arrays</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre><span class="mi">10</span>    <span class="k">CLOSE</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

      <span class="n">hvs</span> <span class="o">=</span> <span class="mf">3.3683e+4</span> <span class="o">*</span> <span class="n">eta1</span> <span class="o">*</span> <span class="n">hvs</span> <span class="o">*</span> <span class="n">aTs</span><span class="p">(</span><span class="n">nlines</span><span class="p">)</span><span class="o">**</span><span class="mi">3</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-80" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-80'>#</a>
          </div>
          <p>hvs = 3.3683e+4 * 4.75e-10 * hvs * aTs(nlines)**3
aT = aTs(nlines) / aTs(1)</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="n">rater</span> <span class="o">=</span> <span class="n">rater</span> <span class="o">/</span> <span class="n">ratef</span><span class="p">(</span><span class="n">nlines</span><span class="p">)</span>
      <span class="n">ratef</span> <span class="o">=</span> <span class="n">ratef</span> <span class="o">/</span> <span class="n">ratef</span><span class="p">(</span><span class="n">nlines</span><span class="p">)</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-81" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-81'>#</a>
          </div>
          <p>These divisions are for normalisation so that for T-&gt;0 (taken to be our</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-82" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-82'>#</a>
          </div>
          <p>last outputted values), the neutron decay rate (ratef) is equal to 1</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-83" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-83'>#</a>
          </div>
          <p>(and lated on we'll divide by 1/tau so that this rate is equal to</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-84" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-84'>#</a>
          </div>
          <p>the real neutron decay rate). Such a normalisation is already done in</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-85" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-85'>#</a>
          </div>
          <p>the other program so that ratef(nlines) was already nearly equal to 1,</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-86" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-86'>#</a>
          </div>
          <p>but the previous normalization is not taking into account the change that</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-87" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-87'>#</a>
          </div>
          <p>could come from adding sterile neutrinos.</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="k">CALL </span><span class="n">log_interp_values</span><span class="p">(</span><span class="n">t_interp</span><span class="p">,</span> <span class="n">t9</span><span class="p">,</span> <span class="n">t9s</span><span class="p">,</span> <span class="n">ts</span><span class="p">,</span> <span class="p">.</span><span class="n">true</span><span class="p">.,</span> <span class="n">nlines</span><span class="p">)</span>
      <span class="n">ts</span> <span class="o">=</span> <span class="n">ts</span> <span class="o">-</span> <span class="p">(</span><span class="n">t_interp</span> <span class="o">-</span> <span class="n">t</span><span class="p">)</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-88" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-88'>#</a>
          </div>
          <p>In these 2 lines we do the following: the value from our time ts is</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-89" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-89'>#</a>
          </div>
          <p>not the same as the one used by Kawano (not same initial time condition)</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-90" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-90'>#</a>
          </div>
          <p>so we determine how to put our time in agreement with his. First, the</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-91" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-91'>#</a>
          </div>
          <p>initial time is determined by the initial temperature, so we determine</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-92" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-92'>#</a>
          </div>
          <p>in our data to which time this initial temperature corresponds (first</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-93" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-93'>#</a>
          </div>
          <p>line). And then we subtract to our datas the value of the difference</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-94" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-94'>#</a>
          </div>
          <p>between our time and the one from Kawano, so that at this temperature</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-95" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-95'>#</a>
          </div>
          <p>we have exactly the same time value.</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-96" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-96'>#</a>
          </div>
          <p>But this time is in fact not really used in our modifications.</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-97" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-97'>#</a>
          </div>
          <p>c Julien end mod 28-02-08 - 05-03-08</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-98" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-98'>#</a>
          </div>
          <p>C40-----FIND RATIO OF BARYON DENSITY TO TEMPERATURE CUBED--------------</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="n">z</span>      <span class="o">=</span> <span class="mf">5.930</span><span class="o">/</span><span class="n">t9</span>            <span class="c">!Inverse of temperature.</span>
      <span class="k">CALL </span><span class="n">bessel</span><span class="p">(</span><span class="n">z</span><span class="p">)</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-99" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-99'>#</a>
          </div>
          <p>hv     = 3.3683e+4<em>eta1</em>aT**3 !(Ref 4 but with final
hv = hvs(1) </p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="k">CALL </span><span class="n">log_interp_values</span><span class="p">(</span><span class="n">hv</span><span class="p">,</span> <span class="n">t9</span><span class="p">,</span> <span class="n">t9s</span><span class="p">,</span> <span class="n">hvs</span><span class="p">,</span> <span class="p">.</span><span class="n">true</span><span class="p">.,</span> <span class="n">nlines</span><span class="p">)</span>
      <span class="n">phie</span>   <span class="o">=</span> <span class="n">hv</span><span class="o">*</span><span class="p">(</span><span class="mf">1.784e-5</span><span class="o">*</span><span class="n">y</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>  <span class="c">!Chemical potential of electron (Ref 5).</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-100" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-100'>#</a>
          </div>
          
        </div>
        <div class='code'>
          <div class="highlight"><pre>     <span class="err">|</span>            <span class="o">/</span><span class="p">(.</span><span class="mi">5</span><span class="o">*</span><span class="n">z</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="p">(</span><span class="n">bl1</span><span class="o">-</span><span class="mf">2.</span><span class="o">*</span><span class="n">bl2</span><span class="o">+</span><span class="mf">3.</span><span class="o">*</span><span class="n">bl3</span><span class="o">-</span><span class="mf">4.</span><span class="o">*</span><span class="n">bl4</span><span class="o">+</span><span class="mf">5.</span><span class="o">*</span><span class="n">bl5</span><span class="p">))</span>
      <span class="n">rhob0</span>  <span class="o">=</span> <span class="n">hv</span><span class="o">*</span><span class="n">t9</span><span class="o">**</span><span class="mi">3</span>            <span class="c">!Baryon density.</span>
      <span class="k">IF</span> <span class="p">((</span><span class="n">xi</span><span class="p">(</span><span class="mi">1</span><span class="p">).</span><span class="n">eq</span><span class="p">.</span><span class="mf">0.</span><span class="p">).</span><span class="nb">and</span><span class="p">.(</span><span class="n">xi</span><span class="p">(</span><span class="mi">2</span><span class="p">).</span><span class="n">eq</span><span class="p">.</span><span class="mf">0.</span><span class="p">).</span><span class="nb">and</span><span class="p">.(</span><span class="n">xi</span><span class="p">(</span><span class="mi">3</span><span class="p">).</span><span class="n">eq</span><span class="p">.</span><span class="mi">0</span><span class="p">))</span> <span class="k">THEN</span>  <span class="c">!Nondegen.</span>
        <span class="n">rhone0</span> <span class="o">=</span> <span class="mf">7.366</span><span class="o">*</span><span class="n">t9</span><span class="o">**</span><span class="mi">4</span>       <span class="c">!Electron neutrino density (Ref 6).</span>
      <span class="k">END IF</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-101" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-101'>#</a>
          </div>
          <p>C50-----SET ABUNDANCES FOR REST OF NUCLIDES----------------------</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="n">y</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>  <span class="o">=</span> <span class="n">y</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">y</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">rhob0</span><span class="o">*</span><span class="n">ex</span><span class="p">(</span><span class="mi">2</span><span class="mf">5.82</span><span class="o">/</span><span class="n">t9</span><span class="p">)</span><span class="o">/</span><span class="p">(.</span><span class="mi">47</span><span class="err">1</span><span class="n">e</span><span class="o">+</span><span class="mi">10</span><span class="o">*</span><span class="n">t9</span><span class="o">**</span><span class="mf">1.5</span><span class="p">)</span>  <span class="c">!(Ref 7).</span>
      <span class="n">y0</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">y</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
      <span class="k">DO </span><span class="n">i</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span><span class="n">isize</span>
        <span class="n">y</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>  <span class="o">=</span> <span class="n">ytmin</span>              <span class="c">!Set rest to minimum abundance.</span>
        <span class="n">y0</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">=</span> <span class="n">y</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>               <span class="c">!Init abundances at beginning of iteration.</span>
      <span class="k">END DO</span>
<span class="k">      CALL </span><span class="n">rate0</span>                   <span class="c">!Compute weak decay rates.</span>


      <span class="k">RETURN</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-102" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-102'>#</a>
          </div>
          <p>C-------REFERENCES--------------------------------------</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-103" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-103'>#</a>
          </div>
          <p>1) Wagoner, R.V., Fowler, W.A., and Hoyle, F. 1967, Ap. J. 148,</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-104" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-104'>#</a>
          </div>
          <p>page 44, equation A15.</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-105" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-105'>#</a>
          </div>
          <p>2) Coulomb correction obtained by dividing by correction factor Fp(t9)</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-106" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-106'>#</a>
          </div>
          <p>Fp(t9) = 1 - 0.5(pi/(137<v>/c))</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-107" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-107'>#</a>
          </div>
          <p>Wagoner, R.V. 1973, Ap. J. 179, page 358.</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-108" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-108'>#</a>
          </div>
          <p>3) For the nondegenerate case:</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-109" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-109'>#</a>
          </div>
          <p>Wagoner, R.V., Fowler, W.A., and Hoyle, F. 1967, Ap. J. 148,</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-110" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-110'>#</a>
          </div>
          <p>page 4, equation 3.</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-111" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-111'>#</a>
          </div>
          <p>For the case with neutrino degeneracy:</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-112" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-112'>#</a>
          </div>
          <p>Beaudet,G. and Goret,P., 1976, Astron. &amp; Astrophys., 49,</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-113" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-113'>#</a>
          </div>
          <p>page 417, equation 9.</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-114" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-114'>#</a>
          </div>
          <p>4) Wagoner, R.V. 1969, Ap J. Suppl. No. 162, 18, page 250, equation 4.</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-115" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-115'>#</a>
          </div>
          <p>3.3683e+4 = Mu(ng/t9**3) with Mu the atomic mass, ng the</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-116" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-116'>#</a>
          </div>
          <p>photon density.  2.75 is for the 11/4 factor difference</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-117" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-117'>#</a>
          </div>
          <p>between the initial and final values of eta.</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-118" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-118'>#</a>
          </div>
          <p>5) Kawano, L., 1992, Fermilab preprint FERMILAB-PUB-92/04-A,</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-119" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-119'>#</a>
          </div>
          <p>Kellogg Radiation Lab preprint OAP-714,</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-120" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-120'>#</a>
          </div>
          <p>equation D.2.</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-121" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-121'>#</a>
          </div>
          <p>6) Wagoner, R.V., Fowler, W.A., and Hoyle, F. 1967, Ap. J. 148,</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-122" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-122'>#</a>
          </div>
          <p>page 43, equation A4.</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-123" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-123'>#</a>
          </div>
          <p>7.366 is used instead of 14.73 as the latter is the sum total</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-124" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-124'>#</a>
          </div>
          <p>for 2 neutrino species.</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-125" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-125'>#</a>
          </div>
          <p>7) Initial deuterium abundance from nuclear statistical equilibrium</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-126" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-126'>#</a>
          </div>
          <p>Wagoner, R.V., Fowler, W.A., and Hoyle, F. 1967, Ap. J. 148,</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-127" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-127'>#</a>
          </div>
          <p>page 19, equation 17.</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="k">END</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-128" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-128'>#</a>
          </div>
          <p>C===============IDENTIFICATION DIVISION====================</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="k">SUBROUTINE </span><span class="n">derivs</span><span class="p">(</span><span class="n">loop</span><span class="p">)</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-129" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-129'>#</a>
          </div>
          <p>C-------LINKAGES.</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-130" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-130'>#</a>
          </div>
          <p>CALLED BY - [subroutine] driver</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-131" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-131'>#</a>
          </div>
          <p>CALLS     - [subroutine] therm, rate1, rate4, rate3, rate2, sol</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-132" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-132'>#</a>
          </div>
          <p>C-------REMARKS.</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-133" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-133'>#</a>
          </div>
          <p>Computes derivatives of</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-134" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-134'>#</a>
          </div>
          <ul>
<li>Temperature</li>
</ul>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-135" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-135'>#</a>
          </div>
          <ul>
<li>hv</li>
</ul>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-136" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-136'>#</a>
          </div>
          <ul>
<li>Chemical potential</li>
</ul>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-137" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-137'>#</a>
          </div>
          <ul>
<li>abundances</li>
</ul>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="k">USE </span><span class="n">commons</span>
      <span class="k">USE </span><span class="n">sterile</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-138" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-138'>#</a>
          </div>
          <p>C-------COMMON AREAS.</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="k">COMMON</span> <span class="o">/</span><span class="n">evolp1</span><span class="o">/</span> <span class="n">t9</span><span class="p">,</span><span class="n">hv</span><span class="p">,</span><span class="n">phie</span><span class="p">,</span><span class="n">y</span>                   <span class="c">!Evolution parameters.</span>
      <span class="k">COMMON</span> <span class="o">/</span><span class="n">evolp2</span><span class="o">/</span> <span class="n">dt9</span><span class="p">,</span><span class="n">dhv</span><span class="p">,</span><span class="n">dphie</span><span class="p">,</span><span class="n">dydt</span>             <span class="c">!Evolution parameters.</span>
      <span class="k">COMMON</span> <span class="o">/</span><span class="n">evolp3</span><span class="o">/</span> <span class="n">t90</span><span class="p">,</span><span class="n">hv0</span><span class="p">,</span><span class="n">phie0</span><span class="p">,</span><span class="n">y0</span>               <span class="c">!Evolution parameters.</span>
      <span class="k">COMMON</span> <span class="o">/</span><span class="n">modpr</span><span class="o">/</span>  <span class="n">g</span><span class="p">,</span><span class="n">tau</span><span class="p">,</span><span class="n">xnu</span><span class="p">,</span><span class="n">c</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="n">cosmo</span><span class="p">,</span><span class="n">xi</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>     <span class="c">!Model parameters.</span>
      <span class="k">COMMON</span> <span class="o">/</span><span class="nb">time</span><span class="o">/</span>   <span class="n">t</span><span class="p">,</span><span class="n">dt</span><span class="p">,</span><span class="n">dlt9dt</span>                    <span class="c">!Time variables.</span>
      <span class="k">COMMON</span> <span class="o">/</span><span class="n">xtherm</span><span class="o">/</span>  <span class="n">thm</span><span class="p">,</span><span class="n">hubcst</span>                     <span class="c">!Dynamic variables.</span>
      <span class="k">COMMON</span> <span class="o">/</span><span class="n">endens</span><span class="o">/</span> <span class="n">rhone0</span><span class="p">,</span><span class="n">rhob0</span><span class="p">,</span><span class="n">rhob</span><span class="p">,</span><span class="n">rnb</span>          <span class="c">!Energy densities.</span>
      <span class="k">COMMON</span> <span class="o">/</span><span class="n">nucdat</span><span class="o">/</span> <span class="n">am</span><span class="p">(</span><span class="n">nnuc</span><span class="p">),</span><span class="n">zm</span><span class="p">,</span><span class="n">dm</span>                 <span class="c">!Nuclide data.</span>
      <span class="k">COMMON</span> <span class="o">/</span><span class="n">flags</span><span class="o">/</span>  <span class="nb">ltime</span><span class="p">,</span><span class="k">is</span><span class="p">,</span><span class="n">ip</span><span class="p">,</span><span class="n">it</span><span class="p">,</span><span class="n">mbad</span>            <span class="c">!Flags,counters.</span>
      <span class="k">COMMON</span> <span class="o">/</span><span class="n">runopt</span><span class="o">/</span> <span class="n">irun</span><span class="p">,</span><span class="n">isize</span><span class="p">,</span><span class="n">jsize</span>               <span class="c">!Run options.</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-139" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-139'>#</a>
          </div>
          <p>C=================DECLARATION DIVISION=====================</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-140" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-140'>#</a>
          </div>
          <p>C-------EVOLUTION PARAMETERS.</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="kt">DOUBLE PRECISION    </span><span class="n">t9</span>                   <span class="c">!Temperature (in units of 10**9 K).</span>
      <span class="kt">DOUBLE PRECISION    </span><span class="n">hv</span>                   <span class="c">!Defined by hv = M(atomic)n(baryon)/t9**3.</span>
      <span class="kt">DOUBLE PRECISION    </span><span class="n">phie</span>                 <span class="c">!Chemical potential for electron.</span>
      <span class="kt">DOUBLE PRECISION    </span><span class="n">y</span><span class="p">(</span><span class="n">nnuc</span><span class="p">)</span>              <span class="c">!Relative number abundances.</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-141" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-141'>#</a>
          </div>
          <p>C-------EVOLUTION PARAMETERS (DERIVATIVES).</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="kt">DOUBLE PRECISION    </span><span class="n">dt9</span>                  <span class="c">!Change in temperature.</span>
      <span class="kt">DOUBLE PRECISION    </span><span class="n">dhv</span>                  <span class="c">!Change in hv.</span>
      <span class="kt">DOUBLE PRECISION    </span><span class="n">dphie</span>                <span class="c">!Change in chemical potential.</span>
      <span class="kt">DOUBLE PRECISION    </span><span class="n">dydt</span><span class="p">(</span><span class="n">nnuc</span><span class="p">)</span>           <span class="c">!Change in rel number abundances.</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-142" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-142'>#</a>
          </div>
          <p>C-------EVOLUTION PARAMETERS (ORIGINAL VALUES).</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="kt">DOUBLE PRECISION    </span><span class="n">y0</span><span class="p">(</span><span class="n">nnuc</span><span class="p">)</span>             <span class="c">!Rel # abund at beginning of iteration.</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-143" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-143'>#</a>
          </div>
          <p>C-------MODEL PARAMETERS.</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="kt">DOUBLE PRECISION    </span><span class="n">g</span>                    <span class="c">!Gravitational constant.</span>
      <span class="kt">DOUBLE PRECISION    </span><span class="n">cosmo</span>                <span class="c">!Cosmological constant.</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-144" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-144'>#</a>
          </div>
          <p>C-------TIME VARIABLES.</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="kt">DOUBLE PRECISION    </span><span class="n">dlt9dt</span>               <span class="c">!(1/t9)*d(t9)/d(t).</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-145" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-145'>#</a>
          </div>
          <p>C-------DYNAMIC VARIABLES.</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="kt">DOUBLE PRECISION    </span><span class="n">thm</span><span class="p">(</span><span class="mi">14</span><span class="p">)</span>              <span class="c">!Thermodynamic variables.</span>
      <span class="kt">DOUBLE PRECISION    </span><span class="n">hubcst</span>               <span class="c">!Expansion rate.</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-146" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-146'>#</a>
          </div>
          <p>C-------ENERGY DENSITIES.</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="kt">DOUBLE PRECISION    </span><span class="n">rhob0</span>                <span class="c">!Initial baryon mass density.</span>
      <span class="kt">DOUBLE PRECISION    </span><span class="n">rhob</span>                 <span class="c">!Baryon mass density.</span>
      <span class="kt">DOUBLE PRECISION    </span><span class="n">rnb</span>                  <span class="c">!Baryon mass density (ratio to init value).</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-147" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-147'>#</a>
          </div>
          <p>C-------NUCLIDE DATA.</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="kt">DOUBLE PRECISION    </span><span class="n">zm</span><span class="p">(</span><span class="n">nnuc</span><span class="p">)</span>             <span class="c">!Charge of nuclide.</span>
      <span class="kt">DOUBLE PRECISION    </span><span class="n">dm</span><span class="p">(</span><span class="n">nnuc</span><span class="p">)</span>             <span class="c">!Mass excess of nuclide.</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-148" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-148'>#</a>
          </div>
          <p>C-------COUNTERS AND FLAGS.</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="kt">INTEGER </span><span class="n">mbad</span>                 <span class="c">!Indicates if gaussian elimination fails.</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-149" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-149'>#</a>
          </div>
          <p>C-------RUN OPTION.</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="kt">INTEGER </span><span class="n">irun</span>                 <span class="c">!Run network size.</span>
      <span class="kt">INTEGER </span><span class="n">isize</span>                <span class="c">!Number of nuclides in computation.</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-150" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-150'>#</a>
          </div>
          <p>C-------SUMS.</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="kt">DOUBLE PRECISION    </span><span class="n">sumy</span>                 <span class="c">!Sum of abundances.</span>
      <span class="kt">DOUBLE PRECISION    </span><span class="n">sumzy</span>                <span class="c">!Sum of charge*abundances.</span>
      <span class="kt">DOUBLE PRECISION    </span><span class="n">sumdy</span>                <span class="c">!Sum of abundance flows.</span>
      <span class="kt">DOUBLE PRECISION    </span><span class="n">summdy</span>               <span class="c">!Sum of (mass excess)*(abundance flows).</span>
      <span class="kt">DOUBLE PRECISION    </span><span class="n">sumzdy</span>               <span class="c">!Sum of (charge)*(abundance flows).</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-151" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-151'>#</a>
          </div>
          <p>C-------DERIVATIVES.</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="kt">DOUBLE PRECISION    </span><span class="n">dphdt9</span>               <span class="c">!d(phi e)/d(t9).</span>
      <span class="kt">DOUBLE PRECISION    </span><span class="n">dphdln</span>               <span class="c">!d(phi e)/d(h).</span>
      <span class="kt">DOUBLE PRECISION    </span><span class="n">dphdzy</span>               <span class="c">!d(phi e)/d(sumzy).</span>
      <span class="kt">DOUBLE PRECISION    </span><span class="n">dlndt9</span>               <span class="c">!(1/h)*d(h)/d(t9).</span>
      <span class="kt">DOUBLE PRECISION    </span><span class="n">bar</span>                  <span class="c">!Baryon density and pressure terms.</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-152" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-152'>#</a>
          </div>
          <p>C-------LOCAL VARIABLES.</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="kt">INTEGER </span><span class="n">loop</span>              <span class="c">!Counts which Runge-Kutta loop.</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-153" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-153'>#</a>
          </div>
          <p>Julien modified, 05-03-08</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="kt">DOUBLE PRECISION </span><span class="n">dt9_interp</span>           <span class="c">!The interpolated dt9 value from dt9s</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-154" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-154'>#</a>
          </div>
          <p>Julien end mod 05-03-08</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-155" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-155'>#</a>
          </div>
          <p>C==================PROCEDURE DIVISION======================</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-156" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-156'>#</a>
          </div>
          <p>C10-----COMPUTE DERIVATIVES FOR ABUNDANCES-----------------------</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="n">rnb</span>    <span class="o">=</span> <span class="n">hv</span><span class="o">*</span><span class="n">t9</span><span class="o">*</span><span class="n">t9</span><span class="o">*</span><span class="n">t9</span><span class="o">/</span><span class="n">rhob0</span>   <span class="c">!Baryon mass density (ratio to init value).</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-157" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-157'>#</a>
          </div>
          <p>..........VARIOUS THERMODYNAMIC QUANTITIES.</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="k">CALL </span><span class="n">therm</span>
      <span class="n">hubcst</span> <span class="o">=</span> <span class="nb">sqrt</span><span class="p">((</span><span class="mf">8.</span><span class="o">/</span><span class="mf">3.</span><span class="p">)</span><span class="o">*</span><span class="n">pi</span><span class="o">*</span><span class="n">g</span><span class="o">*</span><span class="p">(</span><span class="n">thm</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span><span class="o">+</span><span class="p">(</span><span class="n">cosmo</span><span class="o">/</span><span class="mf">3.</span><span class="p">))</span>  <span class="c">!Expansion rate.</span>
      <span class="n">rhob</span>   <span class="o">=</span> <span class="n">thm</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span>             <span class="c">!Baryon mass density.</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-158" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-158'>#</a>
          </div>
          <p>..........COMPUTE REACTION RATE COEFFICIENTS.</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="k">CALL </span><span class="n">rate1</span><span class="p">(</span><span class="n">t9</span><span class="p">)</span>
      <span class="n">GO</span> <span class="n">TO</span> <span class="p">(</span><span class="mi">100</span><span class="p">,</span><span class="mi">110</span><span class="p">,</span><span class="mi">120</span><span class="p">),</span> <span class="n">irun</span>    <span class="c">!Run network selection.</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-159" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-159'>#</a>
          </div>
          
        </div>
        <div class='code'>
          <div class="highlight"><pre> <span class="mi">100</span>  <span class="k">CONTINUE</span>
<span class="k">        CALL </span><span class="n">rate4</span>                 <span class="c">!Forward rate for all of reactions.</span>
 <span class="mi">110</span>  <span class="k">CONTINUE</span>
<span class="k">        CALL </span><span class="n">rate3</span>                 <span class="c">!Forward rate for reactions with A &lt; 19.</span>
 <span class="mi">120</span>  <span class="k">CONTINUE</span>
<span class="k">        CALL </span><span class="n">rate2</span>                 <span class="c">!Forward rate for reactions with A &lt; 10.</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-160" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-160'>#</a>
          </div>
          <p>..........SOLVE COUPLED DIFFERENTIAL EQUATIONS.</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="k">CALL </span><span class="n">sol</span><span class="p">(</span><span class="n">loop</span><span class="p">)</span>
      <span class="k">IF</span> <span class="p">(</span><span class="n">mbad</span><span class="p">.</span><span class="n">gt</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span> <span class="k">RETURN</span>        <span class="c">!Abort in case matrix not invertible.</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-161" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-161'>#</a>
          </div>
          <p>C20-----COMPUTE DERIVATIVES FOR TEMPERATURE, hv, AND CHEMICAL POTENTIAL------</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-162" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-162'>#</a>
          </div>
          <p>C..........INITIALIZE SUMS TO ZERO.</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="n">sumy</span>   <span class="o">=</span> <span class="mf">0.</span>
      <span class="n">sumzy</span>  <span class="o">=</span> <span class="mf">0.</span>
      <span class="n">sumdy</span>  <span class="o">=</span> <span class="mf">0.</span>
      <span class="n">summdy</span> <span class="o">=</span> <span class="mf">0.</span>
      <span class="n">sumzdy</span> <span class="o">=</span> <span class="mf">0.</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-163" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-163'>#</a>
          </div>
          <p>..........ACCUMULATE TO GET SUM.</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="k">DO </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">isize</span>
        <span class="n">sumy</span>   <span class="o">=</span> <span class="n">sumy</span>   <span class="o">+</span> <span class="n">y</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>           <span class="c">!Sum of abundance.</span>
        <span class="n">sumzy</span>  <span class="o">=</span> <span class="n">sumzy</span>  <span class="o">+</span> <span class="n">zm</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">*</span><span class="n">y</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>     <span class="c">!Sum of charge*abundance.</span>
        <span class="n">sumdy</span>  <span class="o">=</span> <span class="n">sumdy</span>  <span class="o">+</span> <span class="n">dydt</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>        <span class="c">!Sum of abundance flow.</span>
        <span class="n">summdy</span> <span class="o">=</span> <span class="n">summdy</span> <span class="o">+</span> <span class="n">dm</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">*</span><span class="n">dydt</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="c">!Sum of (mass excess)*(abundance flow).</span>
        <span class="n">sumzdy</span> <span class="o">=</span> <span class="n">sumzdy</span> <span class="o">+</span> <span class="n">zm</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">*</span><span class="n">dydt</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>  <span class="c">!Sum of (charge)*(abundance flow).</span>
      <span class="k">END DO</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-164" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-164'>#</a>
          </div>
          <p>..........CHANGES IN TEMPERATURE, hv, AND CHEMICAL POTENTIAL.</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="n">dphdt9</span> <span class="o">=</span> <span class="n">thm</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="mf">1.070e-4</span><span class="o">*</span><span class="n">hv</span><span class="o">*</span><span class="n">sumzy</span><span class="o">/</span><span class="n">t9</span> <span class="o">-</span> <span class="n">thm</span><span class="p">(</span><span class="mi">11</span><span class="p">))</span>
      <span class="n">dphdln</span> <span class="o">=</span> <span class="o">-</span><span class="n">thm</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span><span class="o">*</span><span class="mf">3.568e-5</span><span class="o">*</span><span class="n">hv</span><span class="o">*</span><span class="n">sumzy</span>
      <span class="n">dphdzy</span> <span class="o">=</span> <span class="n">thm</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span><span class="o">*</span><span class="mf">3.568e-5</span><span class="o">*</span><span class="n">hv</span>
      <span class="n">bar</span>    <span class="o">=</span> <span class="mf">9.25e-5</span><span class="o">*</span><span class="n">t9</span><span class="o">*</span><span class="n">sumy</span> <span class="o">+</span> <span class="mf">1.388e-4</span><span class="o">*</span><span class="n">t9</span><span class="o">*</span><span class="n">sumdy</span><span class="o">/</span><span class="p">(</span><span class="mf">3.</span><span class="o">*</span><span class="n">hubcst</span><span class="p">)</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-165" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-165'>#</a>
          </div>
          
        </div>
        <div class='code'>
          <div class="highlight"><pre>     <span class="err">|</span>         <span class="o">+</span> <span class="n">summdy</span><span class="o">/</span><span class="p">(</span><span class="mf">3.</span><span class="o">*</span><span class="n">hubcst</span><span class="p">)</span>
      <span class="n">dlndt9</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="n">thm</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">thm</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="o">+</span> <span class="n">thm</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">*</span><span class="n">dphdt9</span> <span class="o">+</span> <span class="n">thm</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span><span class="o">*</span><span class="mf">1.388e-4</span><span class="o">*</span>
     <span class="err">|</span>         <span class="n">sumy</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">thm</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">thm</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">thm</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">+</span> <span class="n">thm</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span> <span class="o">+</span> <span class="n">thm</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span><span class="o">*</span><span class="n">bar</span>
     <span class="err">|</span>         <span class="o">+</span> <span class="n">thm</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">dphdln</span> <span class="o">+</span> <span class="n">dphdzy</span><span class="o">*</span><span class="n">sumzdy</span><span class="o">/</span><span class="p">(</span><span class="mf">3.</span><span class="o">*</span><span class="n">hubcst</span><span class="p">)))</span>   <span class="c">!(Ref 1).</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-166" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-166'>#</a>
          </div>
          <p>c Julien modified, 29-02-08 - 05-03-08</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-167" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-167'>#</a>
          </div>
          <p>was:</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-168" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-168'>#</a>
          </div>
          <p>dt9    = (3.*hubcst)/dlndt9</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-169" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-169'>#</a>
          </div>
          <p>we use:</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="k">CALL </span><span class="n">log_interp_values</span><span class="p">(</span><span class="n">dt9_interp</span><span class="p">,</span> <span class="n">t9</span><span class="p">,</span> <span class="n">t9s</span><span class="p">,</span> <span class="n">dt9s</span><span class="p">,</span> <span class="p">.</span><span class="n">true</span><span class="p">.,</span> <span class="n">nlines</span><span class="p">)</span>
      <span class="n">dt9</span> <span class="o">=</span> <span class="n">dt9_interp</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-170" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-170'>#</a>
          </div>
          <p>Julien end mod 05-03-08</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="n">dlt9dt</span> <span class="o">=</span> <span class="n">dt9</span><span class="o">/</span><span class="n">t9</span>
      <span class="n">dhv</span>    <span class="o">=</span> <span class="o">-</span><span class="n">hv</span><span class="o">*</span><span class="p">((</span><span class="mf">3.</span><span class="o">*</span><span class="n">hubcst</span><span class="p">)</span> <span class="o">+</span> <span class="mf">3.</span><span class="o">*</span><span class="n">dlt9dt</span><span class="p">)</span>                    <span class="c">!(Ref 2).</span>
      <span class="n">dphie</span>  <span class="o">=</span> <span class="n">dphdt9</span><span class="o">*</span><span class="n">dt9</span> <span class="o">+</span> <span class="n">dphdln</span><span class="o">*</span><span class="p">(</span><span class="mf">3.</span><span class="o">*</span><span class="n">hubcst</span><span class="p">)</span> <span class="o">+</span> <span class="n">dphdzy</span><span class="o">*</span><span class="n">sumzdy</span>  <span class="c">!(Ref 3).</span>

      <span class="k">RETURN</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-171" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-171'>#</a>
          </div>
          <p>C-------REFERENCES--------------------------------------</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-172" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-172'>#</a>
          </div>
          <p>1)  Kawano, L., 1992, Fermilab preprint FERMILAB-PUB-92/04-A,</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-173" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-173'>#</a>
          </div>
          <p>Kellogg Radiation Lab preprint OAP-714,</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-174" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-174'>#</a>
          </div>
          <p>equation D.35.</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-175" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-175'>#</a>
          </div>
          <p>2)  Kawano, L. 1992, preprint, equation D.19.</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-176" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-176'>#</a>
          </div>
          <p>3)  Kawano, L. 1992, preprint, equation D.20.</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="k">END</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-177" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-177'>#</a>
          </div>
          <p>C===============IDENTIFICATION DIVISION====================</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="k">SUBROUTINE </span><span class="n">accum</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-178" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-178'>#</a>
          </div>
          <p>C-------LINKAGES.</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-179" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-179'>#</a>
          </div>
          <p>CALLED BY - [subroutine] driver</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-180" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-180'>#</a>
          </div>
          <p>CALLS     - none</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-181" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-181'>#</a>
          </div>
          <p>C-------REMARKS.</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-182" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-182'>#</a>
          </div>
          <p>Output accumulator.</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="k">USE </span><span class="n">commons</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-183" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-183'>#</a>
          </div>
          <p>C-------COMMON AREAS.</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="k">COMMON</span> <span class="o">/</span><span class="n">evolp1</span><span class="o">/</span> <span class="n">t9</span><span class="p">,</span><span class="n">hv</span><span class="p">,</span><span class="n">phie</span><span class="p">,</span><span class="n">y</span>                   <span class="c">!Evolution parameters.</span>
      <span class="k">COMMON</span> <span class="o">/</span><span class="n">compr</span><span class="o">/</span>  <span class="n">cy</span><span class="p">,</span><span class="n">ct</span><span class="p">,</span><span class="n">t9i</span><span class="p">,</span><span class="n">t9f</span><span class="p">,</span><span class="n">ytmin</span><span class="p">,</span><span class="n">inc</span>        <span class="c">!Computation parameters.</span>
      <span class="k">COMMON</span> <span class="o">/</span><span class="nb">time</span><span class="o">/</span>   <span class="n">t</span><span class="p">,</span><span class="n">dt</span><span class="p">,</span><span class="n">dlt9dt</span>                    <span class="c">!Time variables.</span>
      <span class="k">COMMON</span> <span class="o">/</span><span class="n">xtherm</span><span class="o">/</span>  <span class="n">thm</span><span class="p">,</span><span class="n">hubcst</span>                     <span class="c">!Dynamic variables.</span>
      <span class="k">COMMON</span> <span class="o">/</span><span class="n">nucdat</span><span class="o">/</span> <span class="n">am</span><span class="p">,</span><span class="n">zm</span><span class="p">(</span><span class="n">nnuc</span><span class="p">),</span><span class="n">dm</span><span class="p">(</span><span class="n">nnuc</span><span class="p">)</span>           <span class="c">!Nuclide data.</span>
      <span class="k">COMMON</span> <span class="o">/</span><span class="n">flags</span><span class="o">/</span>  <span class="nb">ltime</span><span class="p">,</span><span class="k">is</span><span class="p">,</span><span class="n">ip</span><span class="p">,</span><span class="n">it</span><span class="p">,</span><span class="n">mbad</span>            <span class="c">!Flags,counters.</span>
      <span class="k">COMMON</span> <span class="o">/</span><span class="n">outdat</span><span class="o">/</span> <span class="n">xout</span><span class="p">,</span><span class="n">thmout</span><span class="p">,</span><span class="n">t9out</span><span class="p">,</span><span class="n">tout</span><span class="p">,</span><span class="n">dtout</span><span class="p">,</span>  <span class="c">!Output data.</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-184" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-184'>#</a>
          </div>
          
        </div>
        <div class='code'>
          <div class="highlight"><pre>     <span class="err">|</span>                <span class="n">etaout</span><span class="p">,</span><span class="n">hubout</span>
      <span class="k">COMMON</span> <span class="o">/</span><span class="n">runopt</span><span class="o">/</span> <span class="n">irun</span><span class="p">,</span><span class="n">isize</span><span class="p">,</span><span class="n">jsize</span>               <span class="c">!Run options.</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-185" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-185'>#</a>
          </div>
          <p>C=================DECLARATION DIVISION=====================</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-186" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-186'>#</a>
          </div>
          <p>C-------EVOLUTION PARAMETERS.</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="kt">DOUBLE PRECISION    </span><span class="n">t9</span>                   <span class="c">!Temperature (in units of 10**9 K).</span>
      <span class="kt">DOUBLE PRECISION    </span><span class="n">hv</span>                   <span class="c">!Defined by hv = M(atomic)n(baryon)/t9**3.</span>
      <span class="kt">DOUBLE PRECISION    </span><span class="n">phie</span>                 <span class="c">!Chemical potential for electron.</span>
      <span class="kt">DOUBLE PRECISION    </span><span class="n">y</span><span class="p">(</span><span class="n">nnuc</span><span class="p">)</span>              <span class="c">!Relative number abundances.</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-187" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-187'>#</a>
          </div>
          <p>C-------COMPUTATION PARAMETERS.</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="kt">INTEGER </span><span class="n">inc</span>                  <span class="c">!Accumulation increment.</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-188" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-188'>#</a>
          </div>
          <p>C-------TIME PARAMETERS.</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="kt">DOUBLE PRECISION    </span><span class="n">t</span>                    <span class="c">!Time.</span>
      <span class="kt">DOUBLE PRECISION    </span><span class="n">dt</span>                   <span class="c">!Time step.</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-189" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-189'>#</a>
          </div>
          <p>C-------DYNAMIC VARIABLES.</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="kt">DOUBLE PRECISION    </span><span class="n">thm</span><span class="p">(</span><span class="mi">14</span><span class="p">)</span>              <span class="c">!Thermodynamic variables.</span>
      <span class="kt">DOUBLE PRECISION    </span><span class="n">hubcst</span>               <span class="c">!Expansion rate.</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-190" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-190'>#</a>
          </div>
          <p>C-------NUCLIDE DATA.</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="kt">DOUBLE PRECISION    </span><span class="n">am</span><span class="p">(</span><span class="n">nnuc</span><span class="p">)</span>             <span class="c">!Atomic number of nuclide.</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-191" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-191'>#</a>
          </div>
          <p>C-------COUNTERS AND FLAGS.</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="kt">INTEGER </span><span class="nb">ltime</span>                <span class="c">!Indicates if output buffer printed.</span>
      <span class="kt">INTEGER </span><span class="n">it</span>                   <span class="c">!# times accumulated in output buffer.</span>
      <span class="kt">INTEGER </span><span class="n">ip</span>                   <span class="c">!# time steps after outputting a line.</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-192" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-192'>#</a>
          </div>
          <p>C-------OUTPUT ARRAYS.</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="kt">DOUBLE PRECISION    </span><span class="n">xout</span><span class="p">(</span><span class="n">itmax</span><span class="p">,</span><span class="n">nnuc</span><span class="p">)</span>     <span class="c">!Nuclide mass fractions.</span>
      <span class="kt">DOUBLE PRECISION    </span><span class="n">thmout</span><span class="p">(</span><span class="n">itmax</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span>      <span class="c">!Thermodynamic variables.</span>
      <span class="kt">DOUBLE PRECISION    </span><span class="n">t9out</span><span class="p">(</span><span class="n">itmax</span><span class="p">)</span>         <span class="c">!Temperature (in units of 10**9 K).</span>
      <span class="kt">DOUBLE PRECISION    </span><span class="n">tout</span><span class="p">(</span><span class="n">itmax</span><span class="p">)</span>          <span class="c">!Time.</span>
      <span class="kt">DOUBLE PRECISION    </span><span class="n">dtout</span><span class="p">(</span><span class="n">itmax</span><span class="p">)</span>         <span class="c">!Time step.</span>
      <span class="kt">DOUBLE PRECISION    </span><span class="n">etaout</span><span class="p">(</span><span class="n">itmax</span><span class="p">)</span>        <span class="c">!Baryon-to-photon ratio.</span>
      <span class="kt">DOUBLE PRECISION    </span><span class="n">hubout</span><span class="p">(</span><span class="n">itmax</span><span class="p">)</span>        <span class="c">!Expansion rate.</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-193" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-193'>#</a>
          </div>
          <p>C-------RUN OPTION.</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="kt">INTEGER </span><span class="n">isize</span>                <span class="c">!Number of nuclides in computation.</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-194" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-194'>#</a>
          </div>
          <p>C==================PROCEDURE DIVISION======================</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="n">it</span> <span class="o">=</span> <span class="n">it</span> <span class="o">+</span> <span class="mi">1</span>                  <span class="c">!Set up accumulation counter.</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-195" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-195'>#</a>
          </div>
          <p>C10-----SET UP OUTPUT VARIABLES-------------------------------</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-196" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-196'>#</a>
          </div>
          <p>C..........DIVIDE NUMBER FRACTION BY THAT OF PROTON.</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="k">DO </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">isize</span>
        <span class="n">xout</span><span class="p">(</span><span class="n">it</span><span class="p">,</span><span class="n">i</span><span class="p">)</span> <span class="o">=</span> <span class="n">y</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">/</span><span class="n">y</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
      <span class="k">END DO</span>
<span class="k">      </span><span class="n">xout</span><span class="p">(</span><span class="n">it</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">y</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">am</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>      <span class="c">!Exception for proton.</span>
      <span class="n">xout</span><span class="p">(</span><span class="n">it</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span> <span class="o">=</span> <span class="n">y</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">*</span><span class="n">am</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>      <span class="c">!Exception for helium.</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-197" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-197'>#</a>
          </div>
          <p>..........SUM UP ABUNDANCES OF HEAVY NUCLIDES.</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="n">xout</span><span class="p">(</span><span class="n">it</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span> <span class="o">=</span>  <span class="n">xout</span><span class="p">(</span><span class="n">it</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span><span class="o">+</span><span class="n">xout</span><span class="p">(</span><span class="n">it</span><span class="p">,</span><span class="mi">11</span><span class="p">)</span><span class="o">+</span><span class="n">xout</span><span class="p">(</span><span class="n">it</span><span class="p">,</span><span class="mi">12</span><span class="p">)</span><span class="o">+</span><span class="n">xout</span><span class="p">(</span><span class="n">it</span><span class="p">,</span><span class="mi">13</span><span class="p">)</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-198" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-198'>#</a>
          </div>
          
        </div>
        <div class='code'>
          <div class="highlight"><pre>     <span class="err">|</span>              <span class="o">+</span><span class="n">xout</span><span class="p">(</span><span class="n">it</span><span class="p">,</span><span class="mi">14</span><span class="p">)</span><span class="o">+</span><span class="n">xout</span><span class="p">(</span><span class="n">it</span><span class="p">,</span><span class="mi">15</span><span class="p">)</span><span class="o">+</span><span class="n">xout</span><span class="p">(</span><span class="n">it</span><span class="p">,</span><span class="mi">16</span><span class="p">)</span><span class="o">+</span><span class="n">xout</span><span class="p">(</span><span class="n">it</span><span class="p">,</span><span class="mi">17</span><span class="p">)</span>
     <span class="err">|</span>              <span class="o">+</span><span class="n">xout</span><span class="p">(</span><span class="n">it</span><span class="p">,</span><span class="mi">18</span><span class="p">)</span><span class="o">+</span><span class="n">xout</span><span class="p">(</span><span class="n">it</span><span class="p">,</span><span class="mi">19</span><span class="p">)</span><span class="o">+</span><span class="n">xout</span><span class="p">(</span><span class="n">it</span><span class="p">,</span><span class="mi">20</span><span class="p">)</span><span class="o">+</span><span class="n">xout</span><span class="p">(</span><span class="n">it</span><span class="p">,</span><span class="mi">21</span><span class="p">)</span>
     <span class="err">|</span>              <span class="o">+</span><span class="n">xout</span><span class="p">(</span><span class="n">it</span><span class="p">,</span><span class="mi">22</span><span class="p">)</span><span class="o">+</span><span class="n">xout</span><span class="p">(</span><span class="n">it</span><span class="p">,</span><span class="mi">23</span><span class="p">)</span><span class="o">+</span><span class="n">xout</span><span class="p">(</span><span class="n">it</span><span class="p">,</span><span class="mi">24</span><span class="p">)</span><span class="o">+</span><span class="n">xout</span><span class="p">(</span><span class="n">it</span><span class="p">,</span><span class="mi">25</span><span class="p">)</span>
     <span class="err">|</span>              <span class="o">+</span><span class="n">xout</span><span class="p">(</span><span class="n">it</span><span class="p">,</span><span class="mi">26</span><span class="p">)</span>   <span class="c">!Li8 to O16.</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-199" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-199'>#</a>
          </div>
          <p>..........RELABEL TEMPERATURE, TIME, THERMODYNAMIC VARIABLES, ETC.</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="n">t9out</span><span class="p">(</span><span class="n">it</span><span class="p">)</span>    <span class="o">=</span> <span class="n">t9</span>            <span class="c">!Temperature.</span>
      <span class="n">tout</span><span class="p">(</span><span class="n">it</span><span class="p">)</span>     <span class="o">=</span> <span class="n">t</span>             <span class="c">!Time.</span>
      <span class="n">thmout</span><span class="p">(</span><span class="n">it</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">thm</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>        <span class="c">!rho photon.</span>
      <span class="n">thmout</span><span class="p">(</span><span class="n">it</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="n">thm</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>        <span class="c">!rho electron.</span>
      <span class="n">thmout</span><span class="p">(</span><span class="n">it</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="n">thm</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>        <span class="c">!rho neutrino.</span>
      <span class="n">thmout</span><span class="p">(</span><span class="n">it</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span> <span class="o">=</span> <span class="n">thm</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span>        <span class="c">!rho baryon.</span>
      <span class="n">thmout</span><span class="p">(</span><span class="n">it</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span> <span class="o">=</span> <span class="n">phie</span>          <span class="c">!Chemical potential.</span>
      <span class="n">thmout</span><span class="p">(</span><span class="n">it</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span> <span class="o">=</span> <span class="n">thm</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>       <span class="c">!rho total.</span>
      <span class="n">dtout</span><span class="p">(</span><span class="n">it</span><span class="p">)</span>    <span class="o">=</span> <span class="n">dt</span>            <span class="c">!Time step.</span>
      <span class="n">etaout</span><span class="p">(</span><span class="n">it</span><span class="p">)</span>   <span class="o">=</span> <span class="n">hv</span><span class="o">/</span><span class="p">(</span><span class="mf">3.3683e+4</span><span class="p">)</span><span class="c">!Baryon to photon ratio.</span>
      <span class="n">hubout</span><span class="p">(</span><span class="n">it</span><span class="p">)</span>   <span class="o">=</span> <span class="n">hubcst</span>        <span class="c">!Expansion rate.</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-200" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-200'>#</a>
          </div>
          <p>C20-----INDICATE TERMINATION OF ACCUMULATION IF APPROPRIATE------------</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="k">IF</span> <span class="p">((</span><span class="n">it</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="n">itmax</span><span class="p">).</span><span class="nb">or</span><span class="p">.(</span><span class="n">ip</span><span class="p">.</span><span class="n">lt</span><span class="p">.</span><span class="n">inc</span><span class="p">))</span> <span class="nb">ltime</span> <span class="o">=</span> <span class="mi">1</span>
      <span class="k">RETURN</span>

<span class="k">      END</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-201" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-201'>#</a>
          </div>
          <p>C===============IDENTIFICATION DIVISION====================</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="k">SUBROUTINE </span><span class="n">therm</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-202" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-202'>#</a>
          </div>
          <p>C-------LINKAGES.</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-203" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-203'>#</a>
          </div>
          <p>CALLED BY - [subroutine] derivs</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-204" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-204'>#</a>
          </div>
          <p>CALLS     - [subroutine] bessel, nudens</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-205" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-205'>#</a>
          </div>
          <ul>
<li>[function] ex</li>
</ul>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-206" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-206'>#</a>
          </div>
          <p>C-------REMARKS.</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-207" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-207'>#</a>
          </div>
          <p>Computes various temperature dependent thermodynamic quantities.</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="k">USE </span><span class="n">commons</span>
      <span class="k">USE </span><span class="n">sterile</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-208" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-208'>#</a>
          </div>
          <p>C-------COMMON AREAS.</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="k">COMMON</span> <span class="o">/</span><span class="n">evolp1</span><span class="o">/</span> <span class="n">t9</span><span class="p">,</span><span class="n">hv</span><span class="p">,</span><span class="n">phie</span><span class="p">,</span><span class="n">y</span><span class="p">(</span><span class="n">nnuc</span><span class="p">)</span>             <span class="c">!Evolution parameters.</span>
      <span class="k">COMMON</span> <span class="o">/</span><span class="n">compr</span><span class="o">/</span>  <span class="n">cy</span><span class="p">,</span><span class="n">ct</span><span class="p">,</span><span class="n">t9i</span><span class="p">,</span><span class="n">t9f</span><span class="p">,</span><span class="n">ytmin</span><span class="p">,</span><span class="n">inc</span>        <span class="c">!Computation parameters.</span>
      <span class="k">COMMON</span> <span class="o">/</span><span class="n">modpr</span><span class="o">/</span>  <span class="n">g</span><span class="p">,</span><span class="n">tau</span><span class="p">,</span><span class="n">xnu</span><span class="p">,</span><span class="n">c</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="n">cosmo</span><span class="p">,</span><span class="n">xi</span>        <span class="c">!Model parameters.</span>
      <span class="k">COMMON</span> <span class="o">/</span><span class="n">xtherm</span><span class="o">/</span>  <span class="n">thm</span><span class="p">,</span><span class="n">hubcst</span>                     <span class="c">!Dynamic variables.</span>
      <span class="k">COMMON</span> <span class="o">/</span><span class="n">endens</span><span class="o">/</span> <span class="n">rhone0</span><span class="p">,</span><span class="n">rhob0</span><span class="p">,</span><span class="n">rhob</span><span class="p">,</span><span class="n">rnb</span>          <span class="c">!Energy densities.</span>
      <span class="k">COMMON</span> <span class="o">/</span><span class="n">xbessel</span><span class="o">/</span> <span class="n">bl1</span><span class="p">,</span><span class="n">bl2</span><span class="p">,</span><span class="n">bl3</span><span class="p">,</span><span class="n">bl4</span><span class="p">,</span><span class="n">bl5</span><span class="p">,</span>           <span class="c">!Eval of function bl(z).</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-209" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-209'>#</a>
          </div>
          
        </div>
        <div class='code'>
          <div class="highlight"><pre>     <span class="err">|</span>                <span class="n">bm1</span><span class="p">,</span><span class="n">bm2</span><span class="p">,</span><span class="n">bm3</span><span class="p">,</span><span class="n">bm4</span><span class="p">,</span><span class="n">bm5</span><span class="p">,</span>           <span class="c">!Eval of function bm(z).</span>
     <span class="err">|</span>                <span class="n">bn1</span><span class="p">,</span><span class="n">bn2</span><span class="p">,</span><span class="n">bn3</span><span class="p">,</span><span class="n">bn4</span><span class="p">,</span><span class="n">bn5</span>            <span class="c">!Eval of function bn(z).</span>
      <span class="k">COMMON</span> <span class="o">/</span><span class="n">nupar</span><span class="o">/</span>  <span class="n">t9mev</span><span class="p">,</span><span class="n">tnmev</span><span class="p">,</span><span class="n">tnu</span><span class="p">,</span><span class="n">cnorm</span><span class="p">,</span><span class="n">nu</span><span class="p">,</span><span class="n">rhonu</span> <span class="c">!Integration parameters.</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-210" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-210'>#</a>
          </div>
          <p>C=================DECLARATION DIVISION=====================</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-211" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-211'>#</a>
          </div>
          <p>C-------EVOLUTION PARAMETERS.</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="kt">DOUBLE PRECISION    </span><span class="n">t9</span>                   <span class="c">!Temperature (in units of 10**9 K).</span>
      <span class="kt">DOUBLE PRECISION    </span><span class="n">phie</span>                 <span class="c">!Chemical potential for electron.</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-212" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-212'>#</a>
          </div>
          <p>C-------COMPUTATION PARAMETERS.</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="kt">DOUBLE PRECISION    </span><span class="n">t9i</span>                  <span class="c">!Initial temperature (in 10**9 K).</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-213" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-213'>#</a>
          </div>
          <p>C-------EARLY UNIVERSE MODEL PARAMETERS.</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="kt">DOUBLE PRECISION    </span><span class="n">xnu</span>                  <span class="c">!Number of neutrino species.</span>
      <span class="kt">DOUBLE PRECISION    </span><span class="n">xi</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>                <span class="c">!Neutrino degeneracy parameters.</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-214" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-214'>#</a>
          </div>
          <p>C-------DYNAMIC VARIABLES.</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="kt">DOUBLE PRECISION    </span><span class="n">thm</span><span class="p">(</span><span class="mi">14</span><span class="p">)</span>              <span class="c">!Thermodynamic variables.</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-215" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-215'>#</a>
          </div>
          <p>C-------ENERGY DENSITIES.</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="kt">DOUBLE PRECISION    </span><span class="n">rhone0</span>               <span class="c">!Initial electron neutrino mass density.</span>
      <span class="kt">DOUBLE PRECISION    </span><span class="n">rhob0</span>                <span class="c">!Initial baryon mass density.</span>
      <span class="kt">DOUBLE PRECISION    </span><span class="n">rnb</span>                  <span class="c">!Baryon mass density (ratio to init value).</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-216" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-216'>#</a>
          </div>
          <p>C-------EVALUATION OF FUNCTIONS bl,bm,bn.</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="kt">DOUBLE PRECISION    </span><span class="n">bl1</span><span class="p">,</span><span class="n">bl2</span><span class="p">,</span><span class="n">bl3</span><span class="p">,</span><span class="n">bl4</span><span class="p">,</span><span class="n">bl5</span>  <span class="c">!Evaluation of function bl(z).</span>
      <span class="kt">DOUBLE PRECISION    </span><span class="n">bm1</span><span class="p">,</span><span class="n">bm2</span><span class="p">,</span><span class="n">bm3</span><span class="p">,</span><span class="n">bm4</span><span class="p">,</span><span class="n">bm5</span>  <span class="c">!Evaluation of function bm(z).</span>
      <span class="kt">DOUBLE PRECISION    </span><span class="n">bn1</span><span class="p">,</span><span class="n">bn2</span><span class="p">,</span><span class="n">bn3</span><span class="p">,</span><span class="n">bn4</span><span class="p">,</span><span class="n">bn5</span>  <span class="c">!Evaluation of function bn(z).</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-217" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-217'>#</a>
          </div>
          <p>C-------NEUTRINO PARAMETERS.</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="kt">DOUBLE PRECISION    </span><span class="n">tnu</span>                  <span class="c">!Neutrino temperature.</span>
      <span class="kt">DOUBLE PRECISION    </span><span class="n">rhonu</span>                <span class="c">!Neutrino energy density.</span>
      <span class="kt">INTEGER </span><span class="n">nu</span>                   <span class="c">!Type of neutrino.</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-218" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-218'>#</a>
          </div>
          <p>C-------LOCAL VARIABLE.</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="kt">DOUBLE PRECISION    </span><span class="n">z</span>                    <span class="c">!Defined by z = m(electron)*c**2/k*t9.</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-219" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-219'>#</a>
          </div>
          <p>Julien modified, 28-02-08</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="kt">DOUBLE PRECISION </span><span class="n">rho</span><span class="p">,</span><span class="n">rate</span>             <span class="c">!Total energy density at given time, and</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-220" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-220'>#</a>
          </div>
          
        </div>
        <div class='code'>
          <div class="highlight"><pre>     <span class="err">|</span>                          <span class="c">! rate</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-221" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-221'>#</a>
          </div>
          <p>Julien end mod 28-02-08</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-222" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-222'>#</a>
          </div>
          <p>C==================PROCEDURE DIVISION======================</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-223" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-223'>#</a>
          </div>
          <p>C10-----COMPUTE FACTORS------------------------------------</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="n">z</span> <span class="o">=</span> <span class="mf">5.930</span><span class="o">/</span><span class="n">t9</span>                 <span class="c">!z = m(electron)c**2/k(t9).</span>
      <span class="n">tnu</span> <span class="o">=</span> <span class="p">((</span><span class="n">rnb</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mf">1.</span><span class="o">/</span><span class="mf">3.</span><span class="p">))</span><span class="o">*</span><span class="n">t9i</span>   <span class="c">!Neutrino temperature.</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-224" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-224'>#</a>
          </div>
          <p>..........FACTORS OF z.</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="n">z1</span> <span class="o">=</span> <span class="n">z</span>
      <span class="n">z2</span> <span class="o">=</span> <span class="n">z</span><span class="o">*</span><span class="n">z</span>
      <span class="n">z3</span> <span class="o">=</span> <span class="n">z2</span><span class="o">*</span><span class="n">z</span>
      <span class="n">z4</span> <span class="o">=</span> <span class="n">z3</span><span class="o">*</span><span class="n">z</span>
      <span class="n">z5</span> <span class="o">=</span> <span class="n">z4</span><span class="o">*</span><span class="n">z</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-225" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-225'>#</a>
          </div>
          <p>..........TRIGNOMETRIC FUNCTION VALUES.</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="k">IF</span> <span class="p">(</span><span class="n">phie</span><span class="p">.</span><span class="n">le</span><span class="p">.</span><span class="mi">1</span><span class="mf">7.</span><span class="p">)</span> <span class="k">THEN</span>        <span class="c">!No chance of overflow.</span>
        <span class="n">cosh1</span> <span class="o">=</span> <span class="nb">cosh</span><span class="p">(</span><span class="n">phie</span><span class="p">)</span>
        <span class="n">cosh2</span> <span class="o">=</span> <span class="nb">cosh</span><span class="p">(</span><span class="mf">2.</span><span class="o">*</span><span class="n">phie</span><span class="p">)</span>
        <span class="n">cosh3</span> <span class="o">=</span> <span class="nb">cosh</span><span class="p">(</span><span class="mf">3.</span><span class="o">*</span><span class="n">phie</span><span class="p">)</span>
        <span class="n">cosh4</span> <span class="o">=</span> <span class="nb">cosh</span><span class="p">(</span><span class="mf">4.</span><span class="o">*</span><span class="n">phie</span><span class="p">)</span>
        <span class="n">cosh5</span> <span class="o">=</span> <span class="nb">cosh</span><span class="p">(</span><span class="mf">5.</span><span class="o">*</span><span class="n">phie</span><span class="p">)</span>
        <span class="n">sinh1</span> <span class="o">=</span> <span class="nb">sinh</span><span class="p">(</span><span class="n">phie</span><span class="p">)</span>
        <span class="n">sinh2</span> <span class="o">=</span> <span class="nb">sinh</span><span class="p">(</span><span class="mf">2.</span><span class="o">*</span><span class="n">phie</span><span class="p">)</span>
        <span class="n">sinh3</span> <span class="o">=</span> <span class="nb">sinh</span><span class="p">(</span><span class="mf">3.</span><span class="o">*</span><span class="n">phie</span><span class="p">)</span>
        <span class="n">sinh4</span> <span class="o">=</span> <span class="nb">sinh</span><span class="p">(</span><span class="mf">4.</span><span class="o">*</span><span class="n">phie</span><span class="p">)</span>
        <span class="n">sinh5</span> <span class="o">=</span> <span class="nb">sinh</span><span class="p">(</span><span class="mf">5.</span><span class="o">*</span><span class="n">phie</span><span class="p">)</span>
      <span class="k">ELSE</span>
<span class="k">        </span><span class="n">cosh1</span> <span class="o">=</span> <span class="mf">0.</span>
        <span class="n">cosh2</span> <span class="o">=</span> <span class="mf">0.</span>
        <span class="n">cosh3</span> <span class="o">=</span> <span class="mf">0.</span>
        <span class="n">cosh4</span> <span class="o">=</span> <span class="mf">0.</span>
        <span class="n">cosh5</span> <span class="o">=</span> <span class="mf">0.</span>
        <span class="n">sinh1</span> <span class="o">=</span> <span class="mf">0.</span>
        <span class="n">sinh2</span> <span class="o">=</span> <span class="mf">0.</span>
        <span class="n">sinh3</span> <span class="o">=</span> <span class="mf">0.</span>
        <span class="n">sinh4</span> <span class="o">=</span> <span class="mf">0.</span>
        <span class="n">sinh5</span> <span class="o">=</span> <span class="mf">0.</span>
      <span class="k">END IF</span>
<span class="k">      CALL </span><span class="n">bessel</span><span class="p">(</span><span class="n">z</span><span class="p">)</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-226" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-226'>#</a>
          </div>
          <p>C20-----COMPUTE THERMODYNAMIC VARIABLES--------------------------</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="n">thm</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>  <span class="o">=</span> <span class="mf">8.418</span><span class="o">*</span><span class="n">t9</span><span class="o">*</span><span class="n">t9</span><span class="o">*</span><span class="n">t9</span><span class="o">*</span><span class="n">t9</span>                               <span class="c">!(Ref 1).</span>
      <span class="n">thm</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>  <span class="o">=</span> <span class="mf">4.</span><span class="o">*</span><span class="n">thm</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">t9</span>                                    <span class="c">!(Ref 2).</span>
      <span class="n">thm</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>  <span class="o">=</span> <span class="n">thm</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mf">3.</span>                                       <span class="c">!(Ref 3).</span>
      <span class="n">thm</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>  <span class="o">=</span> <span class="mi">320</span><span class="mf">6.</span><span class="o">*</span><span class="p">(</span><span class="n">bm1</span><span class="o">*</span><span class="n">cosh1</span> <span class="o">-</span> <span class="n">bm2</span><span class="o">*</span><span class="n">cosh2</span> <span class="o">+</span> <span class="n">bm3</span><span class="o">*</span><span class="n">cosh3</span>        <span class="c">!(Ref 4).</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-227" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-227'>#</a>
          </div>
          
        </div>
        <div class='code'>
          <div class="highlight"><pre>     <span class="err">|</span>          <span class="o">-</span> <span class="n">bm4</span><span class="o">*</span><span class="n">cosh4</span> <span class="o">+</span> <span class="n">bm5</span><span class="o">*</span><span class="n">cosh5</span><span class="p">)</span>
      <span class="n">thm</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>  <span class="o">=</span> <span class="mi">320</span><span class="mf">6.</span><span class="o">*</span><span class="p">(</span><span class="n">z</span><span class="o">/</span><span class="n">t9</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">bn1</span><span class="o">*</span><span class="n">cosh1</span> <span class="o">-</span> <span class="mf">2.</span><span class="o">*</span><span class="n">bn2</span><span class="o">*</span><span class="n">cosh2</span>          <span class="c">!(Ref 5).</span>
     <span class="err">|</span>          <span class="o">+</span> <span class="mf">3.</span><span class="o">*</span><span class="n">bn3</span><span class="o">*</span><span class="n">cosh3</span> <span class="o">-</span> <span class="mf">4.</span><span class="o">*</span><span class="n">bn4</span><span class="o">*</span><span class="n">cosh4</span> <span class="o">+</span> <span class="mf">5.</span><span class="o">*</span><span class="n">bn5</span><span class="o">*</span><span class="n">cosh5</span><span class="p">)</span>
      <span class="n">thm</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>  <span class="o">=</span> <span class="mi">320</span><span class="mf">6.</span><span class="o">*</span><span class="p">(</span><span class="n">bm1</span><span class="o">*</span><span class="n">sinh1</span> <span class="o">-</span> <span class="mf">2.</span><span class="o">*</span><span class="n">bm2</span><span class="o">*</span><span class="n">sinh2</span> <span class="o">+</span> <span class="mf">3.</span><span class="o">*</span><span class="n">bm3</span><span class="o">*</span><span class="n">sinh3</span>  <span class="c">!(Ref 6).</span>
     <span class="err">|</span>          <span class="o">-</span> <span class="mf">4.</span><span class="o">*</span><span class="n">bm4</span><span class="o">*</span><span class="n">sinh4</span> <span class="o">+</span> <span class="mf">5.</span><span class="o">*</span><span class="n">bm5</span><span class="o">*</span><span class="n">sinh5</span><span class="p">)</span>
      <span class="n">thm</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>  <span class="o">=</span> <span class="mi">320</span><span class="mf">6.</span><span class="o">*</span><span class="p">(</span><span class="n">bl1</span><span class="o">*</span><span class="n">cosh1</span><span class="o">/</span><span class="n">z</span> <span class="o">-</span> <span class="n">bl2</span><span class="o">*</span><span class="n">cosh2</span><span class="o">/</span><span class="p">(</span><span class="mf">2.</span><span class="o">*</span><span class="n">z</span><span class="p">)</span>           <span class="c">!(Ref 7).</span>
     <span class="err">|</span>          <span class="o">+</span> <span class="n">bl3</span><span class="o">*</span><span class="n">cosh3</span><span class="o">/</span><span class="p">(</span><span class="mf">3.</span><span class="o">*</span><span class="n">z</span><span class="p">)</span> <span class="o">-</span> <span class="n">bl4</span><span class="o">*</span><span class="n">cosh4</span><span class="o">/</span><span class="p">(</span><span class="mf">4.</span><span class="o">*</span><span class="n">z</span><span class="p">)</span>
     <span class="err">|</span>          <span class="o">+</span> <span class="n">bl5</span><span class="o">*</span><span class="n">cosh5</span><span class="o">/</span><span class="p">(</span><span class="mf">5.</span><span class="o">*</span><span class="n">z</span><span class="p">))</span>
      <span class="k">IF</span> <span class="p">((</span><span class="n">xi</span><span class="p">(</span><span class="mi">1</span><span class="p">).</span><span class="n">eq</span><span class="p">.</span><span class="mf">0.</span><span class="p">).</span><span class="nb">and</span><span class="p">.(</span><span class="n">xi</span><span class="p">(</span><span class="mi">2</span><span class="p">).</span><span class="n">eq</span><span class="p">.</span><span class="mf">0.</span><span class="p">).</span><span class="nb">and</span><span class="p">.(</span><span class="n">xi</span><span class="p">(</span><span class="mi">3</span><span class="p">).</span><span class="n">eq</span><span class="p">.</span><span class="mi">0</span><span class="p">))</span> <span class="k">THEN</span>  <span class="c">!Nondegen.</span>
        <span class="n">thm</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span> <span class="o">=</span> <span class="n">xnu</span><span class="o">*</span><span class="n">rhone0</span><span class="o">*</span><span class="p">(</span><span class="n">rnb</span><span class="o">**</span><span class="p">(</span><span class="mf">4.</span><span class="o">/</span><span class="mf">3.</span><span class="p">))</span>                      <span class="c">!(Ref 8).</span>
      <span class="k">ELSE</span>                         <span class="c">!Include effects of neutrino degeneracy.</span>
        <span class="n">thm</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.</span>
        <span class="k">DO </span><span class="n">nu</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">INT</span><span class="p">(</span><span class="n">xnu</span><span class="p">)</span>        <span class="c">!For every neutrino family.</span>
          <span class="k">CALL </span><span class="n">nudens</span>              <span class="c">!Compute neutrino energy density.</span>
          <span class="n">thm</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span> <span class="o">=</span> <span class="n">thm</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="mf">2.79264</span><span class="o">*</span><span class="n">rhonu</span>  <span class="c">!Have 12.79264 from units change.</span>
        <span class="k">END DO</span>
<span class="k">      END IF</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-228" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-228'>#</a>
          </div>
          <p>Julien: 29-02-08: Note that I didn't change the neutrino density,</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-229" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-229'>#</a>
          </div>
          <p>only the total density, so this neutrino density is not totally</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-230" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-230'>#</a>
          </div>
          <p>the correct one in our case but in the code it is needed only</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-231" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-231'>#</a>
          </div>
          <p>for the total density, so it doesn't matter</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="n">thm</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span>  <span class="o">=</span> <span class="n">rhob0</span><span class="o">*</span><span class="n">rnb</span>                                       <span class="c">!(Ref 9).</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-232" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-232'>#</a>
          </div>
          <p>c Julien modified, 28-02-08</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-233" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-233'>#</a>
          </div>
          <p>was:</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-234" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-234'>#</a>
          </div>
          <p>thm(10) = thm(1) + thm(4) + thm(8) + thm(9)               !(Ref 10).</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-235" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-235'>#</a>
          </div>
          <p>we use:</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="k">CALL </span><span class="n">log_interp_values</span><span class="p">(</span><span class="n">rho</span><span class="p">,</span> <span class="n">t9</span><span class="p">,</span> <span class="n">t9s</span><span class="p">,</span> <span class="n">rho_tot</span><span class="p">,</span> <span class="p">.</span><span class="n">true</span><span class="p">.,</span> <span class="n">nlines</span><span class="p">)</span>
      <span class="n">thm</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="o">=</span> <span class="n">rho</span> <span class="o">+</span> <span class="n">thm</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span>                                    <span class="c">!(Ref 10).</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-236" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-236'>#</a>
          </div>
          <p>Julien end mod 28-02-08</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="n">thm</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="n">z</span><span class="o">**</span><span class="mi">3</span><span class="o">/</span><span class="n">t9</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">sinh1</span><span class="o">*</span><span class="p">(</span><span class="mf">3.</span><span class="o">*</span><span class="n">bl1</span><span class="o">-</span><span class="n">z</span><span class="o">*</span><span class="n">bm1</span><span class="p">)</span><span class="o">-</span><span class="n">sinh2</span><span class="o">*</span><span class="p">(</span><span class="mf">3.</span><span class="o">*</span><span class="n">bl2</span>  <span class="c">!(Ref 11).</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-237" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-237'>#</a>
          </div>
          
        </div>
        <div class='code'>
          <div class="highlight"><pre>     <span class="err">|</span>          <span class="o">-</span><span class="mf">2.</span><span class="o">*</span><span class="n">z</span><span class="o">*</span><span class="n">bm2</span><span class="p">)</span> <span class="o">+</span> <span class="n">sinh3</span><span class="o">*</span><span class="p">(</span><span class="mf">3.</span><span class="o">*</span><span class="n">bl3</span><span class="o">-</span><span class="mf">3.</span><span class="o">*</span><span class="n">z</span><span class="o">*</span><span class="n">bm3</span><span class="p">)</span> <span class="o">-</span> <span class="n">sinh4</span>
     <span class="err">|</span>          <span class="o">*</span><span class="p">(</span><span class="mf">3.</span><span class="o">*</span><span class="n">bl4</span><span class="o">-</span><span class="mf">4.</span><span class="o">*</span><span class="n">z</span><span class="o">*</span><span class="n">bm4</span><span class="p">)</span> <span class="o">+</span> <span class="n">sinh5</span><span class="o">*</span><span class="p">(</span><span class="mf">3.</span><span class="o">*</span><span class="n">bl5</span><span class="o">-</span><span class="mf">5.</span><span class="o">*</span><span class="n">z</span><span class="o">*</span><span class="n">bm5</span><span class="p">))</span>
      <span class="n">thm</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span> <span class="o">=</span> <span class="n">z</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="p">(</span><span class="n">cosh1</span><span class="o">*</span><span class="n">bl1</span><span class="o">-</span> <span class="mf">2.</span><span class="o">*</span><span class="n">cosh2</span><span class="o">*</span><span class="n">bl2</span>                   <span class="c">!(Ref 12).</span>
     <span class="err">|</span>          <span class="o">+</span> <span class="mf">3.</span><span class="o">*</span><span class="n">cosh3</span><span class="o">*</span><span class="n">bl3</span> <span class="o">-</span> <span class="mf">4.</span><span class="o">*</span><span class="n">cosh4</span><span class="o">*</span><span class="n">bl4</span> <span class="o">+</span> <span class="mf">5.</span><span class="o">*</span><span class="n">cosh5</span><span class="o">*</span><span class="n">bl5</span><span class="p">)</span>
      <span class="k">IF</span> <span class="p">(</span><span class="n">thm</span><span class="p">(</span><span class="mi">12</span><span class="p">).</span><span class="n">ne</span><span class="p">.</span><span class="mf">0.</span><span class="p">)</span> <span class="n">thm</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span> <span class="o">=</span> <span class="mf">1.</span><span class="o">/</span><span class="n">thm</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-238" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-238'>#</a>
          </div>
          <p>c Julien modified, 28-02-08</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-239" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-239'>#</a>
          </div>
          <p>was:</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-240" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-240'>#</a>
          </div>
          <p>thm(13) = 1.000 + 0.565/z1 - 6.382/z2 + 11.108/z3 !(Ref 13).</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-241" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-241'>#</a>
          </div>
          <p>|          + 36.492/z4 + 27.512/z5</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-242" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-242'>#</a>
          </div>
          <p>thm(14) = (5.252/z1 - 16.229/z2 + 18.059/z3 + 34.181/z4   !(Ref 14).</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-243" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-243'>#</a>
          </div>
          <p>|          + 27.617/z5)<em>ex(-q</em>z)</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-244" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-244'>#</a>
          </div>
          <p>we use:</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="k">CALL </span><span class="n">log_interp_values</span><span class="p">(</span><span class="n">rate</span><span class="p">,</span> <span class="n">t9</span><span class="p">,</span> <span class="n">t9s</span><span class="p">,</span> <span class="n">ratef</span><span class="p">,</span> <span class="p">.</span><span class="n">true</span><span class="p">.,</span> <span class="n">nlines</span><span class="p">)</span>
      <span class="n">thm</span><span class="p">(</span><span class="mi">13</span><span class="p">)</span> <span class="o">=</span> <span class="n">rate</span>                                            <span class="c">!(Ref 13).</span>
      <span class="k">CALL </span><span class="n">log_interp_values</span><span class="p">(</span><span class="n">rate</span><span class="p">,</span> <span class="n">t9</span><span class="p">,</span> <span class="n">t9s</span><span class="p">,</span> <span class="n">rater</span><span class="p">,</span> <span class="p">.</span><span class="n">true</span><span class="p">.,</span> <span class="n">nlines</span><span class="p">)</span>
      <span class="n">thm</span><span class="p">(</span><span class="mi">14</span><span class="p">)</span> <span class="o">=</span> <span class="n">rate</span>                                            <span class="c">!(Ref 14).</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-245" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-245'>#</a>
          </div>
          <p>Julien end mod 28-02-08</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="k">RETURN</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-246" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-246'>#</a>
          </div>
          <p>C-------REFERENCES AND NOTES-------------------------------</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-247" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-247'>#</a>
          </div>
          <p>1)  thm(1)  = rho photon</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-248" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-248'>#</a>
          </div>
          <p>(Wagoner, R.V., Fowler, W.A., and Hoyle, F. 1967, Ap. J. 148,</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-249" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-249'>#</a>
          </div>
          <p>page 43, equation A2.)</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-250" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-250'>#</a>
          </div>
          <p>2)  thm(2)  = d(rho photon)/d(t9)</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-251" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-251'>#</a>
          </div>
          <p>3)  thm(3)  = (p photon)/c**2</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-252" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-252'>#</a>
          </div>
          <p>(Wagoner, R.V., Fowler, W.A., and Hoyle, F. 1967,</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-253" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-253'>#</a>
          </div>
          <p>page 43, equation A3.)</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-254" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-254'>#</a>
          </div>
          <p>4)  thm(4)  = rho electron+positron</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-255" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-255'>#</a>
          </div>
          <p>(Fowler, W.A. and Hoyle, F., 1964, Ap. J. Suppl. No. 91, 9,</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-256" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-256'>#</a>
          </div>
          <p>page 281, equation B44.)</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-257" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-257'>#</a>
          </div>
          <p>5)  thm(5)  = d(rho electron+positron)/d(t9)</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-258" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-258'>#</a>
          </div>
          <p>6)  thm(6)  = d(rho electron+positron)/d(phi e)</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-259" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-259'>#</a>
          </div>
          <p>7)  thm(7)  = (p electron+positron)/c**2</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-260" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-260'>#</a>
          </div>
          <p>(Fowler, W.A. and Hoyle, F., 1964, Ap. J. Suppl. No. 91, 9,</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-261" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-261'>#</a>
          </div>
          <p>page 279, equation B27.)</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-262" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-262'>#</a>
          </div>
          <p>8)  thm(8)  = rho neutrino</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-263" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-263'>#</a>
          </div>
          <p>= # neutrino species x rho electron neutrino (nondegenerate)</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-264" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-264'>#</a>
          </div>
          <p>= rho nu(e) + rho nu(m) + rho nu(t)          (degenerate)</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-265" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-265'>#</a>
          </div>
          <p>9)  thm(9)  = rho baryon</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-266" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-266'>#</a>
          </div>
          <p>10) thm(10) = rho total</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-267" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-267'>#</a>
          </div>
          <p>= rho photon + rho electron+positron + rho neutrino</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-268" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-268'>#</a>
          </div>
          <ul>
<li>rho baryon</li>
</ul>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-269" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-269'>#</a>
          </div>
          <p>11) thm(11) = d     /pi<strong>2(hbar*c)</strong>3(ne- - ne+)<em>z</em>*3\</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-270" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-270'>#</a>
          </div>
          <p>d(t9) \  2  (mc<strong>2)</strong>3                 /</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-271" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-271'>#</a>
          </div>
          <p>12) thm(12) = d        /pi<strong>2(hbar*c)</strong>3(ne- - ne+)<em>z</em>*3\</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-272" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-272'>#</a>
          </div>
          <p>d(phi e) \  2  (mc<strong>2)</strong>3                 /</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-273" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-273'>#</a>
          </div>
          <p>13) thm(13) = rate for n-&gt;p</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-274" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-274'>#</a>
          </div>
          <p>14) thm(14) = rate for p-&gt;n</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="k">END</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-275" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-275'>#</a>
          </div>
          <p>C===============IDENTIFICATION DIVISION====================</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="k">SUBROUTINE </span><span class="n">bessel</span><span class="p">(</span><span class="n">z</span><span class="p">)</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-276" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-276'>#</a>
          </div>
          <p>C-------LINKAGES.</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-277" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-277'>#</a>
          </div>
          <p>CALLED BY - [subroutine] start, therm</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-278" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-278'>#</a>
          </div>
          <p>CALLS     - [subroutine] knux</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-279" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-279'>#</a>
          </div>
          <p>C-------REMARKS.</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-280" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-280'>#</a>
          </div>
          <p>Evaluates functions bl(z), bm(z), and bn(z) using solutions to</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-281" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-281'>#</a>
          </div>
          <p>modified Bessel functions.</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-282" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-282'>#</a>
          </div>
          <p>C-------COMMON AREAS.</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="k">COMMON</span> <span class="o">/</span><span class="n">xbessel</span><span class="o">/</span> <span class="n">bl1</span><span class="p">,</span><span class="n">bl2</span><span class="p">,</span><span class="n">bl3</span><span class="p">,</span><span class="n">bl4</span><span class="p">,</span><span class="n">bl5</span><span class="p">,</span>           <span class="c">!Eval function bl(z).</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-283" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-283'>#</a>
          </div>
          
        </div>
        <div class='code'>
          <div class="highlight"><pre>     <span class="err">|</span>                <span class="n">bm1</span><span class="p">,</span><span class="n">bm2</span><span class="p">,</span><span class="n">bm3</span><span class="p">,</span><span class="n">bm4</span><span class="p">,</span><span class="n">bm5</span><span class="p">,</span>           <span class="c">!Eval function bm(z).</span>
     <span class="err">|</span>                <span class="n">bn1</span><span class="p">,</span><span class="n">bn2</span><span class="p">,</span><span class="n">bn3</span><span class="p">,</span><span class="n">bn4</span><span class="p">,</span><span class="n">bn5</span>            <span class="c">!Eval function bn(z).</span>
      <span class="k">COMMON</span> <span class="o">/</span><span class="n">kays</span><span class="o">/</span>   <span class="n">bk0</span><span class="p">,</span><span class="n">bk1</span><span class="p">,</span><span class="n">bk2</span><span class="p">,</span><span class="n">bk3</span><span class="p">,</span><span class="n">bk4</span>            <span class="c">!Coefficients K.</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-284" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-284'>#</a>
          </div>
          <p>C=================DECLARATION DIVISION=====================</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-285" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-285'>#</a>
          </div>
          <p>C-------EVALUATION OF FUNCTIONS bl,bm,bn.</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="kt">DOUBLE PRECISION   </span><span class="n">bl1</span><span class="p">,</span><span class="n">bl2</span><span class="p">,</span><span class="n">bl3</span><span class="p">,</span><span class="n">bl4</span><span class="p">,</span><span class="n">bl5</span>  <span class="c">!Single variables equivalenced to array blz.</span>
      <span class="kt">DOUBLE PRECISION   </span><span class="n">bm1</span><span class="p">,</span><span class="n">bm2</span><span class="p">,</span><span class="n">bm3</span><span class="p">,</span><span class="n">bm4</span><span class="p">,</span><span class="n">bm5</span>  <span class="c">!Single variables equivalenced to array bmz.</span>
      <span class="kt">DOUBLE PRECISION   </span><span class="n">bn1</span><span class="p">,</span><span class="n">bn2</span><span class="p">,</span><span class="n">bn3</span><span class="p">,</span><span class="n">bn4</span><span class="p">,</span><span class="n">bn5</span>  <span class="c">!Single variables equivalenced to array bnz.</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-286" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-286'>#</a>
          </div>
          <p>C-------EVALUATIION OF MODIFIED BESSEL FUNCTIONS.</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="kt">DOUBLE PRECISION    </span><span class="n">bk0</span><span class="p">,</span><span class="n">bk1</span><span class="p">,</span><span class="n">bk2</span><span class="p">,</span><span class="n">bk3</span><span class="p">,</span><span class="n">bk4</span>  <span class="c">!Values k0(r),k1(r),k2(r),k3(r),k4(r).</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-287" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-287'>#</a>
          </div>
          <p>C-------LOCAL VARIABLES.</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="kt">DOUBLE PRECISION    </span><span class="n">blz</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>               <span class="c">!Array containing values from function bl.</span>
      <span class="kt">DOUBLE PRECISION    </span><span class="n">bmz</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>               <span class="c">!Array containing values from function bm.</span>
      <span class="kt">DOUBLE PRECISION    </span><span class="n">bnz</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>               <span class="c">!Array containing values from function bn.</span>
      <span class="kt">DOUBLE PRECISION    </span><span class="n">z</span>                    <span class="c">!Defined by z = m(electron)*c**2/k*t9.</span>
      <span class="kt">DOUBLE PRECISION    </span><span class="n">r</span>                    <span class="c">!Multiples of z.</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-288" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-288'>#</a>
          </div>
          <p>C-------EQUIVALENCE STATEMENTS.</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="k">EQUIVALENCE</span> <span class="p">(</span><span class="n">blz</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">bl1</span><span class="p">),(</span><span class="n">blz</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">bl2</span><span class="p">),(</span><span class="n">blz</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="n">bl3</span><span class="p">),(</span><span class="n">blz</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span><span class="n">bl4</span><span class="p">),</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-289" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-289'>#</a>
          </div>
          
        </div>
        <div class='code'>
          <div class="highlight"><pre>     <span class="err">|</span>            <span class="p">(</span><span class="n">blz</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span><span class="n">bl5</span><span class="p">)</span>
      <span class="k">EQUIVALENCE</span> <span class="p">(</span><span class="n">bmz</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">bm1</span><span class="p">),(</span><span class="n">bmz</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">bm2</span><span class="p">),(</span><span class="n">bmz</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="n">bm3</span><span class="p">),(</span><span class="n">bmz</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span><span class="n">bm4</span><span class="p">),</span>
     <span class="err">|</span>            <span class="p">(</span><span class="n">bmz</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span><span class="n">bm5</span><span class="p">)</span>
      <span class="k">EQUIVALENCE</span> <span class="p">(</span><span class="n">bnz</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">bn1</span><span class="p">),(</span><span class="n">bnz</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">bn2</span><span class="p">),(</span><span class="n">bnz</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="n">bn3</span><span class="p">),(</span><span class="n">bnz</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span><span class="n">bn4</span><span class="p">),</span>
     <span class="err">|</span>            <span class="p">(</span><span class="n">bnz</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span><span class="n">bn5</span><span class="p">)</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-290" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-290'>#</a>
          </div>
          <p>C==================PROCEDURE DIVISION======================</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-291" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-291'>#</a>
          </div>
          <p>C10-----LOCALLY DEFINED FUNCTIONS-----------------------------</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="n">bl</span><span class="p">(</span><span class="n">z</span><span class="p">)</span> <span class="o">=</span> <span class="n">bk2</span><span class="o">/</span><span class="n">z</span>                <span class="c">!Function bl.</span>
      <span class="n">bm</span><span class="p">(</span><span class="n">z</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.25</span><span class="o">*</span><span class="p">(</span><span class="mf">3.</span><span class="o">*</span><span class="n">bk3</span><span class="o">+</span><span class="n">bk1</span><span class="p">)</span><span class="o">/</span><span class="n">z</span>  <span class="c">!Function bm.</span>
      <span class="n">bn</span><span class="p">(</span><span class="n">z</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="n">bk4</span><span class="o">+</span><span class="n">bk2</span><span class="p">)</span><span class="o">/</span><span class="n">z</span>      <span class="c">!Function bn.</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-292" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-292'>#</a>
          </div>
          <p>C20-----CALCULATE FOR 1 THRU 5 Z------------------------------</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="k">DO </span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span>
        <span class="n">r</span><span class="o">=</span><span class="n">i</span><span class="o">*</span><span class="n">z</span>                      <span class="c">!Multiples of z.</span>
        <span class="k">CALL </span><span class="n">knux</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>               <span class="c">!Get k0(r),k1(r),k2(r),k3(r),k4(r),k(5).</span>
        <span class="n">blz</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">=</span> <span class="n">bl</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>             <span class="c">!Put value from function bl into array.</span>
        <span class="n">bmz</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">=</span> <span class="n">bm</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>             <span class="c">!Put value from function bm into array.</span>
        <span class="n">bnz</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">=</span> <span class="n">bn</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>             <span class="c">!Put value from function bn into array.</span>
      <span class="k">END DO</span>
<span class="k">      RETURN</span>

<span class="k">      END</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-293" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-293'>#</a>
          </div>
          <p>C===============IDENTIFICATION DIVISION====================</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="k">SUBROUTINE </span><span class="n">knux</span><span class="p">(</span><span class="n">z</span><span class="p">)</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-294" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-294'>#</a>
          </div>
          <p>C-------LINKAGES.</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-295" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-295'>#</a>
          </div>
          <p>CALLED BY - [subroutine] bessel</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-296" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-296'>#</a>
          </div>
          <p>CALLS     - [function] exp</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-297" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-297'>#</a>
          </div>
          <p>C-------REMARKS.</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-298" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-298'>#</a>
          </div>
          <p>A subroutine for modified bessel functions of the second kind</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-299" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-299'>#</a>
          </div>
          <p>k-nu(z).</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-300" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-300'>#</a>
          </div>
          <p>C-------COMMON AREAS.</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="k">COMMON</span> <span class="o">/</span><span class="n">kays</span><span class="o">/</span>   <span class="n">bk0</span><span class="p">,</span><span class="n">bk1</span><span class="p">,</span><span class="n">bk2</span><span class="p">,</span><span class="n">bk3</span><span class="p">,</span><span class="n">bk4</span>            <span class="c">!Coefficients K.</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-301" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-301'>#</a>
          </div>
          <p>C==================DECLARATION DIVISION====================</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-302" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-302'>#</a>
          </div>
          <p>C--------MODIFIED BESSEL FUNCTION VALUES.</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="kt">DOUBLE PRECISION    </span><span class="n">bk0</span><span class="p">,</span><span class="n">bk1</span>              <span class="c">!Values k0(z),k1(z)</span>
      <span class="kt">DOUBLE PRECISION    </span><span class="n">bi0</span><span class="p">,</span><span class="n">bi1</span>              <span class="c">!Values i0(z),i1(z).</span>
      <span class="kt">DOUBLE PRECISION    </span><span class="n">bk2</span><span class="p">,</span><span class="n">bk3</span><span class="p">,</span><span class="n">bk4</span>          <span class="c">!Values k2(z),k3(z),k4(z).</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-303" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-303'>#</a>
          </div>
          <p>C--------EXPANSION COEFFICIENTS.</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="kt">DOUBLE PRECISION    </span><span class="n">ci0</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>               <span class="c">!Expansion coefficients for i0 (z.le.2).</span>
      <span class="kt">DOUBLE PRECISION    </span><span class="n">ci1</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>               <span class="c">!Expansion coefficients for i1 (z.le.2).</span>
      <span class="kt">DOUBLE PRECISION    </span><span class="n">ck0</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>               <span class="c">!Expansion coefficients for k0 (z.le.2).</span>
      <span class="kt">DOUBLE PRECISION    </span><span class="n">ck1</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>               <span class="c">!Expansion coefficients for k1 (z.le.2).</span>
      <span class="kt">DOUBLE PRECISION    </span><span class="n">c0</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>                <span class="c">!Expansion coefficients for k0 (z.gt.2).</span>
      <span class="kt">DOUBLE PRECISION    </span><span class="n">c1</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>                <span class="c">!Expansion coefficients for k1 (z.gt.2).</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-304" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-304'>#</a>
          </div>
          <p>C--------VARIABLES TO BE EVALUATED.</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="kt">DOUBLE PRECISION    </span><span class="n">z</span>                    <span class="c">!Input variable.</span>
      <span class="kt">DOUBLE PRECISION    </span><span class="n">y</span>                    <span class="c">!Expansion variable = z/2.</span>
      <span class="kt">DOUBLE PRECISION    </span><span class="n">t</span>                    <span class="c">!Expansion variable = z/3.75.</span>
      <span class="kt">DOUBLE PRECISION    </span><span class="n">coeff</span>                <span class="c">!Logrithmic or exponential coefficient.</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-305" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-305'>#</a>
          </div>
          <p>C=====================DATA DIVISION========================</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-306" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-306'>#</a>
          </div>
          <p>C-------EXPANSION COEFFICIENTS.</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="k">DATA </span><span class="n">ci0</span> <span class="o">/</span> <span class="mf">1.</span><span class="p">,</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-307" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-307'>#</a>
          </div>
          
        </div>
        <div class='code'>
          <div class="highlight"><pre>     <span class="err">|</span>           <span class="mf">3.5156229</span><span class="p">,</span>      <span class="mf">3.0899424</span><span class="p">,</span>      <span class="mf">1.2067492</span><span class="p">,</span>
     <span class="err">|</span>           <span class="mf">0.2659732</span><span class="p">,</span>      <span class="mf">0.0360768</span><span class="p">,</span>      <span class="mf">0.0045813</span><span class="o">/</span>
      <span class="k">DATA </span><span class="n">ci1</span> <span class="o">/</span> <span class="mf">0.5</span><span class="p">,</span>
     <span class="err">|</span>           <span class="mf">0.87890594</span><span class="p">,</span>     <span class="mf">0.51498869</span><span class="p">,</span>     <span class="mf">0.15084934</span><span class="p">,</span>
     <span class="err">|</span>           <span class="mf">0.02658733</span><span class="p">,</span>     <span class="mf">0.00301532</span><span class="p">,</span>     <span class="mf">0.00032411</span><span class="o">/</span>
      <span class="k">DATA </span><span class="n">ck0</span> <span class="o">/-</span><span class="mf">0.57721566</span><span class="p">,</span>
     <span class="err">|</span>           <span class="mf">0.42278420</span><span class="p">,</span>     <span class="mf">0.23069756</span><span class="p">,</span>     <span class="mf">0.03488590</span><span class="p">,</span>
     <span class="err">|</span>           <span class="mf">0.00262698</span><span class="p">,</span>     <span class="mf">0.00010750</span><span class="p">,</span>     <span class="mf">0.00000740</span><span class="o">/</span>
      <span class="k">DATA </span><span class="n">ck1</span> <span class="o">/</span> <span class="mf">1.</span><span class="p">,</span>
     <span class="err">|</span>           <span class="mf">0.15443144</span><span class="p">,</span>    <span class="o">-</span><span class="mf">0.67278579</span><span class="p">,</span>    <span class="o">-</span><span class="mf">0.18156897</span><span class="p">,</span>
     <span class="err">|</span>          <span class="o">-</span><span class="mf">0.01919402</span><span class="p">,</span>    <span class="o">-</span><span class="mf">0.00110404</span><span class="p">,</span>    <span class="o">-</span><span class="mf">0.00004686</span><span class="o">/</span>
      <span class="k">DATA </span><span class="n">c0</span>  <span class="o">/</span> <span class="mf">1.25331414</span><span class="p">,</span>
     <span class="err">|</span>          <span class="o">-</span><span class="mf">0.07832358</span><span class="p">,</span>     <span class="mf">0.02189568</span><span class="p">,</span>    <span class="o">-</span><span class="mf">0.01062446</span><span class="p">,</span>
     <span class="err">|</span>           <span class="mf">0.00587872</span><span class="p">,</span>    <span class="o">-</span><span class="mf">0.00251540</span><span class="p">,</span>     <span class="mf">0.00053208</span><span class="o">/</span>
      <span class="k">DATA </span><span class="n">c1</span>  <span class="o">/</span> <span class="mf">1.25331414</span><span class="p">,</span>
     <span class="err">|</span>           <span class="mf">0.23498619</span><span class="p">,</span>    <span class="o">-</span><span class="mf">0.03655620</span><span class="p">,</span>     <span class="mf">0.01504268</span><span class="p">,</span>
     <span class="err">|</span>          <span class="o">-</span><span class="mf">0.00780353</span><span class="p">,</span>     <span class="mf">0.00325614</span><span class="p">,</span>    <span class="o">-</span><span class="mf">0.00068245</span><span class="o">/</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-308" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-308'>#</a>
          </div>
          <p>C==================PROCEDURE DIVISION======================</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-309" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-309'>#</a>
          </div>
          <p>C10-----COMPUTE K0 AND K1----------------------------------</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="k">IF</span> <span class="p">(</span><span class="n">z</span><span class="p">.</span><span class="n">le</span><span class="p">.</span><span class="mf">2.</span><span class="p">)</span> <span class="k">THEN</span>            <span class="c">!(Ref. 1).</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-310" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-310'>#</a>
          </div>
          <p>..........COMPUTE FACTORS.</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>        <span class="n">t</span> <span class="o">=</span> <span class="p">(</span><span class="n">z</span><span class="o">/</span><span class="mf">3.75</span><span class="p">)</span>
        <span class="n">y</span> <span class="o">=</span> <span class="p">(</span><span class="n">z</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">coeff</span> <span class="o">=</span> <span class="nb">alog</span><span class="p">(</span><span class="n">y</span><span class="p">)</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-311" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-311'>#</a>
          </div>
          <p>..........VALUES FOR i0(z) and i1(z).</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>        <span class="n">bi0</span> <span class="o">=</span> <span class="n">ci0</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">bi1</span> <span class="o">=</span> <span class="n">ci1</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">bk0</span> <span class="o">=</span> <span class="n">ck0</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">bk1</span> <span class="o">=</span> <span class="n">ck1</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">DO </span><span class="n">i</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span><span class="mi">7</span>
          <span class="n">bi0</span> <span class="o">=</span> <span class="n">bi0</span> <span class="o">+</span> <span class="n">ci0</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">*</span><span class="n">t</span><span class="o">**</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
          <span class="n">bi1</span> <span class="o">=</span> <span class="n">bi1</span> <span class="o">+</span> <span class="n">ci1</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">*</span><span class="n">t</span><span class="o">**</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
          <span class="n">bk0</span> <span class="o">=</span> <span class="n">bk0</span> <span class="o">+</span> <span class="n">ck0</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">*</span><span class="n">y</span><span class="o">**</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
          <span class="n">bk1</span> <span class="o">=</span> <span class="n">bk1</span> <span class="o">+</span> <span class="n">ck1</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">*</span><span class="n">y</span><span class="o">**</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
        <span class="k">END DO</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-312" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-312'>#</a>
          </div>
          <p>..........VALUES FOR k0(z) and k1(z).</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>        <span class="n">bk0</span> <span class="o">=</span> <span class="o">-</span><span class="n">coeff</span><span class="o">*</span><span class="n">bi0</span> <span class="o">+</span> <span class="n">bk0</span>
        <span class="n">bk1</span> <span class="o">=</span> <span class="n">coeff</span><span class="o">*</span><span class="n">bi1</span><span class="o">*</span><span class="n">z</span> <span class="o">+</span> <span class="n">bk1</span><span class="o">/</span><span class="n">z</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-313" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-313'>#</a>
          </div>
          
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="k">ELSE</span> <span class="c">!(z.le.2.)               !(Ref. 2).</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-314" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-314'>#</a>
          </div>
          <p>..........COMPUTE FACTORS.</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>        <span class="n">y</span> <span class="o">=</span> <span class="p">(</span><span class="mf">2.0</span><span class="o">/</span><span class="n">z</span><span class="p">)</span>
        <span class="n">coeff</span> <span class="o">=</span> <span class="p">(</span><span class="n">ex</span><span class="p">(</span><span class="o">-</span><span class="n">z</span><span class="p">)</span><span class="o">/</span><span class="nb">sqrt</span><span class="p">(</span><span class="n">z</span><span class="p">))</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-315" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-315'>#</a>
          </div>
          <p>..........VALUES FOR k0(z) and k1(z).</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>        <span class="n">bk0</span> <span class="o">=</span> <span class="n">c0</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">bk1</span> <span class="o">=</span> <span class="n">c1</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">DO </span><span class="n">i</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span><span class="mi">7</span>
          <span class="n">bk0</span> <span class="o">=</span> <span class="n">bk0</span> <span class="o">+</span> <span class="n">c0</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">*</span><span class="n">y</span><span class="o">**</span><span class="p">(</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
          <span class="n">bk1</span> <span class="o">=</span> <span class="n">bk1</span> <span class="o">+</span> <span class="n">c1</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">*</span><span class="n">y</span><span class="o">**</span><span class="p">(</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">END DO</span>
<span class="k">        </span><span class="n">bk0</span> <span class="o">=</span> <span class="n">coeff</span><span class="o">*</span><span class="n">bk0</span>
        <span class="n">bk1</span> <span class="o">=</span> <span class="n">coeff</span><span class="o">*</span><span class="n">bk1</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-316" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-316'>#</a>
          </div>
          
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="k">END IF</span> <span class="c">!(z.le.2.)</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-317" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-317'>#</a>
          </div>
          <p>C20-----FIND K2, K3, AND K4 BY ITERATION (Ref. 3)-------------------</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="n">bk2</span> <span class="o">=</span> <span class="mf">2.</span><span class="o">*</span><span class="p">(</span><span class="n">bk1</span><span class="o">/</span><span class="n">z</span><span class="p">)</span> <span class="o">+</span> <span class="n">bk0</span>       <span class="c">!k2(z).</span>
      <span class="n">bk3</span> <span class="o">=</span> <span class="mf">4.</span><span class="o">*</span><span class="p">(</span><span class="n">bk2</span><span class="o">/</span><span class="n">z</span><span class="p">)</span> <span class="o">+</span> <span class="n">bk1</span>       <span class="c">!k3(z).</span>
      <span class="n">bk4</span> <span class="o">=</span> <span class="mf">6.</span><span class="o">*</span><span class="p">(</span><span class="n">bk3</span><span class="o">/</span><span class="n">z</span><span class="p">)</span> <span class="o">+</span> <span class="n">bk2</span>       <span class="c">!k4(z).</span>

      <span class="k">RETURN</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-318" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-318'>#</a>
          </div>
          <p>C-------REFERENCES--------------------------------------</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-319" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-319'>#</a>
          </div>
          <p>Handbook of Mathematical Functions (Abramowitz and Stegun),</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-320" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-320'>#</a>
          </div>
          <p>Dover Publications, Inc., New York</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-321" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-321'>#</a>
          </div>
          <p>1) Polynomial approximations for z.le.2</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-322" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-322'>#</a>
          </div>
          <p>page 378, equations 9.8.1 and 9.8.3.</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-323" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-323'>#</a>
          </div>
          <p>page 379, equations 9.8.5 and 9.8.7.</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-324" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-324'>#</a>
          </div>
          <p>2) Polynomial approximations for z &gt; 2</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-325" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-325'>#</a>
          </div>
          <p>page 379, equations 9.8.6 and 9.8.8.</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-326" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-326'>#</a>
          </div>
          <p>3) Recursion relation from 1st line of 9.6.26, page 376.</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="k">END</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-327" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-327'>#</a>
          </div>
          <p>C===============IDENTIFICATION DIVISION====================</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="k">SUBROUTINE </span><span class="n">nudens</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-328" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-328'>#</a>
          </div>
          <p>C-------LINKAGES.</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-329" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-329'>#</a>
          </div>
          <p>CALLED BY - [subroutine] therm</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-330" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-330'>#</a>
          </div>
          <p>CALLS     - [function] xintd, eval</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-331" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-331'>#</a>
          </div>
          <p>C-------REMARKS.</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-332" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-332'>#</a>
          </div>
          <p>Computes energy density contribution from neutrinos.</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-333" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-333'>#</a>
          </div>
          <p>C-------COMMON AREAS.</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="k">COMMON</span> <span class="o">/</span><span class="n">modpr</span><span class="o">/</span>  <span class="n">g</span><span class="p">,</span><span class="n">tau</span><span class="p">,</span><span class="n">xnu</span><span class="p">,</span><span class="n">c</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="n">cosmo</span><span class="p">,</span><span class="n">xi</span>        <span class="c">!Model parameters.</span>
      <span class="k">COMMON</span> <span class="o">/</span><span class="n">nupar</span><span class="o">/</span>  <span class="n">t9mev</span><span class="p">,</span><span class="n">tnmev</span><span class="p">,</span><span class="n">tnu</span><span class="p">,</span><span class="n">cnorm</span><span class="p">,</span><span class="n">nu</span><span class="p">,</span><span class="n">rhonu</span> <span class="c">!Integration parameters.</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-334" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-334'>#</a>
          </div>
          <p>C-------EXTERNAL FUNCTIONS.</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="k">EXTERNAL </span><span class="n">func5</span>               <span class="c">!Integral for neutrinos.</span>
      <span class="k">EXTERNAL </span><span class="n">func6</span>               <span class="c">!Integral for antineutrinos.</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-335" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-335'>#</a>
          </div>
          <p>C=================DECLARATION DIVISION=====================</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-336" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-336'>#</a>
          </div>
          <p>C-------MODEL PARAMETERS.</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="kt">DOUBLE PRECISION    </span><span class="n">xi</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>                <span class="c">!Neutrino degeneracy parameters.</span>
      <span class="kt">DOUBLE PRECISION </span><span class="n">func5</span>
      <span class="kt">DOUBLE PRECISION </span><span class="n">func6</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-337" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-337'>#</a>
          </div>
          <p>C-------NEUTRINO PARAMETERS.</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="kt">DOUBLE PRECISION    </span><span class="n">tnu</span>                  <span class="c">!Neutrino temperature (units of 10**9 K).</span>
      <span class="kt">DOUBLE PRECISION    </span><span class="n">rhonu</span>                <span class="c">!Neutrino energy density.</span>
      <span class="kt">INTEGER </span><span class="n">nu</span>                   <span class="c">!Which neutrino type.</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-338" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-338'>#</a>
          </div>
          <p>C-------LOCAL VARIABLES.</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="kt">DOUBLE PRECISION    </span><span class="n">uplim1</span>               <span class="c">!Upper limit for neutrino energy integral.</span>
      <span class="kt">DOUBLE PRECISION    </span><span class="n">uplim2</span>               <span class="c">!Upper limit for antineu energy integral.</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-339" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-339'>#</a>
          </div>
          <p>C==================PROCEDURE DIVISION======================</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-340" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-340'>#</a>
          </div>
          <p>C10-----COMPUTE NEUTRINO ENERGY DENSITIES------------------------</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="k">IF</span> <span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">xi</span><span class="p">(</span><span class="n">nu</span><span class="p">)).</span><span class="n">le</span><span class="p">.</span><span class="mf">0.03</span><span class="p">)</span> <span class="k">THEN</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-341" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-341'>#</a>
          </div>
          <p>..........SMALL xi APPROXIMATION.</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>        <span class="n">rhonu</span> <span class="o">=</span> <span class="mf">2.</span><span class="o">*</span><span class="p">(</span><span class="mf">3.14159</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="mi">3</span><span class="mf">0.</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">tnu</span><span class="p">)</span><span class="o">**</span><span class="mi">4</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-342" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-342'>#</a>
          </div>
          
        </div>
        <div class='code'>
          <div class="highlight"><pre>     <span class="err">|</span>          <span class="o">*</span><span class="p">(</span><span class="mf">7.</span><span class="o">/</span><span class="mf">8.</span><span class="o">+</span><span class="p">(</span><span class="mi">1</span><span class="mf">5.</span><span class="o">/</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="mf">3.14159</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span><span class="o">*</span><span class="n">xi</span><span class="p">(</span><span class="n">nu</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>
     <span class="err">|</span>          <span class="o">+</span><span class="p">(</span><span class="mi">1</span><span class="mf">5.</span><span class="o">/</span><span class="p">(</span><span class="mf">8.</span><span class="o">*</span><span class="mf">3.14159</span><span class="o">**</span><span class="mi">4</span><span class="p">))</span><span class="o">*</span><span class="n">xi</span><span class="p">(</span><span class="n">nu</span><span class="p">)</span><span class="o">**</span><span class="mi">4</span><span class="p">)</span>
      <span class="k">ELSE</span>
<span class="k">        IF</span> <span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">xi</span><span class="p">(</span><span class="n">nu</span><span class="p">)).</span><span class="n">ge</span><span class="p">.</span><span class="mi">3</span><span class="mf">0.</span><span class="p">)</span> <span class="k">THEN</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-343" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-343'>#</a>
          </div>
          <p>..........LARGE xi APPROXIMATION.</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>          <span class="n">rhonu</span> <span class="o">=</span> <span class="p">((</span><span class="n">tnu</span><span class="p">)</span><span class="o">**</span><span class="mi">4</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mf">8.</span><span class="o">*</span><span class="mf">3.14159</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">xi</span><span class="p">(</span><span class="n">nu</span><span class="p">)</span><span class="o">**</span><span class="mi">4</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-344" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-344'>#</a>
          </div>
          
        </div>
        <div class='code'>
          <div class="highlight"><pre>     <span class="err">|</span>            <span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="mi">1</span><span class="mf">2.</span><span class="o">*</span><span class="mf">1.645</span> <span class="o">/</span><span class="n">xi</span><span class="p">(</span><span class="n">nu</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
        <span class="k">ELSE</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-345" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-345'>#</a>
          </div>
          <p>..........DO INTEGRATION</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>          <span class="n">uplim1</span> <span class="o">=</span> <span class="p">(</span><span class="mi">8</span><span class="mf">8.029</span><span class="o">+</span><span class="n">xi</span><span class="p">(</span><span class="n">nu</span><span class="p">))</span><span class="o">*</span><span class="n">tnu</span>
          <span class="n">uplim2</span> <span class="o">=</span> <span class="p">(</span><span class="mi">8</span><span class="mf">8.029</span><span class="o">-</span><span class="n">xi</span><span class="p">(</span><span class="n">nu</span><span class="p">))</span><span class="o">*</span><span class="n">tnu</span>
          <span class="k">IF</span> <span class="p">(</span><span class="n">uplim2</span><span class="p">.</span><span class="n">le</span><span class="p">.</span><span class="mf">0.</span><span class="p">)</span> <span class="k">THEN</span>
<span class="k">            </span><span class="n">rhonu</span> <span class="o">=</span> <span class="n">xintd</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span><span class="n">uplim1</span><span class="p">,</span><span class="n">func5</span><span class="p">,</span><span class="n">iter</span><span class="p">)</span>
          <span class="k">ELSE</span>
<span class="k">            </span><span class="n">rhonu</span><span class="o">=</span> <span class="n">xintd</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span><span class="n">uplim1</span><span class="p">,</span><span class="n">func5</span><span class="p">,</span><span class="n">iter</span><span class="p">)</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-346" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-346'>#</a>
          </div>
          
        </div>
        <div class='code'>
          <div class="highlight"><pre>     <span class="err">|</span>             <span class="o">+</span> <span class="n">xintd</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span><span class="n">uplim2</span><span class="p">,</span><span class="n">func6</span><span class="p">,</span><span class="n">iter</span><span class="p">)</span>
          <span class="k">END IF</span>
<span class="k">        END IF</span> <span class="c">!(abs(xi(nu)).ge.30.)</span>
      <span class="k">END IF</span> <span class="c">!(abs(xi(nu)).le.0.03)</span>


      <span class="k">RETURN</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-347" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-347'>#</a>
          </div>
          <p>C-------REFERENCES--------------------------------------</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-348" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-348'>#</a>
          </div>
          <p>Forms of the integrals involved can be found in</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-349" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-349'>#</a>
          </div>
          <p>Beaudet,G. and Goret,P., 1976, Astron. &amp; Astrophys., 49, 415.</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-350" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-350'>#</a>
          </div>
          <p>Freese, K., Kolb, E.W., Turner, M.S., 1983, Phys. Rev. D, 27, 1689.</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="k">END</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-351" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-351'>#</a>
          </div>
          <p>C===============IDENTIFICATION DIVISION====================</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="k">FUNCTION </span><span class="n">eval</span><span class="p">()</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-352" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-352'>#</a>
          </div>
          <p>C-------LINKAGES.</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-353" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-353'>#</a>
          </div>
          <p>CALLED BY - [subroutine] rate1, nudens</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-354" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-354'>#</a>
          </div>
          <p>CALLS     - [function] ex</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-355" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-355'>#</a>
          </div>
          <p>C-------REMARKS.</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-356" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-356'>#</a>
          </div>
          <p>Contains integrands to be integrated.</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-357" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-357'>#</a>
          </div>
          <p>C-------COMMON AREAS.</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="k">COMMON</span> <span class="o">/</span><span class="n">modpr</span><span class="o">/</span>  <span class="n">g</span><span class="p">,</span><span class="n">tau</span><span class="p">,</span><span class="n">xnu</span><span class="p">,</span><span class="n">c</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="n">cosmo</span><span class="p">,</span><span class="n">xi</span>        <span class="c">!Model parameters.</span>
      <span class="k">COMMON</span> <span class="o">/</span><span class="n">nupar</span><span class="o">/</span>  <span class="n">t9mev</span><span class="p">,</span><span class="n">tnmev</span><span class="p">,</span><span class="n">tnu</span><span class="p">,</span><span class="n">cnorm</span><span class="p">,</span><span class="n">nu</span><span class="p">,</span><span class="n">rhonu</span> <span class="c">!Integration parameters.</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-358" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-358'>#</a>
          </div>
          <p>C=================DECLARATION DIVISION=====================</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-359" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-359'>#</a>
          </div>
          <p>C-------MODEL PARAMETERS.</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="kt">DOUBLE PRECISION    </span><span class="n">xi</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>                <span class="c">!Neutrino degeneracy parameters.</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-360" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-360'>#</a>
          </div>
          <p>C-------NEUTRINO PARAMETERS.</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="kt">DOUBLE PRECISION    </span><span class="n">t9mev</span>                <span class="c">!Temperature (in units of MeV).</span>
      <span class="kt">DOUBLE PRECISION    </span><span class="n">tnmev</span>                <span class="c">!Neutrino temperature (in units of MeV).</span>
      <span class="kt">DOUBLE PRECISION    </span><span class="n">tnu</span>                  <span class="c">!Neutrino temperature (units of 10**9 K).</span>
      <span class="kt">DOUBLE PRECISION    </span><span class="n">cnorm</span>                <span class="c">!Normalizing constant.</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-361" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-361'>#</a>
          </div>
          <p>C-------FUNCTIONS TO BE EVALUATED.</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="kt">DOUBLE PRECISION   </span><span class="n">func1</span>                 <span class="c">!1st part n-&gt;p rate.</span>
      <span class="kt">DOUBLE PRECISION   </span><span class="n">func2</span>                 <span class="c">!2nd part n-&gt;p rate.</span>
      <span class="kt">DOUBLE PRECISION   </span><span class="n">func3</span>                 <span class="c">!1st part p-&gt;n rate.</span>
      <span class="kt">DOUBLE PRECISION   </span><span class="n">func4</span>                 <span class="c">!2nd part p-&gt;n rate.</span>
      <span class="kt">DOUBLE PRECISION   </span><span class="n">func5</span>                 <span class="c">!Energy density for neutrinos.</span>
      <span class="kt">DOUBLE PRECISION   </span><span class="n">func6</span>                 <span class="c">!Energy density for antineutrinos.</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-362" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-362'>#</a>
          </div>
          <p>C-------LOCAL VARIABLES.</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="kt">DOUBLE PRECISION    </span><span class="n">x</span>                    <span class="c">!Value at which function is evaluated.</span>
      <span class="kt">DOUBLE PRECISION    </span><span class="n">part1</span>                <span class="c">!Exponential expression with photon temp.</span>
      <span class="kt">DOUBLE PRECISION    </span><span class="n">part2</span>                <span class="c">!Exponential expression with neutrino temp.</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-363" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-363'>#</a>
          </div>
          <p>C==================PROCEDURE DIVISION======================</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-364" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-364'>#</a>
          </div>
          <p>C10-----1ST PART OF INTEGRAL FOR n-&gt;p RATE-----------------------</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="k">ENTRY </span><span class="n">func1</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
      <span class="k">IF</span> <span class="p">(</span><span class="n">x</span><span class="p">.</span><span class="n">le</span><span class="p">.</span><span class="mf">0.</span><span class="p">)</span> <span class="k">THEN</span>
<span class="k">        </span><span class="n">func1</span> <span class="o">=</span> <span class="mf">0.</span>
      <span class="k">ELSE</span>
<span class="k">        </span><span class="n">part1</span> <span class="o">=</span> <span class="mf">1.</span><span class="o">/</span><span class="p">(</span><span class="mf">1.</span><span class="o">+</span><span class="n">ex</span><span class="p">(</span><span class="o">-</span><span class="p">.</span><span class="mi">511</span><span class="o">*</span><span class="n">x</span><span class="o">/</span><span class="p">(</span><span class="n">t9mev</span><span class="p">)))</span>
        <span class="n">part2</span> <span class="o">=</span> <span class="mf">1.</span><span class="o">/</span><span class="p">(</span><span class="mf">1.</span><span class="o">+</span><span class="n">ex</span><span class="p">(</span><span class="o">+</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="mf">2.531</span><span class="p">)</span><span class="o">*</span><span class="p">(.</span><span class="mi">511</span><span class="o">/</span><span class="p">(</span><span class="n">tnmev</span><span class="p">))</span><span class="o">-</span><span class="n">xi</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
        <span class="n">func1</span> <span class="o">=</span> <span class="n">cnorm</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="mf">2.531</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="p">.</span><span class="mi">5</span><span class="o">*</span><span class="n">part1</span><span class="o">*</span><span class="n">part2</span>
      <span class="k">END IF</span>
<span class="k">      RETURN</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-365" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-365'>#</a>
          </div>
          <p>C20-----2ND PART OF INTEGRAL FOR n-&gt;p RATE-----------------------</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="k">ENTRY </span><span class="n">func2</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
      <span class="k">IF</span> <span class="p">(</span><span class="n">x</span><span class="p">.</span><span class="n">le</span><span class="p">.</span><span class="mf">1.</span><span class="p">)</span> <span class="k">THEN</span>
<span class="k">        </span><span class="n">func2</span> <span class="o">=</span> <span class="mf">0.</span>
      <span class="k">ELSE</span>
<span class="k">        </span><span class="n">part1</span> <span class="o">=</span> <span class="mf">1.</span><span class="o">/</span><span class="p">(</span><span class="mf">1.</span><span class="o">+</span><span class="n">ex</span><span class="p">(</span><span class="o">+</span><span class="p">.</span><span class="mi">511</span><span class="o">*</span><span class="n">x</span><span class="o">/</span><span class="p">(</span><span class="n">t9mev</span><span class="p">)))</span>
        <span class="n">part2</span> <span class="o">=</span> <span class="mf">1.</span><span class="o">/</span><span class="p">(</span><span class="mf">1.</span><span class="o">+</span><span class="n">ex</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="mf">2.531</span><span class="p">)</span><span class="o">*</span><span class="p">(.</span><span class="mi">511</span><span class="o">/</span><span class="p">(</span><span class="n">tnmev</span><span class="p">))</span><span class="o">-</span><span class="n">xi</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
        <span class="n">func2</span> <span class="o">=</span> <span class="n">cnorm</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="mf">2.531</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="p">.</span><span class="mi">5</span><span class="o">*</span><span class="n">part1</span><span class="o">*</span><span class="n">part2</span>
      <span class="k">END IF</span>
<span class="k">      RETURN</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-366" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-366'>#</a>
          </div>
          <p>C30-----1ST PART OF INTEGRAL FOR p-&gt;n RATE-----------------------</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="k">ENTRY </span><span class="n">func3</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
      <span class="k">IF</span> <span class="p">(</span><span class="n">x</span><span class="p">.</span><span class="n">le</span><span class="p">.</span><span class="mf">1.</span><span class="p">)</span> <span class="k">THEN</span>
<span class="k">        </span><span class="n">func3</span> <span class="o">=</span> <span class="mf">0.</span>
      <span class="k">ELSE</span>
<span class="k">        </span><span class="n">part1</span> <span class="o">=</span> <span class="mf">1.</span><span class="o">/</span><span class="p">(</span><span class="mf">1.</span><span class="o">+</span><span class="n">ex</span><span class="p">(</span><span class="o">-</span><span class="p">.</span><span class="mi">511</span><span class="o">*</span><span class="n">x</span><span class="o">/</span><span class="p">(</span><span class="n">t9mev</span><span class="p">)))</span>
        <span class="n">part2</span> <span class="o">=</span> <span class="mf">1.</span><span class="o">/</span><span class="p">(</span><span class="mf">1.</span><span class="o">+</span><span class="n">ex</span><span class="p">(</span><span class="o">+</span><span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="mf">2.531</span><span class="p">)</span><span class="o">*</span><span class="p">(.</span><span class="mi">511</span><span class="o">/</span><span class="p">(</span><span class="n">tnmev</span><span class="p">))</span><span class="o">+</span><span class="n">xi</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
        <span class="n">func3</span> <span class="o">=</span> <span class="n">cnorm</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="mf">2.531</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="p">.</span><span class="mi">5</span><span class="o">*</span><span class="n">part1</span><span class="o">*</span><span class="n">part2</span>
      <span class="k">END IF</span>
<span class="k">      RETURN</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-367" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-367'>#</a>
          </div>
          <p>C40-----2ND PART OF INTEGRAL FOR p-&gt;n RATE-----------------------</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="k">ENTRY </span><span class="n">func4</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
      <span class="k">IF</span> <span class="p">(</span><span class="n">x</span><span class="p">.</span><span class="n">le</span><span class="p">.</span><span class="mf">1.</span><span class="p">)</span> <span class="k">THEN</span>
<span class="k">        </span><span class="n">func4</span> <span class="o">=</span> <span class="mf">0.</span>
      <span class="k">ELSE</span>
<span class="k">        </span><span class="n">part1</span> <span class="o">=</span> <span class="mf">1.</span><span class="o">/</span><span class="p">(</span><span class="mf">1.</span><span class="o">+</span><span class="n">ex</span><span class="p">(</span><span class="o">+</span><span class="p">.</span><span class="mi">511</span><span class="o">*</span><span class="n">x</span><span class="o">/</span><span class="p">(</span><span class="n">t9mev</span><span class="p">)))</span>
        <span class="n">part2</span> <span class="o">=</span> <span class="mf">1.</span><span class="o">/</span><span class="p">(</span><span class="mf">1.</span><span class="o">+</span><span class="n">ex</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="mf">2.531</span><span class="p">)</span><span class="o">*</span><span class="p">(.</span><span class="mi">511</span><span class="o">/</span><span class="p">(</span><span class="n">tnmev</span><span class="p">))</span><span class="o">+</span><span class="n">xi</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
        <span class="n">func4</span> <span class="o">=</span> <span class="n">cnorm</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="mf">2.531</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="p">.</span><span class="mi">5</span><span class="o">*</span><span class="n">part1</span><span class="o">*</span><span class="n">part2</span>
      <span class="k">END IF</span>
<span class="k">      RETURN</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-368" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-368'>#</a>
          </div>
          <p>C50-----INTEGRAL FOR ENERGY DENSITY OF NEUTRINO---------------------</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="k">ENTRY </span><span class="n">func5</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
      <span class="n">func5</span> <span class="o">=</span> <span class="mf">1.</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="mf">3.14159</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">3</span><span class="o">/</span><span class="p">(</span><span class="mf">1.</span><span class="o">+</span><span class="nb">exp</span><span class="p">(</span><span class="n">x</span><span class="o">/</span><span class="n">tnu</span><span class="o">-</span><span class="n">xi</span><span class="p">(</span><span class="n">nu</span><span class="p">)))</span>
      <span class="k">RETURN</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-369" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-369'>#</a>
          </div>
          <p>C60-----INTEGRAL FOR ENERGY DENSITY OF ANTINEUTRINO-----------------</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="k">ENTRY </span><span class="n">func6</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
      <span class="n">func6</span> <span class="o">=</span> <span class="mf">1.</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="mf">3.14159</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">3</span><span class="o">/</span><span class="p">(</span><span class="mf">1.</span><span class="o">+</span><span class="nb">exp</span><span class="p">(</span><span class="n">x</span><span class="o">/</span><span class="n">tnu</span><span class="o">+</span><span class="n">xi</span><span class="p">(</span><span class="n">nu</span><span class="p">)))</span>
      <span class="k">RETURN</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-370" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-370'>#</a>
          </div>
          <p>C-------REFERENCES--------------------------------------</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-371" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-371'>#</a>
          </div>
          <p>Forms of the integrals involved can be found in</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-372" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-372'>#</a>
          </div>
          <p>Scherrer,R.J., 1983, Mon.Not.R.astr.Soc., 205, 683.</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-373" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-373'>#</a>
          </div>
          <p>Beaudet,G. and Goret,P., 1976, Astron. &amp; Astrophys., 49, 415.</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="k">END</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-374" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-374'>#</a>
          </div>
          <p>C===============IDENTIFICATION DIVISION====================</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="k">FUNCTION </span><span class="n">xintd</span> <span class="p">(</span><span class="n">xlow</span><span class="p">,</span><span class="n">xhi</span><span class="p">,</span><span class="n">func</span><span class="p">,</span><span class="n">nq</span><span class="p">)</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-375" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-375'>#</a>
          </div>
          <p>C-------LINKAGES.</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-376" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-376'>#</a>
          </div>
          <p>CALLED BY - [subroutine] rate1, nudens</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-377" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-377'>#</a>
          </div>
          <p>CALLS     - none</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-378" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-378'>#</a>
          </div>
          <p>C-------REMARKS.</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-379" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-379'>#</a>
          </div>
          <p>Computes the integral of the function "func".</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-380" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-380'>#</a>
          </div>
          <p>C=================DECLARATION DIVISION=====================</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-381" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-381'>#</a>
          </div>
          <p>C-------INPUT VARIABLES.</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="k">external </span><span class="n">func</span>
      <span class="kt">DOUBLE PRECISION    </span><span class="n">xlow</span>                 <span class="c">!Array of low limits.</span>
      <span class="kt">DOUBLE PRECISION    </span><span class="n">xhi</span>                  <span class="c">!Array of high limits.</span>
      <span class="kt">INTEGER </span><span class="n">nq</span>                   <span class="c">!Number of six point gaussian quads.</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-382" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-382'>#</a>
          </div>
          <p>C-------COMPUTATION VARIABLES.</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="kt">DOUBLE PRECISION    </span><span class="n">dist</span>                 <span class="c">!Size of quad interval.</span>
      <span class="kt">DOUBLE PRECISION    </span><span class="n">cent</span>                 <span class="c">!Center of quad interval.</span>
      <span class="kt">DOUBLE PRECISION    </span><span class="n">x</span>                    <span class="c">!Variables of integration.</span>
      <span class="kt">DOUBLE PRECISION    </span><span class="nb">sum</span>                  <span class="c">!Summation of terms.</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-383" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-383'>#</a>
          </div>
          <p>C-------COUNTERS.</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="kt">INTEGER </span><span class="nb">nint</span>                 <span class="c">!Interval number.</span>
      <span class="kt">INTEGER </span><span class="n">npnt</span>                 <span class="c">!Point number.</span>
      <span class="kt">INTEGER </span><span class="n">np</span>                   <span class="c">!Total number of points in interval.</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-384" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-384'>#</a>
          </div>
          <p>C-------ABSCISSAS AND WEIGHT FACTORS.</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="kt">DOUBLE PRECISION    </span><span class="n">u</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>                 <span class="c">!Abscissas.</span>
      <span class="kt">DOUBLE PRECISION    </span><span class="n">w</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>                 <span class="c">!Weight factor.</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-385" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-385'>#</a>
          </div>
          <p>C=====================DATA DIVISION========================</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-386" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-386'>#</a>
          </div>
          <p>C-------ABSCISSAS AND WEIGHT FACTORS.</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="k">DATA </span><span class="n">u</span><span class="o">/-</span><span class="p">.</span><span class="mi">93246951420315</span><span class="p">,</span><span class="o">-</span><span class="p">.</span><span class="mi">66120938646627</span><span class="p">,</span><span class="o">-</span><span class="p">.</span><span class="mi">23861918608320</span><span class="p">,</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-387" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-387'>#</a>
          </div>
          
        </div>
        <div class='code'>
          <div class="highlight"><pre>     <span class="err">|</span>        <span class="p">.</span><span class="mi">23861918608320</span><span class="p">,</span> <span class="p">.</span><span class="mi">66120938646627</span><span class="p">,</span> <span class="p">.</span><span class="mi">93246951420315</span><span class="o">/</span>
      <span class="k">DATA </span><span class="n">w</span><span class="o">/</span><span class="p">.</span><span class="mi">17132449237917</span><span class="p">,.</span><span class="mi">36076157304814</span><span class="p">,.</span><span class="mi">46791393457269</span><span class="p">,</span>
     <span class="err">|</span>       <span class="p">.</span><span class="mi">46791393457269</span><span class="p">,.</span><span class="mi">36076157304814</span><span class="p">,.</span><span class="mi">17132449237917</span><span class="o">/</span>
      <span class="k">DATA </span><span class="n">np</span><span class="o">/</span><span class="mi">6</span><span class="o">/</span>              <span class="c">!6 point Gaussian integration.</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-388" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-388'>#</a>
          </div>
          <p>C==================PROCEDURE DIVISION======================</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-389" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-389'>#</a>
          </div>
          <p>C10-----DO INTEGRATION-------------------------------------</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="nb">sum</span>   <span class="o">=</span> <span class="mf">0.</span>
      <span class="n">dist</span>  <span class="o">=</span> <span class="p">(</span><span class="n">xhi</span><span class="o">-</span><span class="n">xlow</span><span class="p">)</span><span class="o">/</span><span class="nb">float</span><span class="p">(</span><span class="n">nq</span><span class="p">)</span> <span class="c">!Size of quad interval.</span>
      <span class="k">DO </span><span class="nb">nint</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">nq</span>
        <span class="n">cent</span> <span class="o">=</span> <span class="n">xlow</span><span class="o">+</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="nb">nint</span><span class="p">)</span><span class="o">-</span><span class="mf">0.5</span><span class="p">)</span><span class="o">*</span><span class="n">dist</span>  <span class="c">!Center of interval.</span>
        <span class="k">DO </span><span class="n">npnt</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">np</span>
          <span class="n">x</span>   <span class="o">=</span> <span class="n">cent</span><span class="o">+</span><span class="mf">0.5</span><span class="o">*</span><span class="n">dist</span><span class="o">*</span><span class="n">u</span><span class="p">(</span><span class="n">npnt</span><span class="p">)</span> <span class="c">!Integration point.</span>
          <span class="n">f</span>   <span class="o">=</span> <span class="n">func</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>            <span class="c">!Evaluate function x(1).</span>
          <span class="nb">sum</span> <span class="o">=</span> <span class="nb">sum</span><span class="o">+</span><span class="n">f</span><span class="o">*</span><span class="n">w</span><span class="p">(</span><span class="n">npnt</span><span class="p">)</span>      <span class="c">!Add up sum.</span>
        <span class="k">END DO</span>
<span class="k">      END DO</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-390" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-390'>#</a>
          </div>
          <p>C20-----GET INTEGRAL VALUE---------------------------------</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="n">xintd</span> <span class="o">=</span> <span class="nb">sum</span><span class="o">*</span><span class="n">dist</span><span class="o">*</span><span class="mf">0.5</span>         <span class="c">!Do integral.</span>
      <span class="k">RETURN</span>

<span class="k">      END</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-391" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-391'>#</a>
          </div>
          <p>C===============IDENTIFICATION DIVISION====================</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="k">FUNCTION </span><span class="n">ex</span><span class="p">(</span><span class="n">x</span><span class="p">)</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-392" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-392'>#</a>
          </div>
          <p>C-------LINKAGES.</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-393" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-393'>#</a>
          </div>
          <p>CALLED BY - [subroutine] start, rate2, rate3, rate4, sol</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-394" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-394'>#</a>
          </div>
          <ul>
<li>[function] eval</li>
</ul>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-395" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-395'>#</a>
          </div>
          <p>CALLS     - none</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-396" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-396'>#</a>
          </div>
          <p>C-------REMARKS.</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-397" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-397'>#</a>
          </div>
          <p>Exponential function with underflow precaution.</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-398" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-398'>#</a>
          </div>
          <p>C==================PROCEDURE DIVISION======================</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="k">IF</span> <span class="p">(</span><span class="n">x</span><span class="p">.</span><span class="n">gt</span><span class="p">.</span><span class="mi">8</span><span class="mf">8.029</span><span class="p">)</span> <span class="k">THEN</span>        <span class="c">!In danger of overflow.</span>
        <span class="n">ex</span> <span class="o">=</span> <span class="nb">exp</span><span class="p">(</span><span class="mi">8</span><span class="mf">8.029</span><span class="p">)</span>
      <span class="k">ELSE</span>
<span class="k">        IF</span> <span class="p">(</span><span class="n">x</span><span class="p">.</span><span class="n">lt</span><span class="p">.</span><span class="o">-</span><span class="mi">8</span><span class="mf">8.722</span><span class="p">)</span> <span class="k">THEN</span>     <span class="c">!In danger of underflow.</span>
          <span class="n">ex</span> <span class="o">=</span> <span class="mf">0.</span>
        <span class="k">ELSE</span>                       <span class="c">!Value of x in allowable range.</span>
          <span class="n">ex</span> <span class="o">=</span> <span class="nb">exp</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="k">END IF</span>
<span class="k">      END IF</span>
<span class="k">      RETURN</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-399" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-399'>#</a>
          </div>
          <p>C-------NOTE-----------------------------------------</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-400" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-400'>#</a>
          </div>
          <p>The overflow limit for the VAX/VMS system is exp(88.029).</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-401" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-401'>#</a>
          </div>
          <p>The underflow limit for the VAX/VMS system is exp(-88.722).</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="k">END</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-402" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-402'>#</a>
          </div>
          <p>C===============IDENTIFICATION DIVISION====================</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="k">SUBROUTINE </span><span class="n">sol</span><span class="p">(</span><span class="n">loop</span><span class="p">)</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-403" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-403'>#</a>
          </div>
          <p>C-------LINKAGES.</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-404" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-404'>#</a>
          </div>
          <p>CALLED BY - [subroutine] derivs</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-405" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-405'>#</a>
          </div>
          <p>CALLS     - [subroutine] eqslin</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-406" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-406'>#</a>
          </div>
          <ul>
<li>[function] ex</li>
</ul>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-407" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-407'>#</a>
          </div>
          <p>C-------REMARKS.</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-408" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-408'>#</a>
          </div>
          <p>Computes reverse strong and electromagnetic reaction rates.</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-409" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-409'>#</a>
          </div>
          <p>Fills and solves matrix equation for dydt(i).</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="k">USE </span><span class="n">commons</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-410" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-410'>#</a>
          </div>
          <p>C--------COMMON AREAS.</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="k">COMMON</span> <span class="o">/</span><span class="n">recpr</span><span class="o">/</span>  <span class="n">iform</span><span class="p">,</span><span class="n">ii</span><span class="p">,</span><span class="n">jj</span><span class="p">,</span><span class="n">kk</span><span class="p">,</span><span class="n">ll</span><span class="p">,</span><span class="n">rev</span><span class="p">,</span><span class="n">q9</span>     <span class="c">!Reaction parameters names.</span>
      <span class="k">COMMON</span> <span class="o">/</span><span class="n">rates</span><span class="o">/</span>  <span class="n">f</span><span class="p">,</span><span class="n">r</span>                            <span class="c">!Reaction rates.</span>
      <span class="k">COMMON</span> <span class="o">/</span><span class="n">evolp1</span><span class="o">/</span> <span class="n">t9</span><span class="p">,</span><span class="n">hv</span><span class="p">,</span><span class="n">phie</span><span class="p">,</span><span class="n">y</span>                   <span class="c">!Evolution parameters.</span>
      <span class="k">COMMON</span> <span class="o">/</span><span class="n">evolp2</span><span class="o">/</span> <span class="n">dt9</span><span class="p">,</span><span class="n">dhv</span><span class="p">,</span><span class="n">dphie</span><span class="p">,</span><span class="n">dydt</span>             <span class="c">!Evolution parameters.</span>
      <span class="k">COMMON</span> <span class="o">/</span><span class="n">evolp3</span><span class="o">/</span> <span class="n">t90</span><span class="p">,</span><span class="n">hv0</span><span class="p">,</span><span class="n">phie0</span><span class="p">,</span><span class="n">y0</span>               <span class="c">!Evolution parameters.</span>
      <span class="k">COMMON</span> <span class="o">/</span><span class="nb">time</span><span class="o">/</span>   <span class="n">t</span><span class="p">,</span><span class="n">dt</span><span class="p">,</span><span class="n">dlt9dt</span>                    <span class="c">!Time varying parameters.</span>
      <span class="k">COMMON</span> <span class="o">/</span><span class="n">xtherm</span><span class="o">/</span>  <span class="n">thm</span><span class="p">(</span><span class="mi">14</span><span class="p">),</span><span class="n">hubcst</span>                 <span class="c">!Dynamic variables.</span>
      <span class="k">COMMON</span> <span class="o">/</span><span class="n">endens</span><span class="o">/</span> <span class="n">rhone0</span><span class="p">,</span><span class="n">rhob0</span><span class="p">,</span><span class="n">rhob</span><span class="p">,</span><span class="n">rnb</span>          <span class="c">!Energy densities.</span>
      <span class="k">COMMON</span> <span class="o">/</span><span class="n">lncoef</span><span class="o">/</span> <span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">yx</span>                         <span class="c">!Linear eqn coefficients.</span>
      <span class="k">COMMON</span> <span class="o">/</span><span class="n">flags</span><span class="o">/</span>  <span class="nb">ltime</span><span class="p">,</span><span class="k">is</span><span class="p">,</span><span class="n">ip</span><span class="p">,</span><span class="n">it</span><span class="p">,</span><span class="n">mbad</span>            <span class="c">!Flags,counters.</span>
      <span class="k">COMMON</span> <span class="o">/</span><span class="n">runopt</span><span class="o">/</span> <span class="n">irun</span><span class="p">,</span><span class="n">isize</span><span class="p">,</span><span class="n">jsize</span>               <span class="c">!Run option.</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-411" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-411'>#</a>
          </div>
          <p>C=================DECLARATION DIVISION=====================</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-412" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-412'>#</a>
          </div>
          <p>C-------REACTION PARAMETERS.</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="kt">INTEGER </span><span class="n">iform</span><span class="p">(</span><span class="n">nrec</span><span class="p">)</span>          <span class="c">!Reaction code number (1-88).</span>
      <span class="kt">INTEGER </span><span class="n">ii</span><span class="p">(</span><span class="n">nrec</span><span class="p">)</span>             <span class="c">!Incoming nuclide type (1-26).</span>
      <span class="kt">INTEGER </span><span class="n">jj</span><span class="p">(</span><span class="n">nrec</span><span class="p">)</span>             <span class="c">!Incoming light nuclide type (1-6).</span>
      <span class="kt">INTEGER </span><span class="n">kk</span><span class="p">(</span><span class="n">nrec</span><span class="p">)</span>             <span class="c">!Outgoing light nuclide type (1-6).</span>
      <span class="kt">INTEGER </span><span class="n">ll</span><span class="p">(</span><span class="n">nrec</span><span class="p">)</span>             <span class="c">!Outgoing nuclide type (1-26).</span>
      <span class="kt">DOUBLE PRECISION    </span><span class="n">rev</span><span class="p">(</span><span class="n">nrec</span><span class="p">)</span>            <span class="c">!Reverse reaction coefficient.</span>
      <span class="kt">DOUBLE PRECISION    </span><span class="n">q9</span><span class="p">(</span><span class="n">nrec</span><span class="p">)</span>             <span class="c">!Energy released in reaction.</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-413" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-413'>#</a>
          </div>
          <p>C-------REACTION RATES.</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="kt">DOUBLE PRECISION    </span><span class="n">f</span><span class="p">(</span><span class="n">nrec</span><span class="p">)</span>              <span class="c">!Forward reaction rate coefficients.</span>
      <span class="kt">DOUBLE PRECISION    </span><span class="n">r</span><span class="p">(</span><span class="n">nrec</span><span class="p">)</span>              <span class="c">!Reverse reaction rate coefficients.</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-414" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-414'>#</a>
          </div>
          <p>C-------EVOLUTION PARAMETERS.</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="kt">DOUBLE PRECISION    </span><span class="n">t9</span>                   <span class="c">!Temperature (in units of 10**9 K).</span>
      <span class="kt">DOUBLE PRECISION    </span><span class="n">y</span><span class="p">(</span><span class="n">nnuc</span><span class="p">)</span>              <span class="c">!Relative number abundances.</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-415" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-415'>#</a>
          </div>
          <p>C-------EVOLUTION PARAMETERS (DERIVATIVES).</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="kt">DOUBLE PRECISION    </span><span class="n">dydt</span><span class="p">(</span><span class="n">nnuc</span><span class="p">)</span>           <span class="c">!Change in rel number abundances.</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-416" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-416'>#</a>
          </div>
          <p>C-------EVOLUTION PARAMETERS (ORIGINAL VALUES).</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="kt">DOUBLE PRECISION    </span><span class="n">y0</span><span class="p">(</span><span class="n">nnuc</span><span class="p">)</span>             <span class="c">!Rel # abund at start of iteration.</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-417" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-417'>#</a>
          </div>
          <p>C-------TIME VARIABLES.</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="kt">DOUBLE PRECISION    </span><span class="n">dt</span>                   <span class="c">!Time step.</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-418" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-418'>#</a>
          </div>
          <p>C-------DYNAMIC VARIABLES.</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="kt">DOUBLE PRECISION    </span><span class="n">hubcst</span>               <span class="c">!Expansion rate.</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-419" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-419'>#</a>
          </div>
          <p>C-------ENERGY DENSITIES.</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="kt">DOUBLE PRECISION    </span><span class="n">rhob</span>                 <span class="c">!Baryon mass density.</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-420" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-420'>#</a>
          </div>
          <p>C-------COMPONENTS OF MATRIX EQUATION.</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="kt">DOUBLE PRECISION </span><span class="n">a</span><span class="p">(</span><span class="n">nnuc</span><span class="p">,</span><span class="n">nnuc</span><span class="p">)</span> <span class="c">!Relates y(t-dt) to y(t).</span>
      <span class="kt">DOUBLE PRECISION    </span><span class="n">b</span><span class="p">(</span><span class="n">nnuc</span><span class="p">)</span>              <span class="c">!Contains y0 in inverse order.</span>
      <span class="kt">DOUBLE PRECISION    </span><span class="n">yx</span><span class="p">(</span><span class="n">nnuc</span><span class="p">)</span>             <span class="c">!yy in reverse order.</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-421" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-421'>#</a>
          </div>
          <p>C-------COUNTERS AND FLAGS.</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="kt">INTEGER </span><span class="n">loop</span>                 <span class="c">!Counts which Runge-Kutta loop.</span>
      <span class="kt">INTEGER </span><span class="n">ip</span>                   <span class="c">!# time steps after outputting a line.</span>
      <span class="kt">INTEGER </span><span class="n">mbad</span>                 <span class="c">!Indicates if gaussian elimination fails.</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-422" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-422'>#</a>
          </div>
          <p>C-------RUN OPTIONS.</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="kt">INTEGER </span><span class="n">isize</span>                <span class="c">!Number of nuclides in computation.</span>
      <span class="kt">INTEGER </span><span class="n">isize1</span>               <span class="c">!Equals isize + 1.</span>
      <span class="kt">INTEGER </span><span class="n">jsize</span>                <span class="c">!Number of reactions in computation.</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-423" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-423'>#</a>
          </div>
          <p>C-------EVOLUTION EQUATION COEFFICIENTS.</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="kt">INTEGER </span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="n">l</span>              <span class="c">!Equate to ii,jj,kk,ll.</span>
      <span class="kt">DOUBLE PRECISION    </span><span class="n">ri</span><span class="p">,</span><span class="n">rj</span><span class="p">,</span><span class="n">rk</span><span class="p">,</span><span class="n">rl</span>          <span class="c">!Equate to si,sj,sk,sl.</span>
      <span class="kt">DOUBLE PRECISION    </span><span class="n">ci</span><span class="p">,</span><span class="n">cj</span><span class="p">,</span><span class="n">ck</span><span class="p">,</span><span class="n">cl</span>          <span class="c">!Coefficients of rate equation.</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-424" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-424'>#</a>
          </div>
          <p>C-------LOCAL VARIABLES.</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="kt">DOUBLE PRECISION    </span><span class="n">yy</span><span class="p">(</span><span class="n">nnuc</span><span class="p">)</span>             <span class="c">!Abundances at end of iteration.</span>
      <span class="kt">DOUBLE PRECISION    </span><span class="n">si</span><span class="p">(</span><span class="mi">11</span><span class="p">),</span><span class="n">sj</span><span class="p">(</span><span class="mi">11</span><span class="p">),</span><span class="n">sk</span><span class="p">(</span><span class="mi">11</span><span class="p">),</span><span class="n">sl</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span>  <span class="c">!# of nuclide i,j,k,l</span>
      <span class="kt">DOUBLE PRECISION    </span><span class="n">bdln</span>                 <span class="c">!(10**(-5))*volume expansion rate.</span>
      <span class="kt">INTEGER </span><span class="n">ind</span>                  <span class="c">!Equate to iform.</span>
      <span class="kt">INTEGER </span><span class="n">ierror</span>               <span class="c">!Element which does not converge.</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-425" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-425'>#</a>
          </div>
          <p>C=====================DATA DIVISION========================</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-426" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-426'>#</a>
          </div>
          <p>C-------NUMBER OF NUCLIDES IN REACTION TYPES 1-11.</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="k">DATA </span><span class="n">si</span> <span class="o">/</span><span class="mf">1.</span><span class="p">,</span><span class="mf">1.</span><span class="p">,</span><span class="mf">1.</span><span class="p">,</span><span class="mf">1.</span><span class="p">,</span><span class="mf">1.</span><span class="p">,</span><span class="mf">2.</span><span class="p">,</span><span class="mf">3.</span><span class="p">,</span><span class="mf">2.</span><span class="p">,</span><span class="mf">1.</span><span class="p">,</span><span class="mf">1.</span><span class="p">,</span><span class="mf">2.</span><span class="o">/</span>
      <span class="k">DATA </span><span class="n">sj</span> <span class="o">/</span><span class="mf">0.</span><span class="p">,</span><span class="mf">1.</span><span class="p">,</span><span class="mf">1.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">1.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">1.</span><span class="p">,</span><span class="mf">1.</span><span class="p">,</span><span class="mf">1.</span><span class="p">,</span><span class="mf">0.</span><span class="o">/</span>
      <span class="k">DATA </span><span class="n">sk</span> <span class="o">/</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">1.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">1.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">1.</span><span class="p">,</span><span class="mf">0.</span><span class="p">,</span><span class="mf">2.</span><span class="o">/</span>
      <span class="k">DATA </span><span class="n">sl</span> <span class="o">/</span><span class="mf">1.</span><span class="p">,</span><span class="mf">1.</span><span class="p">,</span><span class="mf">1.</span><span class="p">,</span><span class="mf">2.</span><span class="p">,</span><span class="mf">2.</span><span class="p">,</span><span class="mf">1.</span><span class="p">,</span><span class="mf">1.</span><span class="p">,</span><span class="mf">1.</span><span class="p">,</span><span class="mf">2.</span><span class="p">,</span><span class="mf">3.</span><span class="p">,</span><span class="mf">1.</span><span class="o">/</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-427" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-427'>#</a>
          </div>
          <p>C==================PROCEDURE DIVISION======================</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-428" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-428'>#</a>
          </div>
          <p>C10-----TEMPERATURE FACTORS AND INITIAL VALUES--------------</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-429" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-429'>#</a>
          </div>
          <p>C..........TEMPERATURE FACTORS.</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="n">t932</span>  <span class="o">=</span> <span class="n">t9</span><span class="o">**</span><span class="mf">1.5</span>              <span class="c">!t9**(3/2).</span>
      <span class="n">t9m32</span> <span class="o">=</span> <span class="mf">1.</span><span class="o">/</span><span class="n">t932</span>              <span class="c">!t9**(-3/2).</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-430" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-430'>#</a>
          </div>
          <p>..........MATRIX SIZE.</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="n">isize1</span> <span class="o">=</span> <span class="n">isize</span> <span class="o">+</span> <span class="mi">1</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-431" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-431'>#</a>
          </div>
          <p>..........INITIALIZE A-MATRIX.</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="k">DO </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">isize</span>
        <span class="k">DO </span><span class="n">j</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">isize</span>
          <span class="n">a</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="n">i</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.</span><span class="n">d0</span>            <span class="c">!Set a-matrix to zero.</span>
        <span class="k">END DO</span>
<span class="k">      END DO</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-432" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-432'>#</a>
          </div>
          <p>C20-----COMPUTE FACTORS FOR THE A-MATRIX-------------------------</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="k">DO </span><span class="n">n</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">jsize</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-433" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-433'>#</a>
          </div>
          <p>..........EQUATE VARIABLES TO ARRAYS.</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>        <span class="n">ind</span> <span class="o">=</span> <span class="n">iform</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>             <span class="c">!Type of reaction.</span>
        <span class="n">i</span> <span class="o">=</span> <span class="n">ii</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>                  <span class="c">!ID # of incoming nuclide i.</span>
        <span class="n">j</span> <span class="o">=</span> <span class="n">jj</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>                  <span class="c">!ID # of incoming nuclide j.</span>
        <span class="n">k</span> <span class="o">=</span> <span class="n">kk</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>                  <span class="c">!ID # of outgoing nuclide k.</span>
        <span class="n">l</span> <span class="o">=</span> <span class="n">ll</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>                  <span class="c">!ID # of outgoing nuclide l.</span>
        <span class="k">IF</span> <span class="p">((</span><span class="n">ind</span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="mi">0</span><span class="p">).</span><span class="nb">and</span><span class="p">.(</span><span class="n">i</span><span class="p">.</span><span class="n">le</span><span class="p">.</span><span class="n">isize</span><span class="p">).</span><span class="nb">and</span><span class="p">.(</span><span class="n">l</span><span class="p">.</span><span class="n">le</span><span class="p">.</span><span class="n">isize</span><span class="p">))</span> <span class="k">THEN</span> <span class="c">!Reaction okay.</span>
          <span class="n">ri</span> <span class="o">=</span> <span class="n">si</span><span class="p">(</span><span class="n">ind</span><span class="p">)</span>             <span class="c">!# of incoming nuclide i.</span>
          <span class="n">rj</span> <span class="o">=</span> <span class="n">sj</span><span class="p">(</span><span class="n">ind</span><span class="p">)</span>             <span class="c">!# of incoming nuclide j.</span>
          <span class="n">rk</span> <span class="o">=</span> <span class="n">sk</span><span class="p">(</span><span class="n">ind</span><span class="p">)</span>             <span class="c">!# of outgoing nuclide k.</span>
          <span class="n">rl</span> <span class="o">=</span> <span class="n">sl</span><span class="p">(</span><span class="n">ind</span><span class="p">)</span>             <span class="c">!# of outgoing nuclide l.</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-434" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-434'>#</a>
          </div>
          <p>..........COMPUTE DIFFERENT REACTION RATES.</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>          <span class="n">GO</span> <span class="n">TO</span> <span class="p">(</span><span class="mi">201</span><span class="p">,</span><span class="mi">202</span><span class="p">,</span><span class="mi">203</span><span class="p">,</span><span class="mi">204</span><span class="p">,</span><span class="mi">205</span><span class="p">,</span><span class="mi">206</span><span class="p">,</span><span class="mi">207</span><span class="p">,</span><span class="mi">208</span><span class="p">,</span><span class="mi">209</span><span class="p">,</span><span class="mi">210</span><span class="p">,</span><span class="mi">211</span><span class="p">),</span><span class="n">ind</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-435" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-435'>#</a>
          </div>
          
        </div>
        <div class='code'>
          <div class="highlight"><pre> <span class="mi">201</span>      <span class="k">CONTINUE</span>                 <span class="c">!1-0-0-1 configuration.</span>
            <span class="n">ci</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>              <span class="c">!(Ref 1).</span>
            <span class="n">cj</span> <span class="o">=</span> <span class="mf">0.</span>
            <span class="n">ck</span> <span class="o">=</span> <span class="mf">0.</span>
            <span class="n">cl</span> <span class="o">=</span> <span class="n">r</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
            <span class="n">GO</span> <span class="n">TO</span> <span class="mi">212</span>
 <span class="mi">202</span>      <span class="k">CONTINUE</span>                 <span class="c">!1-1-0-1 configuration.</span>
            <span class="n">r</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">=</span> <span class="n">rev</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="o">*</span><span class="mf">1.e+10</span><span class="o">*</span><span class="n">t932</span><span class="o">*</span><span class="n">ex</span><span class="p">(</span><span class="o">-</span><span class="n">q9</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="o">/</span><span class="n">t9</span><span class="p">)</span><span class="o">*</span><span class="n">f</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>  <span class="c">!(Ref 2).</span>
            <span class="n">f</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">=</span> <span class="n">rhob</span><span class="o">*</span><span class="n">f</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
            <span class="n">ci</span> <span class="o">=</span> <span class="n">y</span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="o">*</span><span class="n">f</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="o">/</span><span class="mf">2.</span>
            <span class="n">cj</span> <span class="o">=</span> <span class="n">y</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">*</span><span class="n">f</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="o">/</span><span class="mf">2.</span>
            <span class="n">ck</span> <span class="o">=</span> <span class="mf">0.</span>
            <span class="n">cl</span> <span class="o">=</span> <span class="n">r</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
            <span class="n">GO</span> <span class="n">TO</span> <span class="mi">212</span>
 <span class="mi">203</span>      <span class="k">CONTINUE</span>                 <span class="c">!1-1-1-1 configuration.</span>
            <span class="n">f</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">=</span> <span class="n">rhob</span><span class="o">*</span><span class="n">f</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
            <span class="n">r</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">=</span> <span class="n">rev</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="o">*</span><span class="n">ex</span><span class="p">(</span><span class="o">-</span><span class="n">q9</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="o">/</span><span class="n">t9</span><span class="p">)</span><span class="o">*</span><span class="n">f</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>  <span class="c">!(Ref 3).</span>
            <span class="n">ci</span> <span class="o">=</span> <span class="n">y</span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="o">*</span><span class="n">f</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="o">/</span><span class="mf">2.</span>
            <span class="n">cj</span> <span class="o">=</span> <span class="n">y</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">*</span><span class="n">f</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="o">/</span><span class="mf">2.</span>
            <span class="n">ck</span> <span class="o">=</span> <span class="n">y</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">*</span><span class="n">r</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="o">/</span><span class="mf">2.</span>
            <span class="n">cl</span> <span class="o">=</span> <span class="n">y</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">*</span><span class="n">r</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="o">/</span><span class="mf">2.</span>
            <span class="n">GO</span> <span class="n">TO</span> <span class="mi">212</span>
 <span class="mi">204</span>      <span class="k">CONTINUE</span>                 <span class="c">!1-0-0-2 configuration.</span>
            <span class="n">ci</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
            <span class="n">cj</span> <span class="o">=</span> <span class="mf">0.</span>
            <span class="n">ck</span> <span class="o">=</span> <span class="mf">0.</span>
            <span class="n">cl</span> <span class="o">=</span> <span class="n">y</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">*</span><span class="n">r</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="o">/</span><span class="mf">2.</span>
            <span class="n">GO</span> <span class="n">TO</span> <span class="mi">212</span>
 <span class="mi">205</span>      <span class="k">CONTINUE</span>                 <span class="c">!1-1-0-2 configuration.</span>
            <span class="n">f</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">=</span> <span class="n">rhob</span><span class="o">*</span><span class="n">f</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
            <span class="n">r</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">=</span> <span class="n">rev</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="o">*</span><span class="n">ex</span><span class="p">(</span><span class="o">-</span><span class="n">q9</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="o">/</span><span class="n">t9</span><span class="p">)</span><span class="o">*</span><span class="n">f</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>  <span class="c">!(Ref 3).</span>
            <span class="n">ci</span> <span class="o">=</span> <span class="n">y</span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="o">*</span><span class="n">f</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="o">/</span><span class="mf">2.</span>
            <span class="n">cj</span> <span class="o">=</span> <span class="n">y</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">*</span><span class="n">f</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="o">/</span><span class="mf">2.</span>
            <span class="n">ck</span> <span class="o">=</span> <span class="mf">0.</span>
            <span class="n">cl</span> <span class="o">=</span> <span class="n">y</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">*</span><span class="n">r</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="o">/</span><span class="mf">2.</span>
            <span class="n">GO</span> <span class="n">TO</span> <span class="mi">212</span>
 <span class="mi">206</span>      <span class="k">CONTINUE</span>                 <span class="c">!2-0-1-1 configuration.</span>
            <span class="n">f</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">=</span> <span class="n">rhob</span><span class="o">*</span><span class="n">f</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
            <span class="n">r</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">=</span> <span class="n">rev</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="o">*</span><span class="n">ex</span><span class="p">(</span><span class="o">-</span><span class="n">q9</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="o">/</span><span class="n">t9</span><span class="p">)</span><span class="o">*</span><span class="n">f</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>  <span class="c">!(Ref 3).</span>
            <span class="n">ci</span> <span class="o">=</span> <span class="n">y</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">*</span><span class="n">f</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="o">/</span><span class="mf">2.</span>
            <span class="n">cj</span> <span class="o">=</span> <span class="mf">0.</span>
            <span class="n">ck</span> <span class="o">=</span> <span class="n">y</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">*</span><span class="n">r</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="o">/</span><span class="mf">2.</span>
            <span class="n">cl</span> <span class="o">=</span> <span class="n">y</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">*</span><span class="n">r</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="o">/</span><span class="mf">2.</span>
            <span class="n">GO</span> <span class="n">TO</span> <span class="mi">212</span>
 <span class="mi">207</span>      <span class="k">CONTINUE</span>                 <span class="c">!3-0-0-1 configuration.</span>
            <span class="n">r</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">=</span> <span class="n">rev</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="o">*</span><span class="mf">1.e+20</span><span class="o">*</span><span class="n">t932</span><span class="o">*</span><span class="n">t932</span><span class="o">*</span><span class="n">ex</span><span class="p">(</span><span class="o">-</span><span class="n">q9</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="o">/</span><span class="n">t9</span><span class="p">)</span><span class="o">*</span><span class="n">f</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>  <span class="c">!(Ref 4).</span>
            <span class="n">f</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">=</span> <span class="n">rhob</span><span class="o">*</span><span class="n">rhob</span><span class="o">*</span><span class="n">f</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
            <span class="n">ci</span> <span class="o">=</span> <span class="n">y</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">*</span><span class="n">y</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">*</span><span class="n">f</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="o">/</span><span class="mf">6.</span>
            <span class="n">cj</span> <span class="o">=</span> <span class="mf">0.</span>
            <span class="n">ck</span> <span class="o">=</span> <span class="mf">0.</span>
            <span class="n">cl</span> <span class="o">=</span> <span class="n">r</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
            <span class="n">GO</span> <span class="n">TO</span> <span class="mi">212</span>
 <span class="mi">208</span>      <span class="k">CONTINUE</span>                 <span class="c">!2-1-0-1 configuration.</span>
            <span class="n">r</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">=</span> <span class="n">rev</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="o">*</span><span class="mf">1.e+20</span><span class="o">*</span><span class="n">t932</span><span class="o">*</span><span class="n">t932</span><span class="o">*</span><span class="n">ex</span><span class="p">(</span><span class="o">-</span><span class="n">q9</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="o">/</span><span class="n">t9</span><span class="p">)</span><span class="o">*</span><span class="n">f</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>  <span class="c">!(Ref 4).</span>
            <span class="n">f</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">=</span> <span class="n">rhob</span><span class="o">*</span><span class="n">rhob</span><span class="o">*</span><span class="n">f</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
            <span class="n">ci</span> <span class="o">=</span> <span class="n">y</span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="o">*</span><span class="n">y</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">*</span><span class="n">f</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="o">/</span><span class="mf">3.</span>
            <span class="n">cj</span> <span class="o">=</span> <span class="n">y</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">*</span><span class="n">y</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">*</span><span class="n">f</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="o">/</span><span class="mf">6.</span>
            <span class="n">ck</span> <span class="o">=</span> <span class="mf">0.</span>
            <span class="n">cl</span> <span class="o">=</span> <span class="n">r</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
            <span class="n">GO</span> <span class="n">TO</span> <span class="mi">212</span>
 <span class="mi">209</span>      <span class="k">CONTINUE</span>                 <span class="c">!1-1-1-2 configuration.</span>
            <span class="n">f</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">=</span> <span class="n">rhob</span><span class="o">*</span><span class="n">f</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
            <span class="n">r</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">=</span> <span class="n">rev</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="o">*</span><span class="mf">1.e-10</span><span class="o">*</span><span class="n">t9m32</span><span class="o">*</span><span class="n">rhob</span><span class="o">*</span><span class="n">ex</span><span class="p">(</span><span class="o">-</span><span class="n">q9</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="o">/</span><span class="n">t9</span><span class="p">)</span><span class="o">*</span><span class="n">f</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>  <span class="c">!(Ref 5).</span>
            <span class="n">ci</span> <span class="o">=</span> <span class="n">y</span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="o">*</span><span class="n">f</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="o">/</span><span class="mf">2.</span>
            <span class="n">cj</span> <span class="o">=</span> <span class="n">y</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">*</span><span class="n">f</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="o">/</span><span class="mf">2.</span>
            <span class="n">ck</span> <span class="o">=</span> <span class="n">y</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">*</span><span class="n">y</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">*</span><span class="n">r</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="o">/</span><span class="mf">6.</span>
            <span class="n">cl</span> <span class="o">=</span> <span class="n">y</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">*</span><span class="n">y</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">*</span><span class="n">r</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="o">/</span><span class="mf">3.</span>
            <span class="n">GO</span> <span class="n">TO</span> <span class="mi">212</span>
 <span class="mi">210</span>      <span class="k">CONTINUE</span>                 <span class="c">!1-1-0-3 configuration.</span>
            <span class="n">f</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">=</span> <span class="n">rhob</span><span class="o">*</span><span class="n">f</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
            <span class="n">r</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">=</span> <span class="n">rev</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="o">*</span><span class="mf">1.e-10</span><span class="o">*</span><span class="n">t9m32</span><span class="o">*</span><span class="n">rhob</span><span class="o">*</span><span class="n">ex</span><span class="p">(</span><span class="o">-</span><span class="n">q9</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="o">/</span><span class="n">t9</span><span class="p">)</span><span class="o">*</span><span class="n">f</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>  <span class="c">!(Ref 5).</span>
            <span class="n">ci</span> <span class="o">=</span> <span class="n">y</span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="o">*</span><span class="n">f</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="o">/</span><span class="mf">2.</span>
            <span class="n">cj</span> <span class="o">=</span> <span class="n">y</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">*</span><span class="n">f</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="o">/</span><span class="mf">2.</span>
            <span class="n">ck</span> <span class="o">=</span> <span class="mf">0.</span>
            <span class="n">cl</span> <span class="o">=</span> <span class="n">y</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">*</span><span class="n">y</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">*</span><span class="n">r</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="o">/</span><span class="mf">6.</span>
            <span class="n">GO</span> <span class="n">TO</span> <span class="mi">212</span>
 <span class="mi">211</span>      <span class="k">CONTINUE</span>                 <span class="c">!2-0-2-1 configuration.</span>
            <span class="n">f</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">=</span> <span class="n">rhob</span><span class="o">*</span><span class="n">f</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
            <span class="n">r</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">=</span> <span class="n">rev</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="o">*</span><span class="mf">1.e-10</span><span class="o">*</span><span class="n">t9m32</span><span class="o">*</span><span class="n">rhob</span><span class="o">*</span><span class="n">ex</span><span class="p">(</span><span class="o">-</span><span class="n">q9</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="o">/</span><span class="n">t9</span><span class="p">)</span><span class="o">*</span><span class="n">f</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>  <span class="c">!(Ref 5).</span>
            <span class="n">ci</span> <span class="o">=</span> <span class="n">y</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">*</span><span class="n">f</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="o">/</span><span class="mf">2.</span>
            <span class="n">cj</span> <span class="o">=</span> <span class="mf">0.</span>
            <span class="n">ck</span> <span class="o">=</span> <span class="n">y</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">*</span><span class="n">y</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">*</span><span class="n">r</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="o">/</span><span class="mf">3.</span>
            <span class="n">cl</span> <span class="o">=</span> <span class="n">y</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">*</span><span class="n">y</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">*</span><span class="n">r</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="o">/</span><span class="mf">6.</span>
 <span class="mi">212</span>      <span class="k">CONTINUE</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-436" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-436'>#</a>
          </div>
          <p>C30-----CONSTRUCT THE A-MATRIX--------------------------------</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>          <span class="n">i</span> <span class="o">=</span> <span class="n">isize1</span> <span class="o">-</span> <span class="n">i</span>           <span class="c">!Invert i index.</span>
          <span class="n">j</span> <span class="o">=</span> <span class="n">isize1</span> <span class="o">-</span> <span class="n">j</span>           <span class="c">!Invert j index.</span>
          <span class="n">k</span> <span class="o">=</span> <span class="n">isize1</span> <span class="o">-</span> <span class="n">k</span>           <span class="c">!Invert k index.</span>
          <span class="n">l</span> <span class="o">=</span> <span class="n">isize1</span> <span class="o">-</span> <span class="n">l</span>           <span class="c">!Invert l index.</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-437" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-437'>#</a>
          </div>
          <p>..........FILL I NUCLIDE COLUMN.</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>          <span class="k">IF</span> <span class="p">(</span><span class="n">j</span><span class="p">.</span><span class="n">le</span><span class="p">.</span><span class="n">isize</span><span class="p">)</span> <span class="n">a</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="n">i</span><span class="p">)</span> <span class="o">=</span> <span class="n">a</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span>  <span class="n">rj</span><span class="o">*</span><span class="n">ci</span>
          <span class="k">IF</span> <span class="p">(</span><span class="n">k</span><span class="p">.</span><span class="n">le</span><span class="p">.</span><span class="n">isize</span><span class="p">)</span> <span class="n">a</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="n">i</span><span class="p">)</span> <span class="o">=</span> <span class="n">a</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="n">i</span><span class="p">)</span> <span class="o">-</span>  <span class="n">rk</span><span class="o">*</span><span class="n">ci</span>
          <span class="n">a</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">i</span><span class="p">)</span> <span class="o">=</span> <span class="n">a</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span>  <span class="n">ri</span><span class="o">*</span><span class="n">ci</span>
          <span class="n">a</span><span class="p">(</span><span class="n">l</span><span class="p">,</span><span class="n">i</span><span class="p">)</span> <span class="o">=</span> <span class="n">a</span><span class="p">(</span><span class="n">l</span><span class="p">,</span><span class="n">i</span><span class="p">)</span> <span class="o">-</span>  <span class="n">rl</span><span class="o">*</span><span class="n">ci</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-438" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-438'>#</a>
          </div>
          <p>..........FILL J NUCLIDE COLUMN.</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>          <span class="k">IF</span> <span class="p">(</span><span class="n">j</span><span class="p">.</span><span class="n">le</span><span class="p">.</span><span class="n">isize</span><span class="p">)</span> <span class="k">THEN</span>
<span class="k">            </span><span class="n">a</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="n">j</span><span class="p">)</span> <span class="o">=</span> <span class="n">a</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="n">j</span><span class="p">)</span> <span class="o">+</span>  <span class="n">rj</span><span class="o">*</span><span class="n">cj</span>
            <span class="k">IF</span> <span class="p">(</span><span class="n">k</span><span class="p">.</span><span class="n">le</span><span class="p">.</span><span class="n">isize</span><span class="p">)</span> <span class="n">a</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="n">j</span><span class="p">)</span> <span class="o">=</span> <span class="n">a</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="n">j</span><span class="p">)</span> <span class="o">-</span>  <span class="n">rk</span><span class="o">*</span><span class="n">cj</span>
            <span class="n">a</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)</span> <span class="o">=</span> <span class="n">a</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)</span> <span class="o">+</span>  <span class="n">ri</span><span class="o">*</span><span class="n">cj</span>
            <span class="n">a</span><span class="p">(</span><span class="n">l</span><span class="p">,</span><span class="n">j</span><span class="p">)</span> <span class="o">=</span> <span class="n">a</span><span class="p">(</span><span class="n">l</span><span class="p">,</span><span class="n">j</span><span class="p">)</span> <span class="o">-</span>  <span class="n">rl</span><span class="o">*</span><span class="n">cj</span>
          <span class="k">END IF</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-439" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-439'>#</a>
          </div>
          <p>..........FILL K NUCLIDE COLUMN.</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>          <span class="k">IF</span> <span class="p">(</span><span class="n">k</span><span class="p">.</span><span class="n">le</span><span class="p">.</span><span class="n">isize</span><span class="p">)</span> <span class="k">THEN</span>
<span class="k">            IF</span> <span class="p">(</span><span class="n">j</span><span class="p">.</span><span class="n">le</span><span class="p">.</span><span class="n">isize</span><span class="p">)</span> <span class="n">a</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)</span> <span class="o">=</span> <span class="n">a</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)</span> <span class="o">-</span>  <span class="n">rj</span><span class="o">*</span><span class="n">ck</span>
            <span class="n">a</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="n">k</span><span class="p">)</span> <span class="o">=</span> <span class="n">a</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="n">k</span><span class="p">)</span> <span class="o">+</span>  <span class="n">rk</span><span class="o">*</span><span class="n">ck</span>
            <span class="n">a</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">k</span><span class="p">)</span> <span class="o">=</span> <span class="n">a</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">k</span><span class="p">)</span> <span class="o">-</span>  <span class="n">ri</span><span class="o">*</span><span class="n">ck</span>
            <span class="n">a</span><span class="p">(</span><span class="n">l</span><span class="p">,</span><span class="n">k</span><span class="p">)</span> <span class="o">=</span> <span class="n">a</span><span class="p">(</span><span class="n">l</span><span class="p">,</span><span class="n">k</span><span class="p">)</span> <span class="o">+</span>  <span class="n">rl</span><span class="o">*</span><span class="n">ck</span>
          <span class="k">END IF</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-440" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-440'>#</a>
          </div>
          <p>..........FILL L NUCLIDE COLUMN.</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>          <span class="k">IF</span> <span class="p">(</span><span class="n">j</span><span class="p">.</span><span class="n">le</span><span class="p">.</span><span class="n">isize</span><span class="p">)</span> <span class="n">a</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="n">l</span><span class="p">)</span> <span class="o">=</span> <span class="n">a</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="n">l</span><span class="p">)</span> <span class="o">-</span>  <span class="n">rj</span><span class="o">*</span><span class="n">cl</span>
          <span class="k">IF</span> <span class="p">(</span><span class="n">k</span><span class="p">.</span><span class="n">le</span><span class="p">.</span><span class="n">isize</span><span class="p">)</span> <span class="n">a</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="n">l</span><span class="p">)</span> <span class="o">=</span> <span class="n">a</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="n">l</span><span class="p">)</span> <span class="o">+</span>  <span class="n">rk</span><span class="o">*</span><span class="n">cl</span>
          <span class="n">a</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">l</span><span class="p">)</span> <span class="o">=</span> <span class="n">a</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">l</span><span class="p">)</span> <span class="o">-</span>  <span class="n">ri</span><span class="o">*</span><span class="n">cl</span>
          <span class="n">a</span><span class="p">(</span><span class="n">l</span><span class="p">,</span><span class="n">l</span><span class="p">)</span> <span class="o">=</span> <span class="n">a</span><span class="p">(</span><span class="n">l</span><span class="p">,</span><span class="n">l</span><span class="p">)</span> <span class="o">+</span>  <span class="n">rl</span><span class="o">*</span><span class="n">cl</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-441" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-441'>#</a>
          </div>
          
        </div>
        <div class='code'>
          <div class="highlight"><pre>        <span class="k">END IF</span> <span class="c">!((ind.ne.0).and.(i.le.isize).and.(l.le.isize))</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-442" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-442'>#</a>
          </div>
          
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="k">END DO</span> <span class="c">!n = 1,jsize</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-443" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-443'>#</a>
          </div>
          <p>C40-----PUT A-MATRIX AND B-VECTOR IN FINAL FORM OF MATRIX EQUATION--------</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="n">bdln</span>   <span class="o">=</span> <span class="mf">1.e-5</span><span class="o">*</span><span class="p">(</span><span class="mf">3.</span><span class="o">*</span><span class="n">hubcst</span><span class="p">)</span>   <span class="c">!(10**(-5))*(Expansion rate).</span>
      <span class="k">DO </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">isize</span>
        <span class="n">i1</span> <span class="o">=</span> <span class="n">isize1</span> <span class="o">-</span> <span class="n">i</span>            <span class="c">!Invert the rows.</span>
        <span class="k">DO </span><span class="n">j</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">isize</span>
          <span class="n">j1</span> <span class="o">=</span> <span class="n">isize1</span> <span class="o">-</span> <span class="n">j</span>          <span class="c">!Invert the columns.</span>
          <span class="k">IF</span> <span class="p">(</span><span class="nb">ABS</span><span class="p">(</span><span class="n">a</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="n">i</span><span class="p">)).</span><span class="n">lt</span><span class="p">.</span><span class="n">bdln</span><span class="o">*</span><span class="n">y0</span><span class="p">(</span><span class="n">j1</span><span class="p">)</span><span class="o">/</span><span class="n">y0</span><span class="p">(</span><span class="n">i1</span><span class="p">))</span> <span class="k">THEN</span>
<span class="k">            </span><span class="n">a</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="n">i</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.</span><span class="n">d0</span>          <span class="c">!Set 0 if tiny.</span>
          <span class="k">ELSE</span>
<span class="k">            </span><span class="n">a</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="n">i</span><span class="p">)</span> <span class="o">=</span> <span class="n">a</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="n">i</span><span class="p">)</span><span class="o">*</span><span class="n">dt</span>     <span class="c">!Bring dt over to other side.</span>
          <span class="k">END IF</span>
<span class="k">        END DO</span>
<span class="k">        </span><span class="n">a</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">i</span><span class="p">)</span> <span class="o">=</span> <span class="mf">1.</span><span class="n">d0</span> <span class="o">+</span> <span class="n">a</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">i</span><span class="p">)</span>     <span class="c">!Add identity matrix to a-matrix.</span>
        <span class="n">b</span><span class="p">(</span><span class="n">i1</span><span class="p">)</span>  <span class="o">=</span> <span class="n">y0</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>             <span class="c">!Initial abundances.</span>
      <span class="k">END DO</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-444" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-444'>#</a>
          </div>
          <p>C50-----SOLVE EQUATIONS TO GET DERIVATIVE------------------------</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-445" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-445'>#</a>
          </div>
          <p>C..........SET MONITOR FLAG AND SOLVE BY GAUSSIAN ELIMINATION.</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="k">IF</span> <span class="p">(</span><span class="n">loop</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="mi">1</span><span class="p">)</span> <span class="k">THEN</span>
<span class="k">        CALL </span><span class="n">eqslin</span><span class="p">(</span><span class="n">ip</span><span class="p">,</span><span class="n">ierror</span><span class="p">)</span>
      <span class="k">ELSE</span>
<span class="k">        CALL </span><span class="n">eqslin</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">ierror</span><span class="p">)</span>
      <span class="k">END IF</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-446" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-446'>#</a>
          </div>
          <p>..........OBTAIN DERIVATIVE.</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="k">DO </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">isize</span>
        <span class="n">yy</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>   <span class="o">=</span> <span class="n">yx</span><span class="p">(</span><span class="n">isize1</span><span class="o">-</span><span class="n">i</span><span class="p">)</span>     <span class="c">!Abundance at t+dt.</span>
        <span class="n">dydt</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="n">yy</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">-</span> <span class="n">y0</span><span class="p">(</span><span class="n">i</span><span class="p">))</span><span class="o">/</span><span class="n">dt</span>         <span class="c">!Take derivative.</span>
      <span class="k">END DO</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-447" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-447'>#</a>
          </div>
          <p>C60-----POSSIBLE ERROR MESSAGES AND EXIT-------------------------</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="k">IF</span> <span class="p">(</span><span class="n">mbad</span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span> <span class="k">THEN</span>          <span class="c">!Problem in gaussian elimination.</span>
        <span class="k">IF</span> <span class="p">(</span><span class="n">mbad</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="k">print </span><span class="mi">6000</span><span class="p">,</span> <span class="n">ierror</span> <span class="c">!Error message.</span>
        <span class="k">IF</span> <span class="p">(</span><span class="n">mbad</span><span class="p">.</span><span class="n">ge</span><span class="p">.</span> <span class="mi">1</span><span class="p">)</span> <span class="k">print </span><span class="mi">6002</span><span class="p">,</span> <span class="n">mbad</span>   <span class="c">!Error message.</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-448" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-448'>#</a>
          </div>
          
        </div>
        <div class='code'>
          <div class="highlight"><pre> <span class="mi">6000</span>   <span class="k">FORMAT</span> <span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="s1">&#39;** y(&#39;</span><span class="p">,</span> <span class="n">i2</span><span class="p">,</span> <span class="s1">&#39;) fails to converge **&#39;</span><span class="p">)</span>
 <span class="mi">6002</span>   <span class="k">FORMAT</span> <span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="s1">&#39;** &#39;</span><span class="p">,</span> <span class="n">i2</span><span class="p">,</span> <span class="s1">&#39; th diagonal term equals zero **&#39;</span><span class="p">)</span>
      <span class="k">END IF</span>
<span class="k">      RETURN</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-449" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-449'>#</a>
          </div>
          <p>C-------REFERENCES--------------------------------------</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-450" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-450'>#</a>
          </div>
          <p>1) The coefficients are given in general as:</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-451" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-451'>#</a>
          </div>
          <p>ci = ri<em>(y(j)<strong>rj)*(y(i)</strong>(ri-1)</em>f(n)/</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-452" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-452'>#</a>
          </div>
          <p>((ri+rj)<em>fac(ri)</em>fac(rj))</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-453" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-453'>#</a>
          </div>
          <p>cj = rj<em>(y(i)<strong>ri)*(y(j)</strong>(rj-1)</em>f(n)/</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-454" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-454'>#</a>
          </div>
          <p>((ri+rj)<em>fac(ri)</em>fac(rj))</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-455" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-455'>#</a>
          </div>
          <p>ck = rk<em>(y(l)<strong>rl)*(y(k)</strong>(rk-1)</em>f(n)/</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-456" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-456'>#</a>
          </div>
          <p>((rk+rl)<em>fac(rk)</em>fac(rl))</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-457" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-457'>#</a>
          </div>
          <p>cl = rl<em>(y(k)<strong>rk)*(y(l)</strong>(rl-1)</em>f(n)/</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-458" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-458'>#</a>
          </div>
          <p>((rk+rl)<em>fac(rk)</em>fac(rl))</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-459" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-459'>#</a>
          </div>
          <p>in which fac(x) is the factorial of x.</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-460" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-460'>#</a>
          </div>
          <p>2) Form of reverse rate given in</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-461" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-461'>#</a>
          </div>
          <p>Wagoner, R.V.,1969, Ap. J. Suppl. No. 162, 18, 247,</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-462" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-462'>#</a>
          </div>
          <p>tables 1B, 4B, 7B.</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-463" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-463'>#</a>
          </div>
          <p>3) Form of reverse rate given in</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-464" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-464'>#</a>
          </div>
          <p>Wagoner, R.V.,1969, Ap. J. Suppl. No. 162, 18, 247,</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-465" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-465'>#</a>
          </div>
          <p>tables 2B, 3B, 5B, 6B, 8B, 9B, 10B.</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-466" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-466'>#</a>
          </div>
          <p>4) Form of reverse rate given in</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-467" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-467'>#</a>
          </div>
          <p>Wagoner, R.V.,1969, Ap. J. Suppl. No. 162, 18, 247,</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-468" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-468'>#</a>
          </div>
          <p>table 11B.</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-469" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-469'>#</a>
          </div>
          <p>5) Form of reverse rate given in</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-470" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-470'>#</a>
          </div>
          <p>Wagoner, R.V.,1969, Ap. J. Suppl. No. 162, 18, 247,</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-471" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-471'>#</a>
          </div>
          <p>tables 12B, 13B.</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="k">END</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-472" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-472'>#</a>
          </div>
          <p>C===============IDENTIFICATION DIVISION====================</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="k">SUBROUTINE </span><span class="n">eqslin</span><span class="p">(</span><span class="n">icnvm</span><span class="p">,</span><span class="n">ierror</span><span class="p">)</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-473" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-473'>#</a>
          </div>
          <p>C-------LINKAGES.</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-474" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-474'>#</a>
          </div>
          <p>CALLED BY - [subroutine] sol</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-475" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-475'>#</a>
          </div>
          <p>CALLS     - none</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-476" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-476'>#</a>
          </div>
          <p>C-------REMARKS.</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-477" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-477'>#</a>
          </div>
          <p>Solves for new abundances using gaussian elimination</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-478" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-478'>#</a>
          </div>
          <p>with back substitution, no pivoting.</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="k">USE </span><span class="n">commons</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-479" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-479'>#</a>
          </div>
          <p>C-------COMMON AREAS.</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="k">COMMON</span> <span class="o">/</span><span class="n">compr</span><span class="o">/</span>  <span class="n">cy</span><span class="p">,</span><span class="n">ct</span><span class="p">,</span><span class="n">t9i</span><span class="p">,</span><span class="n">t9f</span><span class="p">,</span><span class="n">ytmin</span><span class="p">,</span><span class="n">inc</span>        <span class="c">!Computation parameters.</span>
      <span class="k">COMMON</span> <span class="o">/</span><span class="n">lncoef</span><span class="o">/</span> <span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">y</span>                          <span class="c">!Lin eqn coefficients.</span>
      <span class="k">COMMON</span> <span class="o">/</span><span class="n">flags</span><span class="o">/</span>  <span class="nb">ltime</span><span class="p">,</span><span class="k">is</span><span class="p">,</span><span class="n">ip</span><span class="p">,</span><span class="n">it</span><span class="p">,</span><span class="n">mbad</span>            <span class="c">!Flags, counters.</span>
      <span class="k">COMMON</span> <span class="o">/</span><span class="n">runopt</span><span class="o">/</span> <span class="n">irun</span><span class="p">,</span><span class="n">isize</span><span class="p">,</span><span class="n">jsize</span>               <span class="c">!Run options.</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-480" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-480'>#</a>
          </div>
          <p>C=================DECLARATION DIVISION=====================</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-481" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-481'>#</a>
          </div>
          <p>C-------COMPUTATION PARAMETER.</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="kt">INTEGER </span><span class="n">inc</span>                  <span class="c">!Accumulation increment.</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-482" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-482'>#</a>
          </div>
          <p>C-------MATRIX COEFFICIENTS FOR LINEAR EQUATION.</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="kt">DOUBLE PRECISION </span><span class="n">a</span><span class="p">(</span><span class="n">nnuc</span><span class="p">,</span><span class="n">nnuc</span><span class="p">)</span><span class="c">!Coefficient array.</span>
      <span class="kt">DOUBLE PRECISION    </span><span class="n">b</span><span class="p">(</span><span class="n">nnuc</span><span class="p">)</span>              <span class="c">!Right-hand vector w/o manipulation.</span>
      <span class="kt">DOUBLE PRECISION    </span><span class="n">y</span><span class="p">(</span><span class="n">nnuc</span><span class="p">)</span>              <span class="c">!Solution vector.</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-483" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-483'>#</a>
          </div>
          <p>C-------COUNTERS AND FLAGS.</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="kt">INTEGER </span><span class="n">mbad</span>                 <span class="c">!Indicates type of error.</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-484" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-484'>#</a>
          </div>
          <p>C-------RUN OPTION.</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="kt">INTEGER </span><span class="n">isize</span>                <span class="c">!Number of nuclides in computation.</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-485" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-485'>#</a>
          </div>
          <p>C-------LOCAL MATRICES AND VECTORS.</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="kt">DOUBLE PRECISION </span><span class="n">a0</span><span class="p">(</span><span class="n">nnuc</span><span class="p">,</span><span class="n">nnuc</span><span class="p">)</span><span class="c">!Coefficient array w/o manipulation.</span>
      <span class="kt">DOUBLE PRECISION </span><span class="n">x</span><span class="p">(</span><span class="n">nnuc</span><span class="p">)</span>     <span class="c">!Right-hand vector.</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-486" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-486'>#</a>
          </div>
          <p>C-------LOCAL COMPUTATION VARIABLES.</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="kt">DOUBLE PRECISION </span><span class="n">cx</span>          <span class="c">!Scaling factor in triangularization.</span>
      <span class="kt">DOUBLE PRECISION </span><span class="nb">sum</span>         <span class="c">!Sum for backsubstitution.</span>
      <span class="kt">DOUBLE PRECISION   </span><span class="n">xdy</span>                   <span class="c">!Relative error.</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-487" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-487'>#</a>
          </div>
          <p>C-------LOCAL COUNTERS.</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="kt">INTEGER </span><span class="n">nord</span>                 <span class="c">!Order of correction.</span>
      <span class="kt">INTEGER </span><span class="n">icnvm</span>                <span class="c">!Convergence monitor.</span>
      <span class="kt">INTEGER </span><span class="n">ierror</span>               <span class="c">!ith nuclide fails to converge.</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-488" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-488'>#</a>
          </div>
          <p>C==================PROCEDURE DIVISION======================</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-489" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-489'>#</a>
          </div>
          <p>C10-----INITIALIZE VECTOR----------------------------------</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-490" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-490'>#</a>
          </div>
          <p>C..........SET COUNTERS TO ZERO.</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="n">nord</span> <span class="o">=</span> <span class="mi">0</span>                     <span class="c">!No corrections yet.</span>
      <span class="n">mbad</span> <span class="o">=</span> <span class="mi">0</span>                     <span class="c">!No errors yet.</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-491" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-491'>#</a>
          </div>
          <p>..........SET RIGHT-HAND AND SOLUTION VECTORS TO INITIAL VALUES.</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="k">DO </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">isize</span>
        <span class="n">x</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">=</span> <span class="n">b</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>                <span class="c">!Right-hand vector.</span>
        <span class="n">y</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.</span>                  <span class="c">!Solution vector.</span>
      <span class="k">END DO</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-492" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-492'>#</a>
          </div>
          <p>..........SAVE MATRIX.</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="k">IF</span> <span class="p">(</span><span class="n">icnvm</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="n">inc</span><span class="p">)</span> <span class="k">THEN</span>       <span class="c">!Monitor convergence.</span>
        <span class="k">DO </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">isize</span>
          <span class="k">DO </span><span class="n">j</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">isize</span>
            <span class="n">a0</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="n">i</span><span class="p">)</span> <span class="o">=</span> <span class="n">a</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="n">i</span><span class="p">)</span>       <span class="c">!Initial value of coefficient array.</span>
          <span class="k">END DO</span>
<span class="k">        END DO</span>
<span class="k">      END IF</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-493" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-493'>#</a>
          </div>
          <p>C20-----TRIANGULARIZE MATRIX AND SAVE OPERATOR----------------------</p>
        </div>
        <div class='code'>
          
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-494" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-494'>#</a>
          </div>
          <p>C..........CHECK TO SEE THAT THERE ARE NO ZEROES AT PIVOT POINTS.</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="k">DO </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">isize</span><span class="o">-</span><span class="mi">1</span>
        <span class="k">IF</span> <span class="p">(</span><span class="n">a</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">i</span><span class="p">).</span><span class="n">eq</span><span class="p">.</span><span class="mf">0.</span><span class="n">d0</span><span class="p">)</span> <span class="k">THEN</span>   <span class="c">!Don&#39;t want to divide by zero.</span>
          <span class="n">mbad</span> <span class="o">=</span> <span class="n">i</span>                 <span class="c">!Position of zero coefficient.</span>
          <span class="k">RETURN</span>                   <span class="c">!Terminate matrix evaluation.</span>
        <span class="k">END IF</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-495" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-495'>#</a>
          </div>
          <p>..........TRIANGULARIZE MATRIX.</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>        <span class="k">DO </span><span class="n">j</span> <span class="o">=</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">isize</span>
          <span class="k">IF</span> <span class="p">(</span><span class="n">a</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="n">i</span><span class="p">).</span><span class="n">ne</span><span class="p">.</span><span class="mf">0.</span><span class="n">d0</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">!Progress diagonally down the column.</span>
            <span class="n">cx</span> <span class="o">=</span> <span class="n">a</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="n">i</span><span class="p">)</span><span class="o">/</span><span class="n">a</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">i</span><span class="p">)</span>     <span class="c">!Scaling factor down the column.</span>
            <span class="k">DO </span><span class="n">k</span> <span class="o">=</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">isize</span>       <span class="c">!Progress diagonally along row.</span>
              <span class="n">a</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)</span> <span class="o">=</span> <span class="n">a</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)</span> <span class="o">-</span> <span class="n">cx</span><span class="o">*</span><span class="n">a</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">k</span><span class="p">)</span>  <span class="c">!Subtract scaled coeff along row.</span>
            <span class="k">END DO</span>
<span class="k">            </span><span class="n">a</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="n">i</span><span class="p">)</span> <span class="o">=</span> <span class="n">cx</span>            <span class="c">!Scaled coefficient.</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-496" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-496'>#</a>
          </div>
          <p>..........OPERATE ON RIGHT-HAND VECTOR.</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>            <span class="n">x</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="o">=</span> <span class="n">x</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="o">-</span> <span class="n">cx</span><span class="o">*</span><span class="n">x</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>  <span class="c">!Subtract off scaled coefficient.</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-497" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-497'>#</a>
          </div>
          
        </div>
        <div class='code'>
          <div class="highlight"><pre>          <span class="k">END IF</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-498" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-498'>#</a>
          </div>
          
        </div>
        <div class='code'>
          <div class="highlight"><pre>        <span class="k">END DO</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-499" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-499'>#</a>
          </div>
          
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="k">END DO</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-500" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-500'>#</a>
          </div>
          <p>C30-----DO BACK SUBSTITUTION-------------------------------</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre> <span class="mi">300</span>  <span class="k">CONTINUE</span>
<span class="k">      </span><span class="n">x</span><span class="p">(</span><span class="n">isize</span><span class="p">)</span> <span class="o">=</span> <span class="n">x</span><span class="p">(</span><span class="n">isize</span><span class="p">)</span><span class="o">/</span><span class="n">a</span><span class="p">(</span><span class="n">isize</span><span class="p">,</span><span class="n">isize</span><span class="p">)</span>   <span class="c">!Solution for ultimate position.</span>
      <span class="n">y</span><span class="p">(</span><span class="n">isize</span><span class="p">)</span> <span class="o">=</span> <span class="n">y</span><span class="p">(</span><span class="n">isize</span><span class="p">)</span> <span class="o">+</span> <span class="n">x</span><span class="p">(</span><span class="n">isize</span><span class="p">)</span>
      <span class="k">DO </span><span class="n">i</span> <span class="o">=</span> <span class="n">isize</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span>          <span class="c">!From i = penultimate to i = 1.</span>
        <span class="nb">sum</span> <span class="o">=</span> <span class="mf">0.</span><span class="n">d0</span>
        <span class="k">DO </span><span class="n">j</span> <span class="o">=</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">isize</span>
          <span class="nb">sum</span> <span class="o">=</span> <span class="nb">sum</span> <span class="o">+</span> <span class="n">a</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)</span><span class="o">*</span><span class="n">x</span><span class="p">(</span><span class="n">j</span><span class="p">)</span>  <span class="c">!Sum up all previous terms.</span>
        <span class="k">END DO</span>
<span class="k">        </span><span class="n">x</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">-</span> <span class="nb">sum</span><span class="p">)</span><span class="o">/</span><span class="n">a</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">i</span><span class="p">)</span>
        <span class="n">y</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">=</span> <span class="n">y</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="n">x</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>         <span class="c">!Add difference to initial value.</span>
      <span class="k">END DO</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-501" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-501'>#</a>
          </div>
          <p>C40-----TESTS AND EXITS------------------------------------</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="k">IF</span> <span class="p">(</span><span class="n">icnvm</span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="n">inc</span><span class="p">)</span> <span class="k">THEN</span>
<span class="k">        DO </span><span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">isize</span>
          <span class="k">IF</span> <span class="p">(</span><span class="n">y</span><span class="p">(</span><span class="n">i</span><span class="p">).</span><span class="n">ne</span><span class="p">.</span><span class="mf">0.</span><span class="p">)</span> <span class="k">THEN</span>
<span class="k">            </span><span class="n">xdy</span> <span class="o">=</span> <span class="nb">ABS</span><span class="p">(</span><span class="n">x</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">/</span><span class="n">y</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>  <span class="c">!Relative error.</span>
            <span class="k">IF</span> <span class="p">(</span><span class="n">xdy</span><span class="p">.</span><span class="n">gt</span><span class="p">.</span><span class="n">eps</span><span class="p">)</span> <span class="k">THEN</span>
<span class="k">              IF</span> <span class="p">(</span><span class="n">nord</span><span class="p">.</span><span class="n">lt</span><span class="p">.</span><span class="n">mord</span><span class="p">)</span> <span class="k">THEN</span> <span class="c">!Continue to higher orders.</span>
                <span class="n">nord</span> <span class="o">=</span> <span class="n">nord</span> <span class="o">+</span> <span class="mi">1</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-502" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-502'>#</a>
          </div>
          <p>..........FIND ERROR IN RIGHT-HAND VECTOR.</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>                <span class="k">DO </span><span class="n">j</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">isize</span>
                  <span class="n">r</span> <span class="o">=</span> <span class="mf">0.</span><span class="n">d0</span>         <span class="c">!Initialize r.</span>
                  <span class="k">DO </span><span class="n">k</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">isize</span>
                    <span class="n">r</span> <span class="o">=</span> <span class="n">r</span> <span class="o">+</span> <span class="n">a0</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)</span><span class="o">*</span><span class="n">y</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="c">!Left side with approximate solution.</span>
                  <span class="k">END DO</span>
<span class="k">                  </span><span class="n">x</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="o">=</span> <span class="n">b</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="o">-</span> <span class="n">r</span>  <span class="c">!Subtract difference from right side.</span>
                <span class="k">END DO</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-503" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-503'>#</a>
          </div>
          <p>..........OPERATE ON RIGHT-HAND VECTOR.</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>                <span class="k">DO </span><span class="n">j</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">isize</span><span class="o">-</span><span class="mi">1</span>
                  <span class="k">DO </span><span class="n">k</span> <span class="o">=</span> <span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">isize</span>
                   <span class="n">x</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="o">=</span> <span class="n">x</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="o">-</span> <span class="n">a</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="n">j</span><span class="p">)</span><span class="o">*</span><span class="n">x</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="c">!Subtract off scaled coefficient.</span>
                  <span class="k">END DO</span>
<span class="k">                END DO</span>
<span class="k">                </span><span class="n">GO</span> <span class="n">TO</span> <span class="mi">300</span>       <span class="c">!Go for another iteratiion.</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-504" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-504'>#</a>
          </div>
          
        </div>
        <div class='code'>
          <div class="highlight"><pre>              <span class="k">ELSE</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-505" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-505'>#</a>
          </div>
          <p>..........NOT ENOUGH CONVERGENCE.</p>
        </div>
        <div class='code'>
          <div class="highlight"><pre>                <span class="n">mbad</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>          <span class="c">!Signal error problem.</span>
                <span class="n">ierror</span> <span class="o">=</span> <span class="n">i</span>         <span class="c">!ith nuclide for which x/y checked.</span>
                <span class="k">RETURN</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-506" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-506'>#</a>
          </div>
          
        </div>
        <div class='code'>
          <div class="highlight"><pre>              <span class="k">END IF</span> <span class="c">!(nord.lt.mord)</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-507" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-507'>#</a>
          </div>
          
        </div>
        <div class='code'>
          <div class="highlight"><pre>            <span class="k">END IF</span> <span class="c">!(xdy.gt.eps)</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-508" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-508'>#</a>
          </div>
          
        </div>
        <div class='code'>
          <div class="highlight"><pre>          <span class="k">END IF</span> <span class="c">!(y(i).ne.0)</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-509" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-509'>#</a>
          </div>
          
        </div>
        <div class='code'>
          <div class="highlight"><pre>        <span class="k">END DO</span> <span class="c">!i = 1,isize</span></pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
    <div class='section'>
    <a id="section-510" class="section-anchor"></a>
    <section>
        <div class='docs'>
          <div class='octowrap'>
            <a class='octothorpe' href='#section-510'>#</a>
          </div>
          
        </div>
        <div class='code'>
          <div class="highlight"><pre>      <span class="k">END IF</span> <span class="c">!(icnvm.eq.inc)</span>
      <span class="k">RETURN</span>                       <span class="c">!No more iterations &amp; relative error small.</span>

      <span class="k">END</span>

</pre></div>
        </div>
        <div class='clearall'></div>
    </section>
    </div>
  </div>
</body>
