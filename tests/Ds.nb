(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 8.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[     76939,       2071]
NotebookOptionsPosition[     75345,       2020]
NotebookOutlinePosition[     75778,       2037]
CellTagsIndexPosition[     75735,       2034]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{"\"\<D-functions are according to hep-ph/9703315 and coincide with \
those of Julien's thesis (if we replace all the s_i with 1 in the \
latter)\>\"", ";"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"D1", "[", 
    RowBox[{"x1_", ",", "x2_", ",", "x3_", ",", "x4_"}], "]"}], "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"4", "/", "Pi"}], ")"}], 
    RowBox[{"Integrate", "[", "  ", 
     RowBox[{
      RowBox[{
       RowBox[{"A", "^", 
        RowBox[{"(", 
         RowBox[{"-", "2"}], ")"}]}], "  ", 
       RowBox[{"Sin", "[", 
        RowBox[{"x1", " ", "A"}], "]"}], "  ", 
       RowBox[{"Sin", "[", 
        RowBox[{"x2", " ", "A"}], "]"}], "  ", 
       RowBox[{"Sin", " ", "[", 
        RowBox[{"x3", "  ", "A"}], "]"}], " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"x4", " ", "A"}], "]"}]}], " ", ",", 
      RowBox[{"{", 
       RowBox[{"A", ",", "0", ",", "Infinity"}], "}"}], ",", 
      RowBox[{"Assumptions", "\[Rule]", " ", 
       RowBox[{
        RowBox[{"x1", "\[Element]", "Reals"}], "&&", 
        RowBox[{"x2", "\[Element]", "Reals"}], "&&", 
        RowBox[{"x3", "\[Element]", "Reals"}], "&&", 
        RowBox[{"x4", "\[Element]", "Reals"}]}]}]}], "]"}]}]}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Plot3D", "[", 
    RowBox[{
     RowBox[{"D1", "[", 
      RowBox[{"x1", ",", "x2", ",", "1", ",", "1"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"x1", ",", 
       RowBox[{"-", "2"}], ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"x2", ",", 
       RowBox[{"-", "2"}], ",", "2"}], "}"}]}], "]"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"D2", "[", 
    RowBox[{"x1_", ",", "x2_", ",", "x3_", ",", "x4_"}], "]"}], "=", " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"4", "/", "Pi"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{"x3", " ", "x4"}], ")"}], " ", 
    RowBox[{"Integrate", "[", "  ", 
     RowBox[{
      RowBox[{
       RowBox[{"A", "^", 
        RowBox[{"(", 
         RowBox[{"-", "2"}], ")"}]}], "  ", 
       RowBox[{"Sin", "[", 
        RowBox[{"x1", " ", "A"}], "]"}], " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"x2", " ", "A"}], "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{"x3", " ", "A"}], "]"}], "-", " ", 
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"x3", " ", "A"}], "]"}], "/", " ", 
          RowBox[{"(", 
           RowBox[{"x3", " ", "A"}], ")"}]}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{"x4", " ", "A"}], "]"}], "-", " ", 
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"x4", " ", "A"}], "]"}], "/", " ", 
          RowBox[{"(", 
           RowBox[{"x4", " ", "A"}], ")"}]}]}], ")"}]}], " ", ",", 
      RowBox[{"{", 
       RowBox[{"A", ",", "0", ",", "Infinity"}], "}"}], ",", 
      RowBox[{"Assumptions", "\[Rule]", " ", 
       RowBox[{
        RowBox[{"x1", "\[Element]", "Reals"}], "&&", 
        RowBox[{"x2", "\[Element]", "Reals"}], "&&", 
        RowBox[{"x3", "\[Element]", "Reals"}], "&&", 
        RowBox[{"x4", "\[Element]", "Reals"}]}]}]}], "]"}]}]}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Plot3D", "[", 
    RowBox[{
     RowBox[{"D2", "[", 
      RowBox[{"x1", ",", "x2", ",", "1", ",", "1"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"x1", ",", 
       RowBox[{"-", "2"}], ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"x2", ",", 
       RowBox[{"-", "2"}], ",", "2"}], "}"}]}], "]"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
  "\"\<Dont know why this direct way of calculation is so time-consuming\>\"",
    ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"D3", "[", 
       RowBox[{"x1_", ",", "x2_", ",", "x3_", ",", "x4_"}], "]"}], "=", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"4", "/", "Pi"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"x1", " ", "x2", " ", "x3", " ", "x4"}], ")"}], " ", 
       RowBox[{"Integrate", "[", "  ", 
        RowBox[{
         RowBox[{
          RowBox[{"A", "^", 
           RowBox[{"(", 
            RowBox[{"-", "2"}], ")"}]}], "  ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"x1", " ", "A"}], "]"}], "-", " ", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"x1", " ", "A"}], "]"}], "/", " ", 
             RowBox[{"(", 
              RowBox[{"x1", " ", "A"}], ")"}]}]}], ")"}], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"x2", " ", "A"}], "]"}], "-", " ", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"x2", " ", "A"}], "]"}], "/", " ", 
             RowBox[{"(", 
              RowBox[{"x2", " ", "A"}], ")"}]}]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"x3", " ", "A"}], "]"}], "-", " ", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"x3", " ", "A"}], "]"}], "/", " ", 
             RowBox[{"(", 
              RowBox[{"x3", " ", "A"}], ")"}]}]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"x4", " ", "A"}], "]"}], "-", " ", 
            RowBox[{
             RowBox[{"Sin", "[", 
              RowBox[{"x4", " ", "A"}], "]"}], "/", " ", 
             RowBox[{"(", 
              RowBox[{"x4", " ", "A"}], ")"}]}]}], ")"}]}], " ", ",", 
         RowBox[{"{", 
          RowBox[{"A", ",", "0", ",", "Infinity"}], "}"}]}], "]"}]}]}], ",", 
     RowBox[{"Assumptions", "\[Rule]", " ", 
      RowBox[{
       RowBox[{"x1", "\[Element]", "Reals"}], "&&", 
       RowBox[{"x2", "\[Element]", "Reals"}], "&&", 
       RowBox[{"x3", "\[Element]", "Reals"}], "&&", 
       RowBox[{"x4", "\[Element]", "Reals"}]}]}]}], "]"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"\"\<So I use the answer from the Oleg's file that seem to plot the \
same result\>\"", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"D3", "[", 
    RowBox[{"x1_", ",", "x2_", ",", "x3_", ",", "x4_"}], "]"}], "=", 
   RowBox[{
    RowBox[{"1", "/", "480"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{
        RowBox[{"Abs", "[", 
         RowBox[{"x1", "+", "x2", "-", "x3", "-", "x4"}], "]"}], "^", "5"}]}],
       "-", 
      RowBox[{
       RowBox[{"Abs", "[", 
        RowBox[{"x1", "-", "x2", "+", "x3", "-", "x4"}], "]"}], "^", "5"}], 
      "+", 
      RowBox[{
       RowBox[{"Abs", "[", 
        RowBox[{"x1", "+", "x2", "+", "x3", "-", "x4"}], "]"}], "^", "5"}], 
      "-", 
      RowBox[{
       RowBox[{"Abs", "[", 
        RowBox[{"x1", "-", "x2", "-", "x3", "+", "x4"}], "]"}], "^", "5"}], 
      "+", 
      RowBox[{
       RowBox[{"Abs", "[", 
        RowBox[{"x1", "+", "x2", "-", "x3", "+", "x4"}], "]"}], "^", "5"}], 
      "+", 
      RowBox[{
       RowBox[{"Abs", "[", 
        RowBox[{"x1", "-", "x2", "+", "x3", "+", "x4"}], "]"}], "^", "5"}], 
      "+", 
      RowBox[{
       RowBox[{"Abs", "[", 
        RowBox[{
         RowBox[{"-", "x1"}], "+", "x2", "+", "x3", "+", "x4"}], "]"}], "^", 
       "5"}], "-", 
      RowBox[{
       RowBox[{"Abs", "[", 
        RowBox[{"x1", "+", "x2", "+", "x3", "+", "x4"}], "]"}], "^", "5"}], 
      "-", 
      RowBox[{"120", " ", "x1", " ", "x2", " ", "x3", " ", "x4", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Abs", "[", 
          RowBox[{"x1", "+", "x2", "-", "x3", "-", "x4"}], "]"}], "+", 
         RowBox[{"Abs", "[", 
          RowBox[{"x1", "-", "x2", "+", "x3", "-", "x4"}], "]"}], "+", 
         RowBox[{"Abs", "[", 
          RowBox[{"x1", "+", "x2", "+", "x3", "-", "x4"}], "]"}], "+", 
         RowBox[{"Abs", "[", 
          RowBox[{"x1", "-", "x2", "-", "x3", "+", "x4"}], "]"}], "+", 
         RowBox[{"Abs", "[", 
          RowBox[{"x1", "+", "x2", "-", "x3", "+", "x4"}], "]"}], "+", 
         RowBox[{"Abs", "[", 
          RowBox[{"x1", "-", "x2", "+", "x3", "+", "x4"}], "]"}], "+", 
         RowBox[{"Abs", "[", 
          RowBox[{
           RowBox[{"-", "x1"}], "+", "x2", "+", "x3", "+", "x4"}], "]"}], "+", 
         RowBox[{"Abs", "[", 
          RowBox[{"x1", "+", "x2", "+", "x3", "+", "x4"}], "]"}]}], ")"}]}], 
      "+", 
      RowBox[{"20", " ", "x1", " ", "x2", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", 
          RowBox[{
           RowBox[{"Abs", "[", 
            RowBox[{"x1", "+", "x2", "-", "x3", "-", "x4"}], "]"}], "^", 
           "3"}]}], "+", 
         RowBox[{
          RowBox[{"Abs", "[", 
           RowBox[{"x1", "-", "x2", "+", "x3", "-", "x4"}], "]"}], "^", "3"}],
          "+", 
         RowBox[{
          RowBox[{"Abs", "[", 
           RowBox[{"x1", "+", "x2", "+", "x3", "-", "x4"}], "]"}], "^", "3"}],
          "+", 
         RowBox[{
          RowBox[{"Abs", "[", 
           RowBox[{"x1", "-", "x2", "-", "x3", "+", "x4"}], "]"}], "^", "3"}],
          "+", 
         RowBox[{
          RowBox[{"Abs", "[", 
           RowBox[{"x1", "+", "x2", "-", "x3", "+", "x4"}], "]"}], "^", "3"}],
          "-", 
         RowBox[{
          RowBox[{"Abs", "[", 
           RowBox[{"x1", "-", "x2", "+", "x3", "+", "x4"}], "]"}], "^", "3"}],
          "-", 
         RowBox[{
          RowBox[{"Abs", "[", 
           RowBox[{
            RowBox[{"-", "x1"}], "+", "x2", "+", "x3", "+", "x4"}], "]"}], 
          "^", "3"}], "-", 
         RowBox[{
          RowBox[{"Abs", "[", 
           RowBox[{"x1", "+", "x2", "+", "x3", "+", "x4"}], "]"}], "^", 
          "3"}]}], ")"}]}], "+", 
      RowBox[{"20", " ", "x1", " ", "x3", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Abs", "[", 
           RowBox[{"x1", "+", "x2", "-", "x3", "-", "x4"}], "]"}], "^", "3"}],
          "-", 
         RowBox[{
          RowBox[{"Abs", "[", 
           RowBox[{"x1", "-", "x2", "+", "x3", "-", "x4"}], "]"}], "^", "3"}],
          "+", 
         RowBox[{
          RowBox[{"Abs", "[", 
           RowBox[{"x1", "+", "x2", "+", "x3", "-", "x4"}], "]"}], "^", "3"}],
          "+", 
         RowBox[{
          RowBox[{"Abs", "[", 
           RowBox[{"x1", "-", "x2", "-", "x3", "+", "x4"}], "]"}], "^", "3"}],
          "-", 
         RowBox[{
          RowBox[{"Abs", "[", 
           RowBox[{"x1", "+", "x2", "-", "x3", "+", "x4"}], "]"}], "^", "3"}],
          "+", 
         RowBox[{
          RowBox[{"Abs", "[", 
           RowBox[{"x1", "-", "x2", "+", "x3", "+", "x4"}], "]"}], "^", "3"}],
          "-", 
         RowBox[{
          RowBox[{"Abs", "[", 
           RowBox[{
            RowBox[{"-", "x1"}], "+", "x2", "+", "x3", "+", "x4"}], "]"}], 
          "^", "3"}], "-", 
         RowBox[{
          RowBox[{"Abs", "[", 
           RowBox[{"x1", "+", "x2", "+", "x3", "+", "x4"}], "]"}], "^", 
          "3"}]}], ")"}]}], "+", 
      RowBox[{"20", " ", "x1", " ", "x4", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Abs", "[", 
           RowBox[{"x1", "+", "x2", "-", "x3", "-", "x4"}], "]"}], "^", "3"}],
          "+", 
         RowBox[{
          RowBox[{"Abs", "[", 
           RowBox[{"x1", "-", "x2", "+", "x3", "-", "x4"}], "]"}], "^", "3"}],
          "-", 
         RowBox[{
          RowBox[{"Abs", "[", 
           RowBox[{"x1", "+", "x2", "+", "x3", "-", "x4"}], "]"}], "^", "3"}],
          "-", 
         RowBox[{
          RowBox[{"Abs", "[", 
           RowBox[{"x1", "-", "x2", "-", "x3", "+", "x4"}], "]"}], "^", "3"}],
          "+", 
         RowBox[{
          RowBox[{"Abs", "[", 
           RowBox[{"x1", "+", "x2", "-", "x3", "+", "x4"}], "]"}], "^", "3"}],
          "+", 
         RowBox[{
          RowBox[{"Abs", "[", 
           RowBox[{"x1", "-", "x2", "+", "x3", "+", "x4"}], "]"}], "^", "3"}],
          "-", 
         RowBox[{
          RowBox[{"Abs", "[", 
           RowBox[{
            RowBox[{"-", "x1"}], "+", "x2", "+", "x3", "+", "x4"}], "]"}], 
          "^", "3"}], "-", 
         RowBox[{
          RowBox[{"Abs", "[", 
           RowBox[{"x1", "+", "x2", "+", "x3", "+", "x4"}], "]"}], "^", 
          "3"}]}], ")"}]}], "+", 
      RowBox[{"20", " ", "x2", " ", "x3", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Abs", "[", 
           RowBox[{"x1", "+", "x2", "-", "x3", "-", "x4"}], "]"}], "^", "3"}],
          "+", 
         RowBox[{
          RowBox[{"Abs", "[", 
           RowBox[{"x1", "-", "x2", "+", "x3", "-", "x4"}], "]"}], "^", "3"}],
          "+", 
         RowBox[{
          RowBox[{"Abs", "[", 
           RowBox[{"x1", "+", "x2", "+", "x3", "-", "x4"}], "]"}], "^", "3"}],
          "-", 
         RowBox[{
          RowBox[{"Abs", "[", 
           RowBox[{"x1", "-", "x2", "-", "x3", "+", "x4"}], "]"}], "^", "3"}],
          "-", 
         RowBox[{
          RowBox[{"Abs", "[", 
           RowBox[{"x1", "+", "x2", "-", "x3", "+", "x4"}], "]"}], "^", "3"}],
          "-", 
         RowBox[{
          RowBox[{"Abs", "[", 
           RowBox[{"x1", "-", "x2", "+", "x3", "+", "x4"}], "]"}], "^", "3"}],
          "+", 
         RowBox[{
          RowBox[{"Abs", "[", 
           RowBox[{
            RowBox[{"-", "x1"}], "+", "x2", "+", "x3", "+", "x4"}], "]"}], 
          "^", "3"}], "-", 
         RowBox[{
          RowBox[{"Abs", "[", 
           RowBox[{"x1", "+", "x2", "+", "x3", "+", "x4"}], "]"}], "^", 
          "3"}]}], ")"}]}], "+", 
      RowBox[{"20", " ", "x2", " ", "x4", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Abs", "[", 
           RowBox[{"x1", "+", "x2", "-", "x3", "-", "x4"}], "]"}], "^", "3"}],
          "-", 
         RowBox[{
          RowBox[{"Abs", "[", 
           RowBox[{"x1", "-", "x2", "+", "x3", "-", "x4"}], "]"}], "^", "3"}],
          "-", 
         RowBox[{
          RowBox[{"Abs", "[", 
           RowBox[{"x1", "+", "x2", "+", "x3", "-", "x4"}], "]"}], "^", "3"}],
          "+", 
         RowBox[{
          RowBox[{"Abs", "[", 
           RowBox[{"x1", "-", "x2", "-", "x3", "+", "x4"}], "]"}], "^", "3"}],
          "+", 
         RowBox[{
          RowBox[{"Abs", "[", 
           RowBox[{"x1", "+", "x2", "-", "x3", "+", "x4"}], "]"}], "^", "3"}],
          "-", 
         RowBox[{
          RowBox[{"Abs", "[", 
           RowBox[{"x1", "-", "x2", "+", "x3", "+", "x4"}], "]"}], "^", "3"}],
          "+", 
         RowBox[{
          RowBox[{"Abs", "[", 
           RowBox[{
            RowBox[{"-", "x1"}], "+", "x2", "+", "x3", "+", "x4"}], "]"}], 
          "^", "3"}], "-", 
         RowBox[{
          RowBox[{"Abs", "[", 
           RowBox[{"x1", "+", "x2", "+", "x3", "+", "x4"}], "]"}], "^", 
          "3"}]}], ")"}]}], "+", 
      RowBox[{"20", " ", "x3", " ", "x4", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", 
          RowBox[{
           RowBox[{"Abs", "[", 
            RowBox[{"x1", "+", "x2", "-", "x3", "-", "x4"}], "]"}], "^", 
           "3"}]}], "+", 
         RowBox[{
          RowBox[{"Abs", "[", 
           RowBox[{"x1", "-", "x2", "+", "x3", "-", "x4"}], "]"}], "^", "3"}],
          "-", 
         RowBox[{
          RowBox[{"Abs", "[", 
           RowBox[{"x1", "+", "x2", "+", "x3", "-", "x4"}], "]"}], "^", "3"}],
          "+", 
         RowBox[{
          RowBox[{"Abs", "[", 
           RowBox[{"x1", "-", "x2", "-", "x3", "+", "x4"}], "]"}], "^", "3"}],
          "-", 
         RowBox[{
          RowBox[{"Abs", "[", 
           RowBox[{"x1", "+", "x2", "-", "x3", "+", "x4"}], "]"}], "^", "3"}],
          "+", 
         RowBox[{
          RowBox[{"Abs", "[", 
           RowBox[{"x1", "-", "x2", "+", "x3", "+", "x4"}], "]"}], "^", "3"}],
          "+", 
         RowBox[{
          RowBox[{"Abs", "[", 
           RowBox[{
            RowBox[{"-", "x1"}], "+", "x2", "+", "x3", "+", "x4"}], "]"}], 
          "^", "3"}], "-", 
         RowBox[{
          RowBox[{"Abs", "[", 
           RowBox[{"x1", "+", "x2", "+", "x3", "+", "x4"}], "]"}], "^", 
          "3"}]}], ")"}]}], "-", 
      RowBox[{"60", " ", "x2", " ", "x3", " ", "x4", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "x1"}], "+", "x2", "+", "x3", "+", "x4"}], ")"}], 
            "^", "2"}]}], " ", 
          RowBox[{"Sign", "[", 
           RowBox[{"x1", "-", "x2", "-", "x3", "-", "x4"}], "]"}]}], "-", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"x1", "+", "x2", "-", "x3", "-", "x4"}], ")"}], "^", 
           "2"}], " ", 
          RowBox[{"Sign", "[", 
           RowBox[{"x1", "+", "x2", "-", "x3", "-", "x4"}], "]"}]}], "-", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"x1", "-", "x2", "+", "x3", "-", "x4"}], ")"}], "^", 
           "2"}], " ", 
          RowBox[{"Sign", "[", 
           RowBox[{"x1", "-", "x2", "+", "x3", "-", "x4"}], "]"}]}], "-", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"x1", "+", "x2", "+", "x3", "-", "x4"}], ")"}], "^", 
           "2"}], " ", 
          RowBox[{"Sign", "[", 
           RowBox[{"x1", "+", "x2", "+", "x3", "-", "x4"}], "]"}]}], "-", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"x1", "-", "x2", "-", "x3", "+", "x4"}], ")"}], "^", 
           "2"}], " ", 
          RowBox[{"Sign", "[", 
           RowBox[{"x1", "-", "x2", "-", "x3", "+", "x4"}], "]"}]}], "-", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"x1", "+", "x2", "-", "x3", "+", "x4"}], ")"}], "^", 
           "2"}], " ", 
          RowBox[{"Sign", "[", 
           RowBox[{"x1", "+", "x2", "-", "x3", "+", "x4"}], "]"}]}], "-", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"x1", "-", "x2", "+", "x3", "+", "x4"}], ")"}], "^", 
           "2"}], " ", 
          RowBox[{"Sign", "[", 
           RowBox[{"x1", "-", "x2", "+", "x3", "+", "x4"}], "]"}]}], "-", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"x1", "+", "x2", "+", "x3", "+", "x4"}], ")"}], "^", 
           "2"}], " ", 
          RowBox[{"Sign", "[", 
           RowBox[{"x1", "+", "x2", "+", "x3", "+", "x4"}], "]"}]}]}], 
        ")"}]}], "-", 
      RowBox[{"60", " ", "x1", " ", "x2", " ", "x3", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "x1"}], "+", "x2", "+", "x3", "+", "x4"}], ")"}], 
           "^", "2"}], " ", 
          RowBox[{"Sign", "[", 
           RowBox[{"x1", "-", "x2", "-", "x3", "-", "x4"}], "]"}]}], "+", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"x1", "+", "x2", "-", "x3", "-", "x4"}], ")"}], "^", 
           "2"}], " ", 
          RowBox[{"Sign", "[", 
           RowBox[{"x1", "+", "x2", "-", "x3", "-", "x4"}], "]"}]}], "+", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"x1", "-", "x2", "+", "x3", "-", "x4"}], ")"}], "^", 
           "2"}], " ", 
          RowBox[{"Sign", "[", 
           RowBox[{"x1", "-", "x2", "+", "x3", "-", "x4"}], "]"}]}], "+", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"x1", "+", "x2", "+", "x3", "-", "x4"}], ")"}], "^", 
           "2"}], " ", 
          RowBox[{"Sign", "[", 
           RowBox[{"x1", "+", "x2", "+", "x3", "-", "x4"}], "]"}]}], "-", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"x1", "-", "x2", "-", "x3", "+", "x4"}], ")"}], "^", 
           "2"}], " ", 
          RowBox[{"Sign", "[", 
           RowBox[{"x1", "-", "x2", "-", "x3", "+", "x4"}], "]"}]}], "-", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"x1", "+", "x2", "-", "x3", "+", "x4"}], ")"}], "^", 
           "2"}], " ", 
          RowBox[{"Sign", "[", 
           RowBox[{"x1", "+", "x2", "-", "x3", "+", "x4"}], "]"}]}], "-", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"x1", "-", "x2", "+", "x3", "+", "x4"}], ")"}], "^", 
           "2"}], " ", 
          RowBox[{"Sign", "[", 
           RowBox[{"x1", "-", "x2", "+", "x3", "+", "x4"}], "]"}]}], "-", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"x1", "+", "x2", "+", "x3", "+", "x4"}], ")"}], "^", 
           "2"}], " ", 
          RowBox[{"Sign", "[", 
           RowBox[{"x1", "+", "x2", "+", "x3", "+", "x4"}], "]"}]}]}], 
        ")"}]}], "-", 
      RowBox[{"60", " ", "x1", " ", "x2", " ", "x4", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "x1"}], "+", "x2", "+", "x3", "+", "x4"}], ")"}], 
           "^", "2"}], " ", 
          RowBox[{"Sign", "[", 
           RowBox[{"x1", "-", "x2", "-", "x3", "-", "x4"}], "]"}]}], "+", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"x1", "+", "x2", "-", "x3", "-", "x4"}], ")"}], "^", 
           "2"}], " ", 
          RowBox[{"Sign", "[", 
           RowBox[{"x1", "+", "x2", "-", "x3", "-", "x4"}], "]"}]}], "-", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"x1", "-", "x2", "+", "x3", "-", "x4"}], ")"}], "^", 
           "2"}], " ", 
          RowBox[{"Sign", "[", 
           RowBox[{"x1", "-", "x2", "+", "x3", "-", "x4"}], "]"}]}], "-", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"x1", "+", "x2", "+", "x3", "-", "x4"}], ")"}], "^", 
           "2"}], " ", 
          RowBox[{"Sign", "[", 
           RowBox[{"x1", "+", "x2", "+", "x3", "-", "x4"}], "]"}]}], "+", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"x1", "-", "x2", "-", "x3", "+", "x4"}], ")"}], "^", 
           "2"}], " ", 
          RowBox[{"Sign", "[", 
           RowBox[{"x1", "-", "x2", "-", "x3", "+", "x4"}], "]"}]}], "+", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"x1", "+", "x2", "-", "x3", "+", "x4"}], ")"}], "^", 
           "2"}], " ", 
          RowBox[{"Sign", "[", 
           RowBox[{"x1", "+", "x2", "-", "x3", "+", "x4"}], "]"}]}], "-", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"x1", "-", "x2", "+", "x3", "+", "x4"}], ")"}], "^", 
           "2"}], " ", 
          RowBox[{"Sign", "[", 
           RowBox[{"x1", "-", "x2", "+", "x3", "+", "x4"}], "]"}]}], "-", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"x1", "+", "x2", "+", "x3", "+", "x4"}], ")"}], "^", 
           "2"}], " ", 
          RowBox[{"Sign", "[", 
           RowBox[{"x1", "+", "x2", "+", "x3", "+", "x4"}], "]"}]}]}], 
        ")"}]}], "-", 
      RowBox[{"60", " ", "x1", " ", "x3", " ", "x4", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "x1"}], "+", "x2", "+", "x3", "+", "x4"}], ")"}], 
           "^", "2"}], " ", 
          RowBox[{"Sign", "[", 
           RowBox[{"x1", "-", "x2", "-", "x3", "-", "x4"}], "]"}]}], "-", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"x1", "+", "x2", "-", "x3", "-", "x4"}], ")"}], "^", 
           "2"}], " ", 
          RowBox[{"Sign", "[", 
           RowBox[{"x1", "+", "x2", "-", "x3", "-", "x4"}], "]"}]}], "+", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"x1", "-", "x2", "+", "x3", "-", "x4"}], ")"}], "^", 
           "2"}], " ", 
          RowBox[{"Sign", "[", 
           RowBox[{"x1", "-", "x2", "+", "x3", "-", "x4"}], "]"}]}], "-", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"x1", "+", "x2", "+", "x3", "-", "x4"}], ")"}], "^", 
           "2"}], " ", 
          RowBox[{"Sign", "[", 
           RowBox[{"x1", "+", "x2", "+", "x3", "-", "x4"}], "]"}]}], "+", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"x1", "-", "x2", "-", "x3", "+", "x4"}], ")"}], "^", 
           "2"}], " ", 
          RowBox[{"Sign", "[", 
           RowBox[{"x1", "-", "x2", "-", "x3", "+", "x4"}], "]"}]}], "-", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"x1", "+", "x2", "-", "x3", "+", "x4"}], ")"}], "^", 
           "2"}], " ", 
          RowBox[{"Sign", "[", 
           RowBox[{"x1", "+", "x2", "-", "x3", "+", "x4"}], "]"}]}], "+", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"x1", "-", "x2", "+", "x3", "+", "x4"}], ")"}], "^", 
           "2"}], " ", 
          RowBox[{"Sign", "[", 
           RowBox[{"x1", "-", "x2", "+", "x3", "+", "x4"}], "]"}]}], "-", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"x1", "+", "x2", "+", "x3", "+", "x4"}], ")"}], "^", 
           "2"}], " ", 
          RowBox[{"Sign", "[", 
           RowBox[{"x1", "+", "x2", "+", "x3", "+", "x4"}], "]"}]}]}], 
        ")"}]}], "-", 
      RowBox[{"5", " ", "x2", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "x1"}], "+", "x2", "+", "x3", "+", "x4"}], ")"}], 
            "^", "4"}]}], " ", 
          RowBox[{"Sign", "[", 
           RowBox[{"x1", "-", "x2", "-", "x3", "-", "x4"}], "]"}]}], "-", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"x1", "+", "x2", "-", "x3", "-", "x4"}], ")"}], "^", 
           "4"}], " ", 
          RowBox[{"Sign", "[", 
           RowBox[{"x1", "+", "x2", "-", "x3", "-", "x4"}], "]"}]}], "+", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"x1", "-", "x2", "+", "x3", "-", "x4"}], ")"}], "^", 
           "4"}], " ", 
          RowBox[{"Sign", "[", 
           RowBox[{"x1", "-", "x2", "+", "x3", "-", "x4"}], "]"}]}], "+", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"x1", "+", "x2", "+", "x3", "-", "x4"}], ")"}], "^", 
           "4"}], " ", 
          RowBox[{"Sign", "[", 
           RowBox[{"x1", "+", "x2", "+", "x3", "-", "x4"}], "]"}]}], "+", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"x1", "-", "x2", "-", "x3", "+", "x4"}], ")"}], "^", 
           "4"}], " ", 
          RowBox[{"Sign", "[", 
           RowBox[{"x1", "-", "x2", "-", "x3", "+", "x4"}], "]"}]}], "+", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"x1", "+", "x2", "-", "x3", "+", "x4"}], ")"}], "^", 
           "4"}], " ", 
          RowBox[{"Sign", "[", 
           RowBox[{"x1", "+", "x2", "-", "x3", "+", "x4"}], "]"}]}], "-", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"x1", "-", "x2", "+", "x3", "+", "x4"}], ")"}], "^", 
           "4"}], " ", 
          RowBox[{"Sign", "[", 
           RowBox[{"x1", "-", "x2", "+", "x3", "+", "x4"}], "]"}]}], "-", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"x1", "+", "x2", "+", "x3", "+", "x4"}], ")"}], "^", 
           "4"}], " ", 
          RowBox[{"Sign", "[", 
           RowBox[{"x1", "+", "x2", "+", "x3", "+", "x4"}], "]"}]}]}], 
        ")"}]}], "-", 
      RowBox[{"5", " ", "x3", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "x1"}], "+", "x2", "+", "x3", "+", "x4"}], ")"}], 
            "^", "4"}]}], " ", 
          RowBox[{"Sign", "[", 
           RowBox[{"x1", "-", "x2", "-", "x3", "-", "x4"}], "]"}]}], "+", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"x1", "+", "x2", "-", "x3", "-", "x4"}], ")"}], "^", 
           "4"}], " ", 
          RowBox[{"Sign", "[", 
           RowBox[{"x1", "+", "x2", "-", "x3", "-", "x4"}], "]"}]}], "-", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"x1", "-", "x2", "+", "x3", "-", "x4"}], ")"}], "^", 
           "4"}], " ", 
          RowBox[{"Sign", "[", 
           RowBox[{"x1", "-", "x2", "+", "x3", "-", "x4"}], "]"}]}], "+", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"x1", "+", "x2", "+", "x3", "-", "x4"}], ")"}], "^", 
           "4"}], " ", 
          RowBox[{"Sign", "[", 
           RowBox[{"x1", "+", "x2", "+", "x3", "-", "x4"}], "]"}]}], "+", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"x1", "-", "x2", "-", "x3", "+", "x4"}], ")"}], "^", 
           "4"}], " ", 
          RowBox[{"Sign", "[", 
           RowBox[{"x1", "-", "x2", "-", "x3", "+", "x4"}], "]"}]}], "-", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"x1", "+", "x2", "-", "x3", "+", "x4"}], ")"}], "^", 
           "4"}], " ", 
          RowBox[{"Sign", "[", 
           RowBox[{"x1", "+", "x2", "-", "x3", "+", "x4"}], "]"}]}], "+", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"x1", "-", "x2", "+", "x3", "+", "x4"}], ")"}], "^", 
           "4"}], " ", 
          RowBox[{"Sign", "[", 
           RowBox[{"x1", "-", "x2", "+", "x3", "+", "x4"}], "]"}]}], "-", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"x1", "+", "x2", "+", "x3", "+", "x4"}], ")"}], "^", 
           "4"}], " ", 
          RowBox[{"Sign", "[", 
           RowBox[{"x1", "+", "x2", "+", "x3", "+", "x4"}], "]"}]}]}], 
        ")"}]}], "-", 
      RowBox[{"5", " ", "x4", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "x1"}], "+", "x2", "+", "x3", "+", "x4"}], ")"}], 
            "^", "4"}]}], " ", 
          RowBox[{"Sign", "[", 
           RowBox[{"x1", "-", "x2", "-", "x3", "-", "x4"}], "]"}]}], "+", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"x1", "+", "x2", "-", "x3", "-", "x4"}], ")"}], "^", 
           "4"}], " ", 
          RowBox[{"Sign", "[", 
           RowBox[{"x1", "+", "x2", "-", "x3", "-", "x4"}], "]"}]}], "+", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"x1", "-", "x2", "+", "x3", "-", "x4"}], ")"}], "^", 
           "4"}], " ", 
          RowBox[{"Sign", "[", 
           RowBox[{"x1", "-", "x2", "+", "x3", "-", "x4"}], "]"}]}], "-", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"x1", "+", "x2", "+", "x3", "-", "x4"}], ")"}], "^", 
           "4"}], " ", 
          RowBox[{"Sign", "[", 
           RowBox[{"x1", "+", "x2", "+", "x3", "-", "x4"}], "]"}]}], "-", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"x1", "-", "x2", "-", "x3", "+", "x4"}], ")"}], "^", 
           "4"}], " ", 
          RowBox[{"Sign", "[", 
           RowBox[{"x1", "-", "x2", "-", "x3", "+", "x4"}], "]"}]}], "+", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"x1", "+", "x2", "-", "x3", "+", "x4"}], ")"}], "^", 
           "4"}], " ", 
          RowBox[{"Sign", "[", 
           RowBox[{"x1", "+", "x2", "-", "x3", "+", "x4"}], "]"}]}], "+", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"x1", "-", "x2", "+", "x3", "+", "x4"}], ")"}], "^", 
           "4"}], " ", 
          RowBox[{"Sign", "[", 
           RowBox[{"x1", "-", "x2", "+", "x3", "+", "x4"}], "]"}]}], "-", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"x1", "+", "x2", "+", "x3", "+", "x4"}], ")"}], "^", 
           "4"}], " ", 
          RowBox[{"Sign", "[", 
           RowBox[{"x1", "+", "x2", "+", "x3", "+", "x4"}], "]"}]}]}], 
        ")"}]}], "-", 
      RowBox[{"5", " ", "x1", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "x1"}], "+", "x2", "+", "x3", "+", "x4"}], ")"}], 
           "^", "4"}], " ", 
          RowBox[{"Sign", "[", 
           RowBox[{"x1", "-", "x2", "-", "x3", "-", "x4"}], "]"}]}], "-", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"x1", "+", "x2", "-", "x3", "-", "x4"}], ")"}], "^", 
           "4"}], " ", 
          RowBox[{"Sign", "[", 
           RowBox[{"x1", "+", "x2", "-", "x3", "-", "x4"}], "]"}]}], "-", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"x1", "-", "x2", "+", "x3", "-", "x4"}], ")"}], "^", 
           "4"}], " ", 
          RowBox[{"Sign", "[", 
           RowBox[{"x1", "-", "x2", "+", "x3", "-", "x4"}], "]"}]}], "+", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"x1", "+", "x2", "+", "x3", "-", "x4"}], ")"}], "^", 
           "4"}], " ", 
          RowBox[{"Sign", "[", 
           RowBox[{"x1", "+", "x2", "+", "x3", "-", "x4"}], "]"}]}], "-", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"x1", "-", "x2", "-", "x3", "+", "x4"}], ")"}], "^", 
           "4"}], " ", 
          RowBox[{"Sign", "[", 
           RowBox[{"x1", "-", "x2", "-", "x3", "+", "x4"}], "]"}]}], "+", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"x1", "+", "x2", "-", "x3", "+", "x4"}], ")"}], "^", 
           "4"}], " ", 
          RowBox[{"Sign", "[", 
           RowBox[{"x1", "+", "x2", "-", "x3", "+", "x4"}], "]"}]}], "+", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"x1", "-", "x2", "+", "x3", "+", "x4"}], ")"}], "^", 
           "4"}], " ", 
          RowBox[{"Sign", "[", 
           RowBox[{"x1", "-", "x2", "+", "x3", "+", "x4"}], "]"}]}], "-", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"x1", "+", "x2", "+", "x3", "+", "x4"}], ")"}], "^", 
           "4"}], " ", 
          RowBox[{"Sign", "[", 
           RowBox[{"x1", "+", "x2", "+", "x3", "+", "x4"}], "]"}]}]}], 
        ")"}]}]}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Plot3D", "[", 
    RowBox[{
     RowBox[{"D3", "[", 
      RowBox[{"x1", ",", "x2", ",", "1", ",", "1"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"x1", ",", 
       RowBox[{"-", "2"}], ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"x2", ",", 
       RowBox[{"-", "2"}], ",", "2"}], "}"}]}], "]"}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.519556067641704*^9, 3.519556071575453*^9}, {
  3.519556142418322*^9, 3.519556151910828*^9}, {3.519617022471928*^9, 
  3.519617026336284*^9}, {3.536902899283635*^9, 3.536902920175219*^9}, {
  3.619534727776293*^9, 3.619534730566475*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "4"], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"-", 
     RowBox[{"Abs", "[", 
      RowBox[{"x1", "+", "x2", "-", "x3", "-", "x4"}], "]"}]}], "-", 
    RowBox[{"Abs", "[", 
     RowBox[{"x1", "-", "x2", "+", "x3", "-", "x4"}], "]"}], "+", 
    RowBox[{"Abs", "[", 
     RowBox[{"x1", "+", "x2", "+", "x3", "-", "x4"}], "]"}], "-", 
    RowBox[{"Abs", "[", 
     RowBox[{"x1", "-", "x2", "-", "x3", "+", "x4"}], "]"}], "+", 
    RowBox[{"Abs", "[", 
     RowBox[{"x1", "+", "x2", "-", "x3", "+", "x4"}], "]"}], "+", 
    RowBox[{"Abs", "[", 
     RowBox[{"x1", "-", "x2", "+", "x3", "+", "x4"}], "]"}], "+", 
    RowBox[{"Abs", "[", 
     RowBox[{
      RowBox[{"-", "x1"}], "+", "x2", "+", "x3", "+", "x4"}], "]"}], "-", 
    RowBox[{"Abs", "[", 
     RowBox[{"x1", "+", "x2", "+", "x3", "+", "x4"}], "]"}]}], 
   ")"}]}]], "Output",
 CellChangeTimes->{{3.619534723133484*^9, 3.619534736334882*^9}, 
   3.619535477147483*^9}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "24"], " ", 
  RowBox[{"(", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"Abs", "[", 
      RowBox[{"x1", "+", "x2", "-", "x3", "-", "x4"}], "]"}], "3"], "+", 
    SuperscriptBox[
     RowBox[{"Abs", "[", 
      RowBox[{"x1", "-", "x2", "+", "x3", "-", "x4"}], "]"}], "3"], "-", 
    SuperscriptBox[
     RowBox[{"Abs", "[", 
      RowBox[{"x1", "+", "x2", "+", "x3", "-", "x4"}], "]"}], "3"], "+", 
    SuperscriptBox[
     RowBox[{"Abs", "[", 
      RowBox[{"x1", "-", "x2", "-", "x3", "+", "x4"}], "]"}], "3"], "-", 
    SuperscriptBox[
     RowBox[{"Abs", "[", 
      RowBox[{"x1", "+", "x2", "-", "x3", "+", "x4"}], "]"}], "3"], "-", 
    SuperscriptBox[
     RowBox[{"Abs", "[", 
      RowBox[{"x1", "-", "x2", "+", "x3", "+", "x4"}], "]"}], "3"], "-", 
    SuperscriptBox[
     RowBox[{"Abs", "[", 
      RowBox[{
       RowBox[{"-", "x1"}], "+", "x2", "+", "x3", "+", "x4"}], "]"}], "3"], 
    "+", 
    SuperscriptBox[
     RowBox[{"Abs", "[", 
      RowBox[{"x1", "+", "x2", "+", "x3", "+", "x4"}], "]"}], "3"], "+", 
    RowBox[{"6", " ", "x3", " ", "x4", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Abs", "[", 
        RowBox[{"x1", "+", "x2", "-", "x3", "-", "x4"}], "]"}], "-", 
       RowBox[{"Abs", "[", 
        RowBox[{"x1", "-", "x2", "+", "x3", "-", "x4"}], "]"}], "+", 
       RowBox[{"Abs", "[", 
        RowBox[{"x1", "+", "x2", "+", "x3", "-", "x4"}], "]"}], "-", 
       RowBox[{"Abs", "[", 
        RowBox[{"x1", "-", "x2", "-", "x3", "+", "x4"}], "]"}], "+", 
       RowBox[{"Abs", "[", 
        RowBox[{"x1", "+", "x2", "-", "x3", "+", "x4"}], "]"}], "-", 
       RowBox[{"Abs", "[", 
        RowBox[{"x1", "-", "x2", "+", "x3", "+", "x4"}], "]"}], "-", 
       RowBox[{"Abs", "[", 
        RowBox[{
         RowBox[{"-", "x1"}], "+", "x2", "+", "x3", "+", "x4"}], "]"}], "+", 
       RowBox[{"Abs", "[", 
        RowBox[{"x1", "+", "x2", "+", "x3", "+", "x4"}], "]"}]}], ")"}]}], 
    "-", 
    RowBox[{"3", " ", "x4", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "x1"}], "+", "x2", "+", "x3", "+", "x4"}], ")"}], 
         "2"], " ", 
        RowBox[{"Sign", "[", 
         RowBox[{"x1", "-", "x2", "-", "x3", "-", "x4"}], "]"}]}], "-", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"x1", "+", "x2", "-", "x3", "-", "x4"}], ")"}], "2"], " ", 
        RowBox[{"Sign", "[", 
         RowBox[{"x1", "+", "x2", "-", "x3", "-", "x4"}], "]"}]}], "-", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"x1", "-", "x2", "+", "x3", "-", "x4"}], ")"}], "2"], " ", 
        RowBox[{"Sign", "[", 
         RowBox[{"x1", "-", "x2", "+", "x3", "-", "x4"}], "]"}]}], "+", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"x1", "+", "x2", "+", "x3", "-", "x4"}], ")"}], "2"], " ", 
        RowBox[{"Sign", "[", 
         RowBox[{"x1", "+", "x2", "+", "x3", "-", "x4"}], "]"}]}], "+", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"x1", "-", "x2", "-", "x3", "+", "x4"}], ")"}], "2"], " ", 
        RowBox[{"Sign", "[", 
         RowBox[{"x1", "-", "x2", "-", "x3", "+", "x4"}], "]"}]}], "-", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"x1", "+", "x2", "-", "x3", "+", "x4"}], ")"}], "2"], " ", 
        RowBox[{"Sign", "[", 
         RowBox[{"x1", "+", "x2", "-", "x3", "+", "x4"}], "]"}]}], "-", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"x1", "-", "x2", "+", "x3", "+", "x4"}], ")"}], "2"], " ", 
        RowBox[{"Sign", "[", 
         RowBox[{"x1", "-", "x2", "+", "x3", "+", "x4"}], "]"}]}], "+", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"x1", "+", "x2", "+", "x3", "+", "x4"}], ")"}], "2"], " ", 
        RowBox[{"Sign", "[", 
         RowBox[{"x1", "+", "x2", "+", "x3", "+", "x4"}], "]"}]}]}], ")"}]}], 
    "-", 
    RowBox[{"3", " ", "x3", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "x1"}], "+", "x2", "+", "x3", "+", "x4"}], ")"}], 
         "2"], " ", 
        RowBox[{"Sign", "[", 
         RowBox[{"x1", "-", "x2", "-", "x3", "-", "x4"}], "]"}]}], "-", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"x1", "+", "x2", "-", "x3", "-", "x4"}], ")"}], "2"], " ", 
        RowBox[{"Sign", "[", 
         RowBox[{"x1", "+", "x2", "-", "x3", "-", "x4"}], "]"}]}], "+", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"x1", "-", "x2", "+", "x3", "-", "x4"}], ")"}], "2"], " ", 
        RowBox[{"Sign", "[", 
         RowBox[{"x1", "-", "x2", "+", "x3", "-", "x4"}], "]"}]}], "-", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"x1", "+", "x2", "+", "x3", "-", "x4"}], ")"}], "2"], " ", 
        RowBox[{"Sign", "[", 
         RowBox[{"x1", "+", "x2", "+", "x3", "-", "x4"}], "]"}]}], "-", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"x1", "-", "x2", "-", "x3", "+", "x4"}], ")"}], "2"], " ", 
        RowBox[{"Sign", "[", 
         RowBox[{"x1", "-", "x2", "-", "x3", "+", "x4"}], "]"}]}], "+", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"x1", "+", "x2", "-", "x3", "+", "x4"}], ")"}], "2"], " ", 
        RowBox[{"Sign", "[", 
         RowBox[{"x1", "+", "x2", "-", "x3", "+", "x4"}], "]"}]}], "-", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"x1", "-", "x2", "+", "x3", "+", "x4"}], ")"}], "2"], " ", 
        RowBox[{"Sign", "[", 
         RowBox[{"x1", "-", "x2", "+", "x3", "+", "x4"}], "]"}]}], "+", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"x1", "+", "x2", "+", "x3", "+", "x4"}], ")"}], "2"], " ", 
        RowBox[{"Sign", "[", 
         RowBox[{"x1", "+", "x2", "+", "x3", "+", "x4"}], "]"}]}]}], 
      ")"}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{{3.619534723133484*^9, 3.619534736334882*^9}, 
   3.619535491221162*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"grid", " ", "=", " ", 
  RowBox[{
  "Import", "[", "\"\<~/Repositories/pyBBN/src/tests/grid.json\>\"", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"outer", " ", "=", " ", 
   RowBox[{"Outer", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"#1", ",", "#2", ",", "#3", ",", "#4"}], "}"}], "&"}], ",", 
     "grid", ",", "grid", ",", "grid", ",", "grid"}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.619534765082605*^9, 3.619534822861024*^9}, {
   3.619534942646899*^9, 3.619535020502718*^9}, {3.619535157026113*^9, 
   3.619535191124165*^9}, {3.619535287005731*^9, 3.6195352873761063`*^9}, 
   3.6195353758322287`*^9, 3.6195355591631804`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.`", ",", "1.0526315789473684`", ",", "2.1052631578947367`", ",", 
   "3.1578947368421053`", ",", "4.2105263157894735`", ",", 
   "5.263157894736842`", ",", "6.315789473684211`", ",", "7.368421052631579`",
    ",", "8.421052631578947`", ",", "9.473684210526315`", ",", 
   "10.526315789473683`", ",", "11.578947368421051`", ",", 
   "12.631578947368421`", ",", "13.68421052631579`", ",", 
   "14.736842105263158`", ",", "15.789473684210526`", ",", 
   "16.842105263157894`", ",", "17.894736842105264`", ",", 
   "18.94736842105263`", ",", "20.`"}], "}"}]], "Output",
 CellChangeTimes->{{3.619535554275449*^9, 3.6195355659258013`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Length", "@", 
   RowBox[{"Gather", "@", 
    RowBox[{"Flatten", "@", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Apply", "[", 
        RowBox[{"D1", ",", "outer", ",", 
         RowBox[{"{", "4", "}"}]}], "]"}], "-", " ", 
       RowBox[{
       "Import", "[", "\"\<~/Repositories/pyBBN/src/tests/D1.json\>\"", 
        "]"}]}], ")"}]}]}]}], "/", 
  SuperscriptBox[
   RowBox[{"(", 
    RowBox[{"Length", "@", "grid"}], ")"}], "4"]}], "\[IndentingNewLine]", 
 RowBox[{"Union", "@", 
  RowBox[{"Flatten", "@", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Apply", "[", 
      RowBox[{"D1", ",", "outer", ",", 
       RowBox[{"{", "4", "}"}]}], "]"}], "/", 
     RowBox[{
     "Import", "[", "\"\<~/Repositories/pyBBN/src/tests/D1.json\>\"", "]"}]}],
     ")"}]}]}]}], "Input",
 CellChangeTimes->{{3.6195352158607807`*^9, 3.619535325446281*^9}, {
   3.619535391176742*^9, 3.619535396980041*^9}, {3.6195355457686787`*^9, 
   3.6195355513749247`*^9}, 3.619535584307033*^9, {3.619535637753978*^9, 
   3.6195356391714563`*^9}, {3.619535679882257*^9, 3.619535707938205*^9}, {
   3.619535993547825*^9, 3.619535995902261*^9}, {3.61953603899576*^9, 
   3.619536111460555*^9}}],

Cell[BoxData[
 FractionBox["71", "160000"]], "Output",
 CellChangeTimes->{
  3.619534798161701*^9, 3.619534997478549*^9, 3.619535059374958*^9, 
   3.6195351931636267`*^9, 3.619535270566587*^9, {3.6195353188411694`*^9, 
   3.619535331495462*^9}, {3.619535574581015*^9, 3.619535590056038*^9}, 
   3.619535645237805*^9, 3.619535712889703*^9, 3.619536021643614*^9, {
   3.619536064239724*^9, 3.619536081535317*^9}, 3.6195361188955936`*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Power", "::", "infy"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Infinite expression \[NoBreak]\\!\\(1\\/0.`\\)\[NoBreak] \
encountered. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/infy\\\", ButtonNote -> \
\\\"Power::infy\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{
  3.619536025870408*^9, {3.619536068549059*^9, 3.6195360857721033`*^9}, 
   3.6195361230748262`*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Power", "::", "infy"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Infinite expression \[NoBreak]\\!\\(1\\/0.`\\)\[NoBreak] \
encountered. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/infy\\\", ButtonNote -> \
\\\"Power::infy\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{
  3.619536025870408*^9, {3.619536068549059*^9, 3.6195360857721033`*^9}, 
   3.61953612311903*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Power", "::", "infy"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Infinite expression \[NoBreak]\\!\\(1\\/0.`\\)\[NoBreak] \
encountered. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/infy\\\", ButtonNote -> \
\\\"Power::infy\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{
  3.619536025870408*^9, {3.619536068549059*^9, 3.6195360857721033`*^9}, 
   3.619536123206806*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"General", "::", "stop"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Further output of \[NoBreak]\\!\\(\\*StyleBox[\\(Power :: \
infy\\), \\\"MessageName\\\"]\\)\[NoBreak] will be suppressed during this \
calculation. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/stop\\\", ButtonNote -> \
\\\"General::stop\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{
  3.619536025870408*^9, {3.619536068549059*^9, 3.6195360857721033`*^9}, 
   3.619536123209299*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Infinity", "::", "indet"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Indeterminate expression \[NoBreak]\\!\\(0.`\\\\ \
ComplexInfinity\\)\[NoBreak] encountered. \\!\\(\\*ButtonBox[\\\"\
\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/indet\\\", ButtonNote -> \
\\\"Infinity::indet\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{
  3.619536025870408*^9, {3.619536068549059*^9, 3.6195360857721033`*^9}, 
   3.619536123492078*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Infinity", "::", "indet"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Indeterminate expression \[NoBreak]\\!\\(0.`\\\\ \
ComplexInfinity\\)\[NoBreak] encountered. \\!\\(\\*ButtonBox[\\\"\
\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/indet\\\", ButtonNote -> \
\\\"Infinity::indet\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{
  3.619536025870408*^9, {3.619536068549059*^9, 3.6195360857721033`*^9}, 
   3.619536123531622*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Infinity", "::", "indet"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Indeterminate expression \[NoBreak]\\!\\(0.`\\\\ \
ComplexInfinity\\)\[NoBreak] encountered. \\!\\(\\*ButtonBox[\\\"\
\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/indet\\\", ButtonNote -> \
\\\"Infinity::indet\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{
  3.619536025870408*^9, {3.619536068549059*^9, 3.6195360857721033`*^9}, 
   3.619536123575508*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"General", "::", "stop"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Further output of \[NoBreak]\\!\\(\\*StyleBox[\\(Infinity \
:: indet\\), \\\"MessageName\\\"]\\)\[NoBreak] will be suppressed during this \
calculation. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/stop\\\", ButtonNote -> \
\\\"General::stop\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{
  3.619536025870408*^9, {3.619536068549059*^9, 3.6195360857721033`*^9}, 
   3.619536123608705*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "24.`"}], ",", 
   RowBox[{"-", "16.`"}], ",", 
   RowBox[{"-", "8.`"}], ",", 
   RowBox[{"-", "4.`"}], ",", 
   RowBox[{"-", "3.2`"}], ",", 
   RowBox[{"-", "3.`"}], ",", 
   RowBox[{"-", "2.6666666666666665`"}], ",", 
   RowBox[{"-", "2.2857142857142856`"}], ",", 
   RowBox[{"-", "2.`"}], ",", 
   RowBox[{"-", "1.7777777777777777`"}], ",", 
   RowBox[{"-", "1.7142857142857142`"}], ",", 
   RowBox[{"-", "1.6`"}], ",", 
   RowBox[{"-", "1.3333333333333333`"}], ",", 
   RowBox[{"-", "1.1428571428571428`"}], ",", 
   RowBox[{"-", "1.`"}], ",", 
   RowBox[{"-", "0.6666666666666666`"}], ",", 
   RowBox[{"-", "0.5714285714285714`"}], ",", 
   RowBox[{"-", "0.5`"}], ",", "0.`", ",", "0.4`", ",", "0.5`", ",", 
   "0.5714285714285714`", ",", "0.6666666666666666`", ",", 
   "0.7272727272727273`", ",", "0.8`", ",", "0.8888888888888888`", ",", 
   "0.9999999999999896`", ",", "0.9999999999999925`", ",", 
   "0.9999999999999929`", ",", "0.9999999999999932`", ",", 
   "0.9999999999999933`", ",", "0.999999999999994`", ",", 
   "0.9999999999999941`", ",", "0.9999999999999946`", ",", 
   "0.9999999999999947`", ",", "0.9999999999999948`", ",", 
   "0.9999999999999949`", ",", "0.999999999999995`", ",", 
   "0.9999999999999953`", ",", "0.9999999999999954`", ",", 
   "0.9999999999999956`", ",", "0.9999999999999958`", ",", 
   "0.9999999999999962`", ",", "0.9999999999999963`", ",", 
   "0.9999999999999964`", ",", "0.9999999999999966`", ",", 
   "0.9999999999999967`", ",", "0.9999999999999969`", ",", 
   "0.999999999999997`", ",", "0.9999999999999971`", ",", 
   "0.9999999999999972`", ",", "0.9999999999999973`", ",", 
   "0.9999999999999974`", ",", "0.9999999999999976`", ",", 
   "0.9999999999999977`", ",", "0.9999999999999978`", ",", 
   "0.9999999999999979`", ",", "0.999999999999998`", ",", 
   "0.9999999999999981`", ",", "0.9999999999999982`", ",", 
   "0.9999999999999983`", ",", "0.9999999999999984`", ",", 
   "0.9999999999999986`", ",", "0.9999999999999987`", ",", 
   "0.9999999999999988`", ",", "0.9999999999999989`", ",", 
   "0.999999999999999`", ",", "0.9999999999999991`", ",", 
   "0.9999999999999992`", ",", "0.9999999999999993`", ",", 
   "0.9999999999999994`", ",", "0.9999999999999996`", ",", 
   "0.9999999999999997`", ",", "0.9999999999999998`", ",", 
   "0.9999999999999999`", ",", "1.`", ",", "1.0000000000000002`", ",", 
   "1.0000000000000004`", ",", "1.0000000000000007`", ",", 
   "1.0000000000000009`", ",", "1.000000000000001`", ",", 
   "1.0000000000000013`", ",", "1.0000000000000016`", ",", 
   "1.0000000000000018`", ",", "1.000000000000002`", ",", 
   "1.0000000000000022`", ",", "1.0000000000000024`", ",", 
   "1.0000000000000027`", ",", "1.0000000000000029`", ",", 
   "1.000000000000003`", ",", "1.0000000000000033`", ",", 
   "1.0000000000000038`", ",", "1.000000000000004`", ",", 
   "1.0000000000000042`", ",", "1.0000000000000044`", ",", 
   "1.0000000000000047`", ",", "1.0000000000000049`", ",", 
   "1.000000000000005`", ",", "1.0000000000000056`", ",", 
   "1.0000000000000058`", ",", "1.000000000000006`", ",", 
   "1.0000000000000064`", ",", "1.0000000000000067`", ",", 
   "1.0000000000000075`", ",", "1.0000000000000082`", ",", 
   "1.1428571428571428`", ",", "1.3333333333333333`", ",", "1.5`", ",", 
   "1.6`", ",", "1.7777777777777777`", ",", "2.`", ",", "2.1818181818181817`",
    ",", "2.2857142857142856`", ",", "2.5`", ",", "2.6666666666666665`", ",", 
   "2.909090909090909`", ",", "3.`", ",", "3.2`", ",", "3.4285714285714284`", 
   ",", "3.5`", ",", "3.5555555555555554`", ",", "4.`", ",", "5.`", ",", 
   "5.333333333333333`", ",", "6.`", ",", "6.4`", ",", "8.`", ",", 
   "10.666666666666666`", ",", "16.`", ",", "24.`", ",", "Indeterminate", ",",
    "ComplexInfinity"}], "}"}]], "Output",
 CellChangeTimes->{
  3.619534798161701*^9, 3.619534997478549*^9, 3.619535059374958*^9, 
   3.6195351931636267`*^9, 3.619535270566587*^9, {3.6195353188411694`*^9, 
   3.619535331495462*^9}, {3.619535574581015*^9, 3.619535590056038*^9}, 
   3.619535645237805*^9, 3.619535712889703*^9, 3.619536021643614*^9, {
   3.619536064239724*^9, 3.619536081535317*^9}, 3.6195361239197187`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Length", "@", 
   RowBox[{"Gather", "@", 
    RowBox[{"Flatten", "@", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Apply", "[", 
        RowBox[{"D2", ",", "outer", ",", 
         RowBox[{"{", "4", "}"}]}], "]"}], "-", " ", 
       RowBox[{
       "Import", "[", "\"\<~/Repositories/pyBBN/src/tests/D2.json\>\"", 
        "]"}]}], ")"}]}]}]}], "/", 
  SuperscriptBox[
   RowBox[{"(", 
    RowBox[{"Length", "@", "grid"}], ")"}], "4"]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Apply", "[", 
   RowBox[{"D2", ",", "outer", ",", 
    RowBox[{"{", "4", "}"}]}], "]"}], "/", " ", 
  RowBox[{
  "Import", "[", "\"\<~/Repositories/pyBBN/src/tests/D2.json\>\"", 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.619535726708694*^9, 3.619535734576304*^9}, {
  3.619536001339795*^9, 3.619536003195059*^9}}],

Cell[BoxData[
 FractionBox["2751", "160000"]], "Output",
 CellChangeTimes->{3.6195357597993917`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Length", "@", 
   RowBox[{"Gather", "@", 
    RowBox[{"Flatten", "@", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Apply", "[", 
        RowBox[{"D3", ",", "outer", ",", 
         RowBox[{"{", "4", "}"}]}], "]"}], "-", " ", 
       RowBox[{
       "Import", "[", "\"\<~/Repositories/pyBBN/src/tests/D3.json\>\"", 
        "]"}]}], ")"}]}]}]}], "/", 
  SuperscriptBox[
   RowBox[{"(", 
    RowBox[{"Length", "@", "grid"}], ")"}], "4"]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Apply", "[", 
   RowBox[{"D3", ",", "outer", ",", 
    RowBox[{"{", "4", "}"}]}], "]"}], "/", " ", 
  RowBox[{
  "Import", "[", "\"\<~/Repositories/pyBBN/src/tests/D3.json\>\"", 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.619535730146798*^9, 3.619535737514351*^9}, {
  3.6195360079153633`*^9, 3.6195360108860292`*^9}}],

Cell[BoxData[
 FractionBox["7931", "80000"]], "Output",
 CellChangeTimes->{3.6195358413152857`*^9}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{
  "SetDirectory", "[", 
   "\"\</media/data/anderl/Documents/Work/programming/bbn_code\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"Directory", "[", "]"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"FileExistsQ", "[", "\"\<./Input/ew_nofluctuations.dat\>\"", "]"}],
    "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.56189004765726*^9, 3.561890088533998*^9}, {
  3.561890127542451*^9, 3.561890141994704*^9}, {3.561890190455569*^9, 
  3.561890209056967*^9}}],

Cell[BoxData[{
 RowBox[{"\"\<Standard quantities\>\"", ";"}], "\[IndentingNewLine]", 
 RowBox[{"\"\<All energy quantiiies are measured in MeV\>\"", 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GF", "=", 
   RowBox[{"1.17", " ", 
    RowBox[{"10", "^", 
     RowBox[{"-", "11"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"geff", "=", "11."}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MPl", "=", 
   RowBox[{"1.22", " ", 
    RowBox[{"10", "^", "22"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sectoMeV", "=", 
   RowBox[{"1.52", " ", 
    RowBox[{"10", "^", "21"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SubscriptBox["\[Theta]", "W"], "=", 
   RowBox[{"ArcSin", "[", 
    RowBox[{"Sqrt", "[", "0.23", "]"}], "]"}]}], ";", 
  RowBox[{"gL", "=", 
   RowBox[{".5", "+", 
    RowBox[{
     RowBox[{"Sin", "[", 
      SubscriptBox["\[Theta]", "W"], "]"}], "^", "2"}]}]}], " ", ";", 
  RowBox[{"gR", "=", 
   RowBox[{
    RowBox[{"Sin", "[", 
     SubscriptBox["\[Theta]", "W"], "]"}], "^", "2"}]}], ";", 
  RowBox[{"gtL", "=", 
   RowBox[{
    RowBox[{"-", ".5"}], "+", 
    RowBox[{
     RowBox[{"Sin", "[", 
      SubscriptBox["\[Theta]", "W"], "]"}], "^", "2"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"nF", "[", "EoT_", "]"}], "=", 
    RowBox[{"1", "/", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Exp", "[", "EoT", "]"}], "+", "1"}], ")"}]}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"SetDirectory", "[", "\"\<\>\"", "]"}], ";"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"EWdata", "=", 
   RowBox[{"Import", "[", "\"\<./Input/ew_nofluctuations.dat\>\"", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ge", "=", 
   RowBox[{"EWdata", "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", "8"}], "}"}]}], "]"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"he", "=", 
   RowBox[{"EWdata", "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", "9"}], "}"}]}], "]"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"geffEW", "=", 
   RowBox[{"Interpolation", "[", 
    RowBox[{"ge", ",", 
     RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"heffEW", "=", 
   RowBox[{"Interpolation", "[", 
    RowBox[{"he", ",", 
     RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"\"\<Hubble rate\>\"", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"H", "[", "TTemp_", "]"}], ":=", 
   RowBox[{
    RowBox[{"Sqrt", "[", 
     RowBox[{"4", 
      RowBox[{
       RowBox[{"Pi", "^", "3"}], "/", "45"}], " ", 
      RowBox[{"geffEW", "[", "TTemp", "]"}]}], "]"}], 
    RowBox[{
     RowBox[{"TTemp", "^", "2"}], "/", "MPl"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"\"\<a is the scale factor, \!\(\*SubscriptBox[\(a\), \
\(norm\)]\)\!\(\*SubscriptBox[\(T\), \(norm\)]\)=1 is the normalization\>\"", 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Tnorm", "=", "70"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"a", "[", "TTemp_", "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"heffEW", "[", "Tnorm", "]"}], "/", 
       RowBox[{"heffEW", "[", "TTemp", "]"}]}], ")"}], "^", 
     RowBox[{"(", 
      RowBox[{"1", "/", "3"}], ")"}]}], "/", "TTemp"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"LogPlot", "[", 
      RowBox[{
       RowBox[{"96", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Pi", "^", "3"}], "/", 
           RowBox[{"GF", "^", "2"}]}], "/", 
          RowBox[{"Mass", "^", "5"}]}], "/", "sectoMeV"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"Mass", ",", "20", ",", "1"}], "}"}], ",", 
       RowBox[{"PlotRange", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1", ",", "20"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0.005", ",", 
            RowBox[{"10", "^", "4"}]}], "}"}]}], "}"}]}], ",", " ", 
       RowBox[{"Frame", "\[Rule]", "True"}], ",", 
       RowBox[{"FrameLabel", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
         "\"\<\!\(\*SubscriptBox[\(M\), \(s\)]\) [MeV]\>\"", ",", 
          "\"\<\!\(\*SubscriptBox[\(\[Tau]\), \(N\)]\) [sec]\>\""}], "}"}]}], 
       ",", 
       RowBox[{"Filling", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"1", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"Bottom", ",", 
            RowBox[{"RGBColor", "[", 
             RowBox[{"0.8", ",", "0.8", ",", "0.95"}], "]"}]}], "}"}]}], 
         "}"}]}]}], "]"}], "\[IndentingNewLine]", 
     RowBox[{"Export", "[", 
      RowBox[{"\"\<Lifetime-theta=1.eps\>\"", ",", "%"}], "]"}]}], ";"}], 
   "*)"}]}]}], "Input",
 CellChangeTimes->{{3.51961592322475*^9, 3.519615944812317*^9}, {
   3.519617667881286*^9, 3.519617689282336*^9}, {3.523099702206997*^9, 
   3.523099875064628*^9}, {3.523241051225033*^9, 3.523241052111748*^9}, {
   3.523353857439762*^9, 3.52335391204815*^9}, {3.523353951392065*^9, 
   3.52335395176551*^9}, {3.523354213929021*^9, 3.523354281182218*^9}, {
   3.523354311246046*^9, 3.523354316580211*^9}, {3.523354347894316*^9, 
   3.523354375492112*^9}, {3.523354411173992*^9, 3.523354508133104*^9}, {
   3.523354698680582*^9, 3.523354740070328*^9}, {3.523355193711329*^9, 
   3.523355207764971*^9}, 3.523355248258221*^9, {3.523356659990099*^9, 
   3.523356670612331*^9}, {3.52335670222496*^9, 3.523356717738155*^9}, {
   3.52335690283092*^9, 3.523356936752743*^9}, {3.523410991153726*^9, 
   3.523410997501761*^9}, {3.534569538906723*^9, 3.534569606382226*^9}, {
   3.534569713169993*^9, 3.534569721662708*^9}, {3.534573485221268*^9, 
   3.534573485472529*^9}, {3.534655659969779*^9, 3.534655685461843*^9}, {
   3.534655723274366*^9, 3.53465582128947*^9}, {3.534658366014943*^9, 
   3.534658422397505*^9}, {3.536660488846396*^9, 3.536660526925267*^9}, {
   3.536660615694957*^9, 3.5366606189806128`*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
  "\"\<We assume that all particles but sterile neutrino are relativistic so \
that their masses are negligible\>\"", ";", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"KfuncIntegrand", "[", 
     RowBox[{"ps_", ",", "p2_", ",", "p3_", ",", "p4_", ",", "Ms_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"128", "*", "96", " ", 
      RowBox[{"Pi", "^", "3"}], "*", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"3", "*", "Es", " ", "p2", " ", "p3", " ", "p4", " ", 
         RowBox[{"D1", "[", 
          RowBox[{"ps", ",", "p2", ",", "p3", ",", "p4"}], "]"}]}], "+", 
        RowBox[{"3", 
         RowBox[{"D3", "[", 
          RowBox[{"ps", ",", "p2", ",", "p3", ",", "p4"}], "]"}]}], "+", 
        RowBox[{"Es", " ", "p4", " ", 
         RowBox[{"D2", "[", 
          RowBox[{"ps", ",", "p4", ",", "p2", ",", "p3"}], "]"}]}], "-", 
        RowBox[{"p2", " ", "p3", " ", 
         RowBox[{"D2", "[", 
          RowBox[{"p2", ",", "p3", ",", "ps", ",", "p4"}], "]"}]}], "+", 
        RowBox[{"Es", " ", "p2", " ", 
         RowBox[{"D2", "[", 
          RowBox[{"ps", ",", "p2", ",", "p3", ",", "p4"}], "]"}]}], "+", 
        RowBox[{"p3", " ", "p4", " ", 
         RowBox[{"D2", "[", 
          RowBox[{"p3", ",", "p4", ",", "ps", ",", "p2"}], "]"}]}]}], ")"}]}],
      "/.", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"Es", "\[Rule]", 
        RowBox[{"Sqrt", "[", 
         RowBox[{
          RowBox[{"ps", "^", "2"}], "+", 
          RowBox[{"Ms", "^", "2"}]}], "]"}]}], "}"}], "\[IndentingNewLine]", 
      "\"\<Momentum ranges are taken finite to reduce computation \
time\>\""}]}]}], ";", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Kfunc", "[", 
     RowBox[{"EoT_", ",", "MoT_"}], "]"}], ":=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"EoT", "-", "MoT"}], ">", "0"}], ",", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"1", "/", "64"}], "/", 
           RowBox[{"Pi", "^", "3"}]}], "/", "EoT"}], "/", 
         RowBox[{"Sqrt", "[", 
          RowBox[{
           RowBox[{"EoT", "^", "2"}], "-", 
           RowBox[{"MoT", "^", "2"}]}], "]"}]}], ")"}], 
       RowBox[{"NIntegrate", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"HeavisideTheta", "[", 
           RowBox[{"EoT", "+", "p2oT", "-", "p3oT"}], "]"}], 
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"nF", "[", "p2oT", "]"}]}], ")"}], 
          RowBox[{"nF", "[", "p3oT", "]"}], 
          RowBox[{
           RowBox[{"nF", "[", 
            RowBox[{"EoT", "+", "p2oT", "-", "p3oT"}], "]"}], "/", 
           RowBox[{"nF", "[", "EoT", "]"}]}], 
          RowBox[{"KfuncIntegrand", "[", 
           RowBox[{
            RowBox[{"Sqrt", "[", 
             RowBox[{
              RowBox[{"EoT", "^", "2"}], "-", 
              RowBox[{"MoT", "^", "2"}]}], "]"}], ",", "p2oT", ",", "p3oT", 
            ",", 
            RowBox[{"EoT", "+", "p2oT", "-", "p3oT"}], ",", "MoT"}], "]"}]}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"p2oT", ",", "0", ",", "15"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"p3oT", ",", "0", ",", "15"}], "}"}], ",", 
         RowBox[{"Method", "\[Rule]", "\"\<AdaptiveMonteCarlo\>\""}]}], 
        "]"}]}], ",", "0"}], "]"}]}], ";", " ", "\[IndentingNewLine]", 
   "\"\<Kfunc is a function of only two arguments and hence can be \
interpolated only ONCE and used in advance for ALL computations\>\"", ";", 
   "\[IndentingNewLine]", 
   RowBox[{"KfuncExport", "=", 
    RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{"AppendTo", "[", 
      RowBox[{"KfuncExport", ",", 
       RowBox[{"{", 
        RowBox[{"poT", ",", "MoT", ",", 
         RowBox[{"Kfunc", "[", 
          RowBox[{
           RowBox[{"Sqrt", "[", 
            RowBox[{
             RowBox[{"poT", "^", "2"}], "+", 
             RowBox[{"MoT", "^", "2"}]}], "]"}], ",", "MoT"}], "]"}]}], 
        "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"poT", ",", "0", ",", "10", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"MoT", ",", "0", ",", "20", ",", "2"}], "}"}]}], "]"}], ";", 
   "\[IndentingNewLine]", 
   RowBox[{"Export", "[", 
    RowBox[{"\"\<Input/Kfunc2.dat\>\"", ",", "KfuncExport"}], "]"}], ";"}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.523353946287785*^9, 3.523353962956135*^9}, {
  3.523410928227872*^9, 3.523410942944989*^9}, {3.523411360284291*^9, 
  3.523411373658484*^9}, {3.523411481317127*^9, 3.523411483969159*^9}, {
  3.52341205335358*^9, 3.523412139738249*^9}, {3.523581241793295*^9, 
  3.523581245761893*^9}, {3.53422124223167*^9, 3.534221259128214*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"KfInt", "=", 
   RowBox[{"Import", "[", "\"\<Input/Kfunc2.dat\>\"", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"KfInter", "=", 
   RowBox[{"KfInt", "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"KfuncImport", "=", 
   RowBox[{"Interpolation", "[", 
    RowBox[{"KfInter", ",", 
     RowBox[{"InterpolationOrder", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"2", ",", "2"}], "}"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Plot3D", "[", 
   RowBox[{
    RowBox[{"KfuncImport", "[", 
     RowBox[{"poT", ",", "MoT"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"poT", ",", "0", ",", "5"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"MoT", ",", "0", ",", "20"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"\"\<Rate of sterile neutrino scatterings and decays\>\"", 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[CapitalGamma]scat", "[", 
   RowBox[{"ps_", ",", "Ms_", ",", "T_", ",", "\[Tau]_"}], "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"ps", "/", "T"}], "-", "5"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"ps", "/", "T"}], ")"}]}], "<", "0"}], "&&", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Ms", "/", "T"}], "-", "20"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"Ms", "/", "T"}], ")"}]}], "<", "0"}]}], ",", 
    RowBox[{
     RowBox[{"T", "^", "5"}], 
     RowBox[{
      RowBox[{
       RowBox[{"KfuncImport", "[", 
        RowBox[{
         RowBox[{"ps", "/", "T"}], ",", 
         RowBox[{"Ms", "/", "T"}]}], "]"}], "/", "\[Tau]"}], "/", 
      RowBox[{"Ms", "^", "5"}]}]}], " ", ",", "0"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[CapitalGamma]dec", "[", 
   RowBox[{"ps_", ",", "Ms_", ",", "\[Tau]_"}], "]"}], ":=", " ", 
  RowBox[{
   RowBox[{"Ms", "/", 
    RowBox[{"Sqrt", "[", 
     RowBox[{
      RowBox[{"ps", "^", "2"}], "+", 
      RowBox[{"Ms", "^", "2"}]}], "]"}]}], "/", 
   "\[Tau]"}]}], "\[IndentingNewLine]", 
 RowBox[{"\"\<\[Tau] here is the sterile neutrino lifetime measured in \
MeV\>\"", ";"}]}], "Input",
 CellChangeTimes->{
  3.534221841765432*^9, {3.536660627880225*^9, 3.5366606302270327`*^9}}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.536668696000609*^9, 3.536668705556932*^9}, {
  3.536668955436205*^9, 3.536668968883065*^9}, {3.5366690386615458`*^9, 
  3.536669042714242*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Msinglet", "=", "140"}], ";", 
  RowBox[{"\[Tau]singlet", "=", 
   RowBox[{"0.07", "*", "sectoMeV"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Kinetic", " ", "equation", " ", "integration", " ", "range"}], 
   "*)"}], 
  RowBox[{
   RowBox[{"Tin", "=", "100"}], ";", 
   RowBox[{"Tfin", "=", "3."}], ";"}]}], "\[IndentingNewLine]", 
 RowBox[{"\"\<Solution of Boltzmann equation\>\"", ";", 
  RowBox[{
   RowBox[{"FSinglet", "[", 
    RowBox[{"pconfTemp_", ",", "TTemp_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"fS", "[", "T", "]"}], "/.", 
     RowBox[{
      RowBox[{"NDSolve", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"fS", "'"}], "[", "T", "]"}], "\[Equal]", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"\[CapitalGamma]scat", "[", 
                 RowBox[{
                  RowBox[{"pconfTemp", "/", 
                   RowBox[{"a", "[", "T", "]"}]}], ",", "Msinglet", ",", "T", 
                  ",", "\[Tau]singlet"}], "]"}], "+", 
                RowBox[{"\[CapitalGamma]dec", "[", 
                 RowBox[{
                  RowBox[{"pconfTemp", "/", 
                   RowBox[{"a", "[", "T", "]"}]}], ",", "Msinglet", ",", 
                  "\[Tau]singlet"}], "]"}]}], ")"}], "/", "T"}], "/", 
             RowBox[{"H", "[", "T", "]"}]}], "*", 
            RowBox[{"(", " ", 
             RowBox[{
              RowBox[{"fS", "[", "T", "]"}], "-", 
              RowBox[{"nF", "[", 
               RowBox[{
                RowBox[{"Sqrt", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"pconfTemp", "^", "2"}], "/", 
                   RowBox[{
                    RowBox[{"a", "[", "T", "]"}], "^", "2"}]}], "+", 
                  RowBox[{"Msinglet", "^", "2"}]}], "]"}], "/", "T"}], 
               "]"}]}], " ", ")"}]}]}], ",", 
          RowBox[{
           RowBox[{"fS", "[", "Tin", "]"}], "\[Equal]", 
           RowBox[{"nF", "[", 
            RowBox[{
             RowBox[{"Sqrt", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"pconfTemp", "^", "2"}], "/", 
                RowBox[{
                 RowBox[{"a", "[", "Tin", "]"}], "^", "2"}]}], "+", 
               RowBox[{"Msinglet", "^", "2"}]}], "]"}], "/", "Tin"}], 
            "]"}]}]}], "}"}], ",", 
        RowBox[{"fS", "[", "T", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"T", ",", "Tin", ",", "Tfin"}], "}"}]}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], "/.", 
    RowBox[{"{", 
     RowBox[{"T", "\[Rule]", "TTemp"}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Export", " ", "at", " ", "temperature"}], "*)"}], 
  RowBox[{
   RowBox[{"TExp", "=", "5."}], ";", 
   RowBox[{"FSingletExport", "=", 
    RowBox[{"{", "}"}]}], ";", 
   RowBox[{"Do", "[", 
    RowBox[{
     RowBox[{"AppendTo", "[", 
      RowBox[{"FSingletExport", ",", 
       RowBox[{"{", 
        RowBox[{"pPhys", ",", 
         RowBox[{"FSinglet", "[", 
          RowBox[{
           RowBox[{"pPhys", "*", 
            RowBox[{"a", "[", "TExp", "]"}]}], ",", "TExp"}], "]"}]}], 
        "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"pPhys", ",", "0", ",", 
       RowBox[{"10.", "TExp"}], ",", 
       RowBox[{"TExp", "/", "10."}]}], "}"}]}], "]"}], 
   ";"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
   "\"\<Output/Distribution_Ms-140_tau-0.07s_TExp-5MeV.dat\>\"", ",", 
    "FSingletExport"}], "]"}], ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.534221466255485*^9, 3.534221539363383*^9}, {
   3.534221600524325*^9, 3.534221703165306*^9}, {3.53422176856613*^9, 
   3.53422176963735*^9}, {3.534221892547058*^9, 3.534221902168004*^9}, {
   3.534222087792442*^9, 3.5342221260021*^9}, {3.534223082492485*^9, 
   3.534223099739876*^9}, {3.534237450204692*^9, 3.534237450750315*^9}, {
   3.534237498797237*^9, 3.534237505783447*^9}, {3.534486952842767*^9, 
   3.534486984597894*^9}, {3.536660671807858*^9, 3.536660687596245*^9}, {
   3.5369928452595463`*^9, 3.536992849511448*^9}, {3.5369929484051237`*^9, 
   3.536992948579255*^9}, {3.5369929975701942`*^9, 3.5369930093310127`*^9}, {
   3.536995186339259*^9, 3.536995193868463*^9}, {3.550467574414797*^9, 
   3.550467626676354*^9}, 3.560004585625961*^9}]
},
WindowSize->{1394, 856},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
PrivateNotebookOptions->{"VersionedStylesheet"->{"Default.nb"[8.] -> False}},
FrontEndVersion->"9.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (January 25, \
2013)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[557, 20, 190, 3, 28, "Input"],
Cell[CellGroupData[{
Cell[772, 27, 34937, 957, 930, "Input"],
Cell[35712, 986, 974, 25, 65, "Output"],
Cell[36689, 1013, 6231, 161, 173, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[42957, 1179, 708, 17, 46, "Input"],
Cell[43668, 1198, 678, 12, 46, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[44383, 1215, 1209, 31, 52, "Input"],
Cell[45595, 1248, 435, 7, 48, "Output"],
Cell[46033, 1257, 526, 12, 40, "Message"],
Cell[46562, 1271, 523, 12, 40, "Message"],
Cell[47088, 1285, 524, 12, 40, "Message"],
Cell[47615, 1299, 605, 13, 24, "Message"],
Cell[48223, 1314, 554, 12, 24, "Message"],
Cell[48780, 1328, 554, 12, 24, "Message"],
Cell[49337, 1342, 554, 12, 24, "Message"],
Cell[49894, 1356, 609, 13, 24, "Message"],
Cell[50506, 1371, 4197, 75, 131, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[54740, 1451, 840, 24, 52, "Input"],
Cell[55583, 1477, 100, 2, 48, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[55720, 1484, 844, 24, 52, "Input"],
Cell[56567, 1510, 99, 2, 48, "Output"]
}, Open  ]],
Cell[56681, 1515, 584, 15, 63, "Input"],
Cell[57268, 1532, 6163, 169, 386, "Input"],
Cell[63434, 1703, 4740, 117, 250, "Input"],
Cell[68177, 1822, 2461, 76, 148, "Input"],
Cell[70641, 1900, 192, 3, 28, "Input"],
Cell[70836, 1905, 4505, 113, 199, "Input"]
}
]
*)

(* End of internal cache information *)
